<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>前端小开发</title>
  <subtitle>随笔 分享 笔记</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://chping2125.github.io/"/>
  <updated>2017-02-04T09:15:41.000Z</updated>
  <id>https://chping2125.github.io/</id>
  
  <author>
    <name>彬仔</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>vue 分享记录</title>
    <link href="https://chping2125.github.io/2017/02/04/vueShare/"/>
    <id>https://chping2125.github.io/2017/02/04/vueShare/</id>
    <published>2017-02-04T09:08:38.000Z</published>
    <updated>2017-02-04T09:15:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文是为了分享Vue相关知识点,从之前一篇<a href="http://chping.website/2016/11/28/Vue%E5%92%8CReact%E5%AF%B9%E6%AF%94/" target="_blank" rel="external">Vue和React对比</a>笔记中节选出来的。</p>
<p>一、数据双向绑定</p>
<p>1.插值表达式<br>2.指令系统（声明式绑定）<br>3.Class与Style绑定<br>4.条件渲染和列表渲染<br>5.时间处理器<br>6.表单控件<br>7.计算属性<br>8.数据获取（axios）</p>
<p>二、组件及数据流</p>
<p>1.创建组件<br>2.使用组件<br>3.生命周期<br>4.组件之间信息传递</p>
<p>三、状态管理</p>
<p>vuex</p>
<p>四、路由</p>
<p>vue-Router</p>
<p>五、其他</p>
<p>1.过渡系统<br>2.服务端渲染</p>
<a id="more"></a>
<h1 id="Vue-简单介绍"><a href="#Vue-简单介绍" class="headerlink" title="Vue 简单介绍"></a>Vue 简单介绍</h1><p>Vue也已经升级到2.0版本了，到现在为止，比较流行的MVVM框架有<strong>AngularJS</strong>（也有人认为其为MVC）、<strong>ReactJS</strong>和<strong>VueJS</strong>，这三个框架中，以我现在的情况来说（AngularJS2还没有去接触），Vue应该是发展最快的。</p>
<p>为什么现在MVVM框架这么火呢？JQuery挺好用的呀，为什么要去代替它？…</p>
<p>可能会产生这样的疑问，在我看来，MVVM框架的流行是因为随着前端技术的发展对于要求越来越高和前端面对的场景越来越复杂导致了现实对于前端性能的要求也越来越高，这样像JQuery那样频繁的操作DOM节点的方式显然就不太合适了。所以MVVM开始逐渐流行开来，另外我认为JQuery目前来看还是不会被代替的，因为对于一些对性能要求不是很高的前端项目，是用JQuery来开发还是非常爽的。</p>
<h1 id="数据双向绑定"><a href="#数据双向绑定" class="headerlink" title="数据双向绑定"></a>数据双向绑定</h1><p>1.插值表达式<br>2.指令系统（声明式绑定）<br>3.Class与Style绑定<br>4.条件渲染和列表渲染<br>5.时间处理器<br>6.表单控件<br>7.计算属性<br>8.数据获取（axios）</p>
<p>我理解的数据双向绑定是，MVVM框架中的View层和Model层的数据相互影响。那么，那些行为会引起数据变动呢？<br>首先，View层（即页面上）的<strong>表单操作</strong>、<strong>触发事件</strong>可能会引起数据变动；<strong>数据请求</strong>也可能会引起数据变动，这个变动我认为更多在Model层；还有一种情况就是，<strong>某一数据变动引起另外关联数据</strong>的改变。<br>不管是哪一种数据改变，都会导致View层和Model层的变化，View层变动引起页面变化，Model层变动保存数据。</p>
<h2 id="Vue的数据双向绑定"><a href="#Vue的数据双向绑定" class="headerlink" title="Vue的数据双向绑定"></a>Vue的数据双向绑定</h2><p>在Vue中，View层中与数据绑定有关的有<strong>插值表达式</strong>、<strong>指令系统</strong>、<strong>*Class和Style</strong>、<strong>事件处理器</strong>和<strong>表单控件</strong>，<strong>ajax请求</strong>和<strong>计算属性</strong>也和数据变化有关，下面我们分别说一下这些知识点设计的一些数据绑定问题。</p>
<h3 id="插值表达式"><a href="#插值表达式" class="headerlink" title="插值表达式"></a>插值表达式</h3><p>在Vue中，<strong>插值表达式</strong>和<strong>指令</strong>对于数据的操作又称为<strong>模板语法</strong>。</p>
<blockquote>
<p>Vue.js 使用了基于 HTML 的模版语法，允许开发者声明式地将 DOM 绑定至底层 Vue 实例的数据。所有 Vue.js 的模板都是合法的 HTML ，所以能被遵循规范的浏览器和 HTML 解析器解析。</p>
<p>在底层的实现上， Vue 将模板编译成虚拟 DOM 渲染函数。结合响应系统，在应用状态改变时， Vue 能够智能地计算出重新渲染组件的最小代价并应用到 DOM 操作上。</p>
</blockquote>
<p>关于插值表达式的使用，在<a href="http://cn.vuejs.org/v2/guide/syntax.html#插值l" target="_blank" rel="external">Vue官网模板语法的插值</a>部分有详细的使用说明，不在赘述，需要注意的是，<strong>过滤器</strong>在插值中的使用有时可以起到意想不到的效果。</p>
<h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><p>Vue重的指令估计是从Angular那里学来的，有很多相似的地方，但是也不完全相同。<br>Vue中的指令我觉着非常的简单，并且就12个，很容易记忆：</p>
<ol>
<li><strong>v-bind</strong>:动态地绑定一个或多个 <em>html属性</em>，或一个组件 <em>prop 到表达式</em>（组件单项数据流使用）。</li>
<li><strong>v-once</strong>:绑定只渲染元素和组件 <em>一次</em> 的特性或prop表达式。</li>
<li><strong>v-model</strong>:在表单控件或者组件上创建双向绑定，<em>代替value值</em>。</li>
<li><strong>v-text</strong>:更新元素的 <em>textContent</em>。</li>
<li><strong>v-html</strong>:更新元素的 <em>innerHTML</em>。<strong>注意：内容按普通 HTML 插入 - 不会作为 Vue 模板进行编译</strong> 。</li>
<li><strong>v-on</strong>:绑定事件监听器。</li>
<li><strong>v-if / v-else / v-show</strong>:条件渲染。</li>
<li><strong>v-for</strong>:列表渲染。</li>
<li><strong>v-pre</strong>:跳过这个元素和它的子元素的编译过程。<br>10 <strong>v-cloak</strong>:这个指令保持在元素上直到关联实例结束编译。和 CSS 规则如 <code>[v-cloak] { display: none }</code>一起用时，这个指令可以隐藏未编译的 Mustache 标签直到实例准备完毕。</li>
</ol>
<p>大概列举一下，详细使用请参考<a href="http://cn.vuejs.org/v2/api/#指令" target="_blank" rel="external">Vue API 指令</a>和<a href="http://cn.vuejs.org/v2/guide/" target="_blank" rel="external">Vue 指南的Class与Style绑定、条件渲染、列表渲染、事件处理器、表单控件绑定</a>部分内容。</p>
<h3 id="Class与Style绑定"><a href="#Class与Style绑定" class="headerlink" title="Class与Style绑定"></a>Class与Style绑定</h3><p>Vue为了方便操作控制元素的样式，专门增强了<strong>v-bind:class</strong>和<strong>v-bind:style</strong>,通过增强的这两个指令可以实用<strong>对象语法</strong>或者<strong>数组语法</strong>对元素的样式进行变动，这也不是本文重点，<a href="http://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="external">Vue官方Class与Style绑定</a>已经说得很详细了。</p>
<h3 id="条件渲染和列表渲染"><a href="#条件渲染和列表渲染" class="headerlink" title="条件渲染和列表渲染"></a>条件渲染和列表渲染</h3><p>条件渲染和列表渲染在Vue模板中动态创建模板很不错，让我里面想到了JSP中的EL表达式和Struts中的JSTL(后端模板语言中基本都有)，这就可以方便的根据后端传过来的数据进行模板创建了。你懂得，详细语法和使用还是参考<a href="http://cn.vuejs.org/v2/guide/conditional.html" target="_blank" rel="external">Vue文档列表渲染和条件渲染</a>，本篇主题是对比，并不是讲解基础语法，Vue的官方文档我觉着非常给力，简单明了。</p>
<h3 id="事件处理器"><a href="#事件处理器" class="headerlink" title="事件处理器"></a>事件处理器</h3><p>在Vue中我们可以通过<strong>v-on</strong>来给元素注册事件，完成<a href="http://cn.vuejs.org/v2/guide/events.html" target="_blank" rel="external">事件注册</a>，Vue中的事件处理和平时使用的事件处理不同之处就是，既可以绑定数据处理函数，也可以使用内联处理器。并且，Vue还讲常用的事件方法，如<strong>preventDefault方法</strong>等通过修饰符的方式来方便使用。</p>
<h3 id="表单控件"><a href="#表单控件" class="headerlink" title="表单控件"></a>表单控件</h3><p>你可以用<strong>v-model</strong>指令在表单控件元素上创建双向数据绑定。它会根据控件类型自动选取正确的方法来更新元素。</p>
<p>Vue中对于<a href="http://cn.vuejs.org/v2/guide/forms.html" target="_blank" rel="external">表单控件</a>提供的<em>v-model*</em>指令非常的使用，可以方便的返回或者设置表单控件的信息。</p>
<h3 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h3><p>在Vue中引入了<strong>计算属性</strong>来处理模板中放入太多的逻辑会让模板过重且难以维护的问题，这样不但解决了上面的问题，而且也同时让模板和业务逻辑更好的分离。<br><a href="http://cn.vuejs.org/v2/guide/computed.html" target="_blank" rel="external">Vue计算属性</a></p>
<h3 id="数据请求"><a href="#数据请求" class="headerlink" title="数据请求"></a>数据请求</h3><p>在Vue1.x的版本中，官方推荐的ajax数据请求库是<strong>vue-resource</strong>，但是在Vue2.0的版本中，不再推荐使用，该推荐使用<strong><a href="https://github.com/mzabriskie/axios" target="_blank" rel="external">axios</a></strong>。</p>
<p>其实这些ajax数据请求的使用都大差不差，随你选择，并且<strong>vue-resource</strong>还是继续支持使用的，在Vue2.0中。</p>
<p>以上八个方面，我个人认为都是和数据绑定相关的一些Vue基本项，只是简单列举，具体内容请查看<a href="http://cn.vuejs.org/v2/guide" target="_blank" rel="external">Vue文档</a>或者<a href="http://cn.vuejs.org/v2/api/" target="_blank" rel="external">API</a>。<br>为什么这么多呢？因为Vue中有个<strong>模板</strong>的概念，所以，数据和模板进行数据绑定需要分别来做，而在的React中，你会发现，React的数据绑定虽然也是这八项功能点，但是其是通过JSX语法实现的。</p>
<h1 id="组件及数据流"><a href="#组件及数据流" class="headerlink" title="组件及数据流"></a>组件及数据流</h1><p>1.创建组件<br>2.使用组件<br>3.生命周期<br>4.组件之间信息传递</p>
<p>前端发展到现在，为了提高开发效率，组件化已经成为一个必然的趋势。而MVVM框架中，如果没有组件化的思想，它都不敢说拿出来宣传（纯属个人意淫）。下面我们再简单介绍一下VueJS中的<strong>组件思想</strong>和<strong>组件之间的数据流</strong>。</p>
<h2 id="React中的组件和数据流"><a href="#React中的组件和数据流" class="headerlink" title="React中的组件和数据流"></a>React中的组件和数据流</h2><p>上一节中提到过，React中的组件化是其重要的特点之一，因为在Angular1.x的出现，并没有明确提出组件的思想，只是有一个类似的<strong>指令思想</strong>来实现组件化的方式。所以，当React中明确提出<strong>组件</strong>思想后，前端好像重生了（吹的有点大了）。</p>
<h3 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h3><p>React中实现组件有两种方式，一种是<strong>createClass</strong>方法，另一种是通过ES2015的思想<strong>类继承React.Component</strong>来实现。</p>
<h4 id="createClass方式实现"><a href="#createClass方式实现" class="headerlink" title="createClass方式实现"></a>createClass方式实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>这样，一个组件就创建完成，并且通过ES2015的模块化思想将其暴露出去了，其他组件就可以引入并使用了。如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'./hello.jsx'</span>;</div><div class="line"></div><div class="line">ReactDom.render(</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">Hello</span>/&gt;</span></span>,</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>OK，这样就使用简单使用了一个组件。</p>
<h4 id="类继承React-Component来实现"><a href="#类继承React-Component来实现" class="headerlink" title="类继承React.Component来实现"></a>类继承React.Component来实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentItem</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"comment"</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.author &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.date &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.props.children &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentItem <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure>
<p>需要注意的是，这样创建组件的时候，组件名称首字母必须大写（如：CommentItem）。同样，我们使用一下这个组件。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> CommentItem <span class="keyword">from</span> <span class="string">'./comment-item'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">let</span> CommentNodes = <span class="keyword">this</span>.props.data.map(<span class="function">(<span class="params">comment, index</span>) =&gt;</span> &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">CommentItem</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">author</span>=<span class="string">&#123;comment.author&#125;</span> <span class="attr">date</span>=<span class="string">&#123;comment.date&#125;</span>&gt;</span></span></div><div class="line">&#123;comment.content&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">CommentItem</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">&#123; CommentNodes &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentList <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p>这样我们又创建了一个组件，并且在这个组件中我们使用了上面创建的那个组件。</p>
<h3 id="组件之间的数据流"><a href="#组件之间的数据流" class="headerlink" title="组件之间的数据流"></a>组件之间的数据流</h3><p>在上面<strong>类继承React.Component来实现</strong>一节中，我们可以看出例子中出现了组件嵌套的情况，仔细想想，组件之间传递信息肯定是必然的。那么React是怎样进行<strong>组件之间的数据通信</strong>的呢？</p>
<p>回答这个问题之前，我们需要考虑一下，组件之间有几种数据通信。首先，第一种比较容易想到，那就是<strong>父子组件</strong>之间的数据通信。第二种也就自然而然的出来了—-<strong>非父子组件</strong>之间的数据通信。</p>
<h4 id="父子组件数据通信"><a href="#父子组件数据通信" class="headerlink" title="父子组件数据通信"></a>父子组件数据通信</h4><p>父子组件之间的数据通信细分其实还有两种：<strong>父与子之间</strong>和<strong>子与父之间</strong>。</p>
<p>在React中，<strong>父与子</strong>之间的数据通信是通过<strong>props属性</strong>就行传递的；<br>而<strong>子与父</strong>之间的数据通信可以通过<strong>父组件定义事件，子组件触发父组件中的事件时，通过实参的形式来改变父组件中的数据</strong>来通信;</p>
<p>下面我们来分别通过例子来再现一下这种场景：<br><strong>父组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> CommentItem <span class="keyword">from</span> <span class="string">'./comment-item'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">let</span> CommentNodes = <span class="keyword">this</span>.props.data.map(<span class="function">(<span class="params">comment, index</span>) =&gt;</span> &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">CommentItem</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">author</span>=<span class="string">&#123;comment.author&#125;</span> <span class="attr">date</span>=<span class="string">&#123;comment.date&#125;</span>&gt;</span></span></div><div class="line">&#123;comment.content&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">CommentItem</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">&#123; CommentNodes &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentList <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p><strong>子组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentItem</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"comment"</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.author &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.date &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.props.children &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentItem <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p>通过上面我们可以看出，子组件CommentItem需要父组件传过来的值进行展示，而父组件是这样的：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;CommentItem key=&#123;index&#125; author=&#123;comment.author&#125; date=&#123;comment.date&#125;&gt; &#123;comment.content&#125; &lt;<span class="regexp">/CommentItem&gt;</span></div></pre></td></tr></table></figure></p>
<p>在父组件中添加了<code>key</code>、<code>author</code>、<code>date</code>属性来向子组件传值。想对象的，子组件通过props对象来获取父组件传过来的值，如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;span&gt;&#123; this.props.author &#125;&lt;/span&gt;</div><div class="line">&lt;span&gt;&#123; this.props.date &#125;&lt;/span&gt;</div><div class="line">&lt;div&gt;&#123; this.props.children &#125;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>好的，我们再来看一下另一种<strong>子与父</strong>之间的通信。</p>
<p><strong>父组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> CommentList <span class="keyword">from</span> <span class="string">'./comment-list'</span>;</div><div class="line"><span class="keyword">import</span> CommentForm <span class="keyword">from</span> <span class="string">'./comment-form'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentBox</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"><span class="keyword">constructor</span>(props) &#123;</div><div class="line"><span class="keyword">super</span>(props);</div><div class="line"><span class="keyword">this</span>.state = &#123;<span class="attr">data</span>: []&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">handleCommentSubmit(comment) &#123;</div><div class="line"><span class="keyword">let</span> comments = <span class="keyword">this</span>.state.data;</div><div class="line">comments.push(comment);</div><div class="line"><span class="keyword">this</span>.setState(&#123;<span class="attr">data</span>: comments&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line">&lt;div className="m-index"&gt;</div><div class="line">&lt;div&gt;</div><div class="line">&lt;h1&gt;评论&lt;/h1&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;CommentList data=&#123;this.state.data&#125; /&gt;</div><div class="line">&lt;CommentForm onCommentSubmit=&#123;this.handleCommentSubmit.bind(this)&#125; /&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export &#123; CommentBox as default &#125;;</div></pre></td></tr></table></figure></p>
<p><strong>子组件</strong>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentForm</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">handleClick()&#123;</div><div class="line"><span class="keyword">let</span> author = <span class="keyword">this</span>.refs.author.value,</div><div class="line">content = <span class="keyword">this</span>.refs.content.value;</div><div class="line"></div><div class="line"><span class="keyword">this</span>.props.onCommentSubmit(&#123;author, content, <span class="attr">date</span>:<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;);</div><div class="line"></div><div class="line"><span class="keyword">this</span>.refs.author.value = <span class="string">""</span>;</div><div class="line"><span class="keyword">this</span>.refs.content.value = <span class="string">""</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> (</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"yo-list yo-list-a"</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">className</span>=<span class="string">"item item-input"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">className</span>=<span class="string">"yo-input flex"</span> <span class="attr">ref</span>=<span class="string">"author"</span> <span class="attr">placeholder</span>=<span class="string">"发布人"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">className</span>=<span class="string">"item item-input"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">className</span>=<span class="string">"yo-input flex"</span> <span class="attr">ref</span>=<span class="string">"content"</span> <span class="attr">placeholder</span>=<span class="string">"留言内容"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick.bind(this)&#125;</span> <span class="attr">className</span>=<span class="string">"yo-btn yo-btn-l"</span>&gt;</span>发表评论<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export &#123; CommentForm as default &#125;;</div></pre></td></tr></table></figure></p>
<p>简单解释一下，子组件是一个表单组件，父组件中引用了该表单子组件，然后子组件中点击button按钮，触发子组件中的处理函数，处理函数通过<strong>refs</strong>获取到表单输入值然后调用父组件中传过来的函数，从而触发父组件中的函数执行改变data数据，data数据变动直接影响的是另一个组件CommentList的变化。</p>
<p>需要注意的是，在获取表单控件内的数据时，我们利用了一个<strong>refs</strong>对象，该对象用于获取真实DOM结构。具体来说就是，在React中组件并不是真实的 DOM 节点，而是存在于内存之中的一种数据结构，叫做虚拟 DOM （virtual DOM，这是React探索性的创新）。只有当它插入文档以后，才会变成真实的 DOM 。根据 React 的设计，所有的 DOM 变动，都先在虚拟 DOM 上发生，然后再将实际发生变动的部分，反映在真实 DOM上，这种算法叫做 DOM diff （详细了解<a href="http://www.infoq.com/cn/articles/react-dom-diff" target="_blank" rel="external">diff 算法</a>），它可以极大提高网页的性能表现。<br>在这里点击button时，input和textarea元素还是虚拟DOM，所以违法获取到输入的值，需要通过<strong>refs</strong>对象获取一下。</p>
<h4 id="非父子组件之间的通信"><a href="#非父子组件之间的通信" class="headerlink" title="非父子组件之间的通信"></a>非父子组件之间的通信</h4><p>React中在处理<strong>非父子组件之间的通信</strong>时，简单的，嵌套不深的非父子组件（如：兄弟组件）可以仍然使用上一节<strong>非父子组件之间通信</strong>中的<strong>事件函数，传形参</strong>的方式来实现。如子组件<strong>CommentList </strong>和子组件<strong>CommentFrom</strong>之间的通信就是这样实现的。</p>
<p>如果，需要通信的两个非父子组件之间嵌套比较深，可以使用Flux和Redux来实现状态管理，这里不做详细阐述，下面会详细对比vue的状态管理进行说明。想先了解的可以看一下阮一峰老师的blog：</p>
<blockquote>
<p><a href="http://www.ruanyifeng.com/blog/2016/01/flux.html" target="_blank" rel="external">Flux 架构入门教程</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html" target="_blank" rel="external">Redux 入门教程（一）：基本用法</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_two_async_operations.html" target="_blank" rel="external">Redux 入门教程（二）：中间件与异步操作</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="external">Redux 入门教程（三）：React-Redux 的用法</a></p>
</blockquote>
<h3 id="组件的声明周期"><a href="#组件的声明周期" class="headerlink" title="组件的声明周期"></a>组件的声明周期</h3><p><img src="http://upload-images.jianshu.io/upload_images/3333422-04ea055c73c50c98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="react 组件的声明周期"></p>
<p>上面这张图已经很清楚的展示了react组件的声明周期了，就不过多介绍了。这张图摘自<a href="http://www.jianshu.com/p/4784216b8194" target="_blank" rel="external">React组件生命周期小结</a>，对于理解React组件的声明周期钩子函数很有帮助。</p>
<h2 id="Vue中的组件和数据流"><a href="#Vue中的组件和数据流" class="headerlink" title="Vue中的组件和数据流"></a>Vue中的组件和数据流</h2><p>Vue比React出来的要晚一些，自然顺应了前端组件化的大潮，并且个人觉得借鉴了部分React的思想来实现其组件化思想。</p>
<p>Vue默认的是单向数据流，这是Vue直接提出来说明的，父组件默认可以向子组件传递数据，但是子组件向父组件传递数据就需要额外设置了。</p>
<p><strong>父子组件</strong>之间的数据通信是通过<strong>Prop</strong>和<strong>自定义事件</strong>实现的，而<strong>非父子组件</strong>可以使用<strong>订阅/发布</strong>模式实现（类似于Angualr中的非父子指令之间的通信），再复杂一点也是建议使用状态管理（vuex）。</p>
<p>我一直觉得Vue的官方文档是我看过最直接、易懂的技术文档，所以就直接给大家贴一个中文链接，自己去跟随尤雨溪学习吧。</p>
<blockquote>
<p><a href="https://vuefe.cn/v2/guide/components.html" target="_blank" rel="external">Vue 中的组件和数据流</a></p>
</blockquote>
<h1 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h1><p>上面对比React和Vue的<strong>组件及数据流</strong>的时候，都提到了<strong>当非父子组件之间嵌套过深</strong>的时候都建议使用状态管理来维护数据的变化，那么到底它们之间的状态管理有什么区别呢？</p>
<h2 id="Vue中的状态管理–vuex"><a href="#Vue中的状态管理–vuex" class="headerlink" title="Vue中的状态管理–vuex"></a>Vue中的状态管理–vuex</h2><p>先放个<a href="https://vuex.vuejs.org/zh-cn/" target="_blank" rel="external">官方中文链接</a>，还是建议直接看官方文档。然后在放一下小例子去体会一下。</p>
<p>先简单说明一下，vuex状态管理的几个核心概念：</p>
<ol>
<li>State: Vuex 使用 <strong>单一状态树</strong> —— 是的，用一个对象就包含了全部的应用层级状态。至此它便作为一个『唯一数据源(<a href="https://en.wikipedia.org/wiki/Single_source_of_truth" target="_blank" rel="external">SSOT</a>)』而存在。这也意味着，每个应用将仅仅包含一个 store 实例。</li>
<li>Getters: 从state中获取状态值</li>
<li>Mutation: 更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。Vuex 中的 mutations 非常类似于事件：每个 mutation 都有一个字符串的 <strong>事件类型 (type)</strong> 和 一个 <strong>回调函数 (handler)</strong>。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数</li>
<li>Action:  类似于 mutation，不同在于：Action 提交的是 mutation，而不是直接变更状态；Action 可以包含任意异步操作。</li>
</ol>
<p>例子来了：<br><strong>store.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'../libs/vue.js'</span>;</div><div class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'../libs/vuex.min.js'</span>;</div><div class="line">Vue.use(Vuex);</div><div class="line"><span class="keyword">const</span> state = &#123;</div><div class="line"><span class="attr">loginPrePath</span>:[<span class="string">'/'</span>]</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> mutations =&#123;</div><div class="line">LOGINPREPATH(state,path)&#123;</div><div class="line">state.loginPrePath.unshift(path);</div><div class="line">&#125;,</div><div class="line">LOGINPREPATHSHIFT(state)&#123;</div><div class="line">state.loginPrePath.shift();</div><div class="line">&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</div><div class="line">state,</div><div class="line">mutations</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>actions.js:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line"><span class="attr">loginPrePath</span>: <span class="function">(<span class="params">&#123;dispatch,state&#125;,path</span>)=&gt;</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'actions loginPrePath:'</span> +path);</div><div class="line">dispatch(<span class="string">'LOGINPREPATH'</span>,path);</div><div class="line">&#125;,</div><div class="line"><span class="attr">loginPrePathShift</span>: <span class="function">(<span class="params">&#123;dispatch,state&#125;</span>)=&gt;</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'delete....'</span>);</div><div class="line">dispatch(<span class="string">'LOGINPREPATHSHIFT'</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>getter.js:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line"><span class="attr">loginPrePath</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.loginPrePath</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><strong>login.vue:</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">...</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">import Vue from '../libs/vue.js';</div><div class="line">import VueResource from '../libs/vue-resource.js';</div><div class="line">import Vuex from '../vuex/actions.js';</div><div class="line">import VuexGet from '../vuex/getters.js';</div><div class="line"></div><div class="line">Vue.use(VueResource);</div><div class="line">export default &#123;</div><div class="line">data()&#123;</div><div class="line">return &#123;</div><div class="line">username: '',</div><div class="line">password: '',</div><div class="line">loginBtn: 0</div><div class="line">&#125;</div><div class="line">&#125;,</div><div class="line">vuex: &#123;</div><div class="line">actions: &#123;</div><div class="line">setLoginPrePath: Vuex.loginPrePath</div><div class="line">&#125;,</div><div class="line">getters:&#123;</div><div class="line">getLoginPrePath: VuexGet.loginPrePath</div><div class="line">&#125;</div><div class="line">&#125;,</div><div class="line">methods: &#123;</div><div class="line">forget()&#123;</div><div class="line">//使用vuex，修改状态值</div><div class="line">this.setLoginPrePath(&#123;path:this.$route.path,title:'忘记密码'&#125;);</div><div class="line">this.$router.go(&#123;path:'/index2/forget.json'&#125;);</div><div class="line">&#125;,</div><div class="line">submit()&#123;</div><div class="line">if(this.loginBtn === 3)&#123;</div><div class="line">if(this.checked)&#123;</div><div class="line">this.$http.post('/zhixiao/password.json',&#123;password:this.password&#125;).then(</div><div class="line">(res)=&gt;&#123;</div><div class="line">if(res.ok)&#123;</div><div class="line">console.log("注册成功，正在跳转登录页面");</div><div class="line">setTimeout(()=&gt;&#123;</div><div class="line">//获取状态值，通过getter</div><div class="line">var path = this.getLoginPrePath[0].path;</div><div class="line">this.loginPrePathShift();</div><div class="line">this.$router.go(path);</div><div class="line">&#125;,1500);</div><div class="line">&#125;</div><div class="line">&#125;,(res)=&gt;&#123;</div><div class="line">console.log('网络错误，请稍后重试');</div><div class="line">&#125;</div><div class="line">)</div><div class="line">&#125;else&#123;</div><div class="line">console.log('请选择同意用户协议');</div><div class="line">&#125;</div><div class="line">&#125;else&#123;</div><div class="line">console.log('请填写验证码');</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>上面的例子并无实际效果，是我从以前项目中拼出来的（vuex1.0），只是为了说明<strong>loginPrePath</strong>这个状态值在vuex中的使用方式。详细请看Vue官方文档。</p>
<h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><p>要想实现SPA，路由是个不可避免的话题，作为主流的MVVM框架，怎么可能没有官方路由呢，两者的路由也很相似，都是利用各自的组件实现思想来实现的。</p>
<h2 id="Vue中的路由"><a href="#Vue中的路由" class="headerlink" title="Vue中的路由"></a>Vue中的路由</h2><p>还是先贴<a href="https://router.vuejs.org/zh-cn/" target="_blank" rel="external">官方链接</a>，简单易懂。<br>再给个例子(vue-router1.0)，仔细看一下：<br><strong>app.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//引用component</span></div><div class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">'./components/index.vue'</span>;</div><div class="line"><span class="keyword">import</span> main <span class="keyword">from</span> <span class="string">'./components/main.vue'</span>;</div><div class="line"><span class="keyword">import</span> my <span class="keyword">from</span> <span class="string">'./components/my.vue'</span>;</div><div class="line"></div><div class="line"><span class="comment">//APP route</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'./libs/vue.js'</span>;</div><div class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'./libs/vue-router.js'</span>;</div><div class="line"></div><div class="line">Vue.use(VueRouter);</div><div class="line"></div><div class="line">router.map(&#123;</div><div class="line"><span class="string">'/'</span>:&#123;</div><div class="line"><span class="attr">component</span>: index,</div><div class="line"><span class="attr">subRoutes</span>:&#123;</div><div class="line"><span class="string">'/'</span>:&#123;</div><div class="line"><span class="attr">component</span>: main</div><div class="line">&#125;,</div><div class="line"><span class="string">'/my'</span>:&#123;</div><div class="line"><span class="attr">name</span>:<span class="string">'my'</span>,</div><div class="line"><span class="attr">component</span>: my</div><div class="line">&#125;,</div><div class="line"><span class="string">'/results/:key'</span>:&#123;</div><div class="line"><span class="attr">name</span>:<span class="string">'results'</span>,</div><div class="line"><span class="attr">component</span>:results</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//启动router</span></div><div class="line">router.start(App,<span class="string">'body'</span>);</div></pre></td></tr></table></figure></p>
<p><strong>index.vue</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"index-container"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-bind:class</span>=<span class="string">"getIndex == $index ? 'active' : ''"</span></span></div><div class="line"><span class="attr">v-for</span>=<span class="string">"data in navList"</span></div><div class="line"><span class="attr">v-on:click</span>=<span class="string">"changePage($index)"</span></div><div class="line"><span class="attr">v-link</span>=<span class="string">"&#123;path:data.path,exact: true&#125;"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont"</span>&gt;</span>&#123;&#123;&#123;data.icon&#125;&#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;&#123;data.name&#125;&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">var</span> Vue = <span class="built_in">require</span>(<span class="string">'../libs/vue.js'</span>);</div><div class="line"><span class="keyword">var</span> VueResource = <span class="built_in">require</span>(<span class="string">'../libs/vue-resource.js'</span>);</div><div class="line"><span class="keyword">import</span> &#123;getIndex&#125; <span class="keyword">from</span> <span class="string">'../vuex/getters.js'</span>;</div><div class="line"><span class="keyword">import</span> &#123;changeIndexPage&#125; <span class="keyword">from</span> <span class="string">'../vuex/actions.js'</span>;</div><div class="line">Vue.use(VueResource);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line"><span class="attr">vuex</span>: &#123;</div><div class="line"><span class="attr">actions</span>:&#123;</div><div class="line">changeIndexPage</div><div class="line">&#125;,</div><div class="line"><span class="attr">getters</span>:&#123;</div><div class="line">getIndex</div><div class="line">&#125;</div><div class="line">&#125;,</div><div class="line">data()&#123;</div><div class="line"><span class="keyword">return</span> &#123;</div><div class="line"><span class="attr">cur</span>: <span class="number">0</span>,</div><div class="line"><span class="attr">navList</span>:[</div><div class="line">&#123;<span class="attr">path</span>:<span class="string">'/'</span>,<span class="attr">icon</span>:<span class="string">''</span>,<span class="attr">name</span>:<span class="string">'主页'</span>&#125;,</div><div class="line">&#123;<span class="attr">path</span>:<span class="string">'/lee'</span>,<span class="attr">icon</span>:<span class="string">''</span>,<span class="attr">name</span>:<span class="string">'排行榜'</span>&#125;,</div><div class="line">&#123;<span class="attr">path</span>:<span class="string">'/search'</span>,<span class="attr">icon</span>:<span class="string">''</span>,<span class="attr">name</span>:<span class="string">'发现'</span>&#125;,</div><div class="line">&#123;<span class="attr">path</span>:<span class="string">'/my'</span>,<span class="attr">icon</span>:<span class="string">''</span>,<span class="attr">name</span>:<span class="string">'我的'</span>&#125;</div><div class="line">]</div><div class="line">&#125;</div><div class="line">&#125;,</div><div class="line"><span class="attr">methods</span>:&#123;</div><div class="line"><span class="attr">changePage</span>:<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.changeIndexPage(i);</div><div class="line"><span class="keyword">this</span>.cur = <span class="keyword">this</span>.getIndex;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p>
<p>大概就这样，感觉像是配置的感觉，其实这就是利用的vue中组件思想来实现的，详细看官方文档。</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>1.过渡系统<br>2.服务端渲染</p>
<h2 id="过渡系统"><a href="#过渡系统" class="headerlink" title="过渡系统"></a>过渡系统</h2><p><a href="https://cn.vuejs.org/v2/guide/transitions.html" target="_blank" rel="external">https://cn.vuejs.org/v2/guide/transitions.html</a></p>
<p><a href="https://cn.vuejs.org/v2/guide/transitioning-state.html" target="_blank" rel="external">https://cn.vuejs.org/v2/guide/transitioning-state.html</a></p>
<h2 id="服务端渲染"><a href="#服务端渲染" class="headerlink" title="服务端渲染"></a>服务端渲染</h2><p>说道服务端渲染，其实官方对于使用SSR的原因和好处，解释的都很好，有兴趣的可以看一看 <a href="https://cn.vuejs.org/v2/guide/ssr.html" target="_blank" rel="external">https://cn.vuejs.org/v2/guide/ssr.html</a></p>
<p>另外官方提供的服务端渲染的例子vue-hackernews2.0也很不错的，可以去借鉴看一看<br><a href="https://github.com/vuejs/vue-hackernews-2.0" target="_blank" rel="external">https://github.com/vuejs/vue-hackernews-2.0</a></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>现在我也是在搬砖阶段，深入的理解可能还需要一些时间。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文是为了分享Vue相关知识点,从之前一篇&lt;a href=&quot;http://chping.website/2016/11/28/Vue%E5%92%8CReact%E5%AF%B9%E6%AF%94/&quot;&gt;Vue和React对比&lt;/a&gt;笔记中节选出来的。&lt;/p&gt;
&lt;p&gt;一、数据双向绑定&lt;/p&gt;
&lt;p&gt;1.插值表达式&lt;br&gt;2.指令系统（声明式绑定）&lt;br&gt;3.Class与Style绑定&lt;br&gt;4.条件渲染和列表渲染&lt;br&gt;5.时间处理器&lt;br&gt;6.表单控件&lt;br&gt;7.计算属性&lt;br&gt;8.数据获取（axios）&lt;/p&gt;
&lt;p&gt;二、组件及数据流&lt;/p&gt;
&lt;p&gt;1.创建组件&lt;br&gt;2.使用组件&lt;br&gt;3.生命周期&lt;br&gt;4.组件之间信息传递&lt;/p&gt;
&lt;p&gt;三、状态管理&lt;/p&gt;
&lt;p&gt;vuex&lt;/p&gt;
&lt;p&gt;四、路由&lt;/p&gt;
&lt;p&gt;vue-Router&lt;/p&gt;
&lt;p&gt;五、其他&lt;/p&gt;
&lt;p&gt;1.过渡系统&lt;br&gt;2.服务端渲染&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Vue" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Vue/"/>
    
    
      <category term="MVVM" scheme="https://chping2125.github.io/tags/MVVM/"/>
    
      <category term="Vue" scheme="https://chping2125.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>vue-server-renderer 文档翻译</title>
    <link href="https://chping2125.github.io/2017/01/01/vue-server-renderer/"/>
    <id>https://chping2125.github.io/2017/01/01/vue-server-renderer/</id>
    <published>2017-01-01T07:02:40.000Z</published>
    <updated>2017-01-01T08:43:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue-server-renderer"><a href="#vue-server-renderer" class="headerlink" title="vue-server-renderer"></a>vue-server-renderer</h1><p>用于 Vue2.0 的服务端渲染</p>
<blockquote>
<p>这个包是自动生成的。如果你想合并请求请看 GigHub 上的 <a href="https://github.com/vuejs/vue/blob/dev/src/entries/web-server-renderer.js" target="_blank" rel="external">src/entries/web-server-renderer.js</a></p>
</blockquote>
<p>这个包提供了基于 Node.js 的 Vue2.0 服务端渲染。</p>
<ul>
<li><a href="#installation">安装</a></li>
<li><a href="#api">API</a></li>
<li><a href="#renderer-options">Renderer 选项</a></li>
<li><a href="#why-use-bundlerrenderer">为什么使用 bundleRenderer?</a></li>
<li><a href="#creating-the-server-bundle">服务端打包生成</a></li>
<li><a href="#component-caching">组件缓存</a></li>
<li><a href="#client-side-hydration">客户端合成</a></li>
</ul>
<a id="more"></a>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a><a name="installation" href="#installation">安装</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install vue-server-rederer</div></pre></td></tr></table></figure>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a><a name="api">API</a></h2><h3 id="createRenderer-rendererOptions"><a href="#createRenderer-rendererOptions" class="headerlink" title="createRenderer([rendererOptions])"></a>createRenderer([rendererOptions])</h3><p>创建一个<code>randerer</code>实例。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> renderer = <span class="built_in">require</span>(<span class="string">'vue-server-renderer'</span>).createRenderer();</div></pre></td></tr></table></figure></p>
<h3 id="renderer-renderToString-vm-cb"><a href="#renderer-renderToString-vm-cb" class="headerlink" title="renderer.renderToString(vm,cb)"></a>renderer.renderToString(vm,cb)</h3><p>渲染一个<code>string</code>类型的 Vue 实例。它的回调函数是第一个参数为接受到的<code>error</code>对象的标准 Node.js 的回调函数形式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Vue = <span class="built_in">require</span>(<span class="string">'vue'</span>)</div><div class="line"> </div><div class="line"><span class="keyword">const</span> renderer = <span class="built_in">require</span>(<span class="string">'vue-server-renderer'</span>).createRenderer()</div><div class="line"> </div><div class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  render (h) &#123;</div><div class="line">    <span class="keyword">return</span> h(<span class="string">'div'</span>, <span class="string">'hello'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"> </div><div class="line">renderer.renderToString(vm, (err, html) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(html) <span class="comment">// -&gt; &lt;div server-rendered="true"&gt;hello&lt;/div&gt; </span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="renderer-renderToStream-vm"><a href="#renderer-renderToStream-vm" class="headerlink" title="renderer.renderToStream(vm)"></a>renderer.renderToStream(vm)</h3><p>渲染一个流模式的 Vue 实例。返回一个 Node.js 的可读流。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用 express 的一个例子 </span></div><div class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> vm = <span class="keyword">new</span> App(&#123; <span class="attr">url</span>: req.url &#125;)</div><div class="line">  <span class="keyword">const</span> stream = renderer.renderToStream(vm)</div><div class="line"> </div><div class="line">  res.write(<span class="string">`&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;...&lt;/title&gt;&lt;/head&gt;&lt;body&gt;`</span>)</div><div class="line"> </div><div class="line">  stream.on(<span class="string">'data'</span>, chunk =&gt; &#123;</div><div class="line">    res.write(chunk)</div><div class="line">  &#125;)</div><div class="line"> </div><div class="line">  stream.on(<span class="string">'end'</span>, () =&gt; &#123;</div><div class="line">    res.end(<span class="string">'&lt;/body&gt;&lt;/html&gt;'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="createBundleRenderer-code-rendererOptions"><a href="#createBundleRenderer-code-rendererOptions" class="headerlink" title="createBundleRenderer(code,[rendererOptions])"></a>createBundleRenderer(code,[rendererOptions])</h3><p>通过预打包应用程序代码（请看<a href="#creating-the-servver-bundle">服务端打包生成</a>）来创建一个<code>bundleRenderer</code>实例。对于每一次渲染调用，使用 Node.js 的 vm 模块实现代码在新的上下文中重新执行。这确保了你的应用程序状态是在请求之间是相互隔离的，并且你不用担心为了服务端渲染而在一个限制模式下构建你的应用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> bundleRenderer = <span class="built_in">require</span>(<span class="string">'vue-server-renderer'</span>).createBundleRenderer(code)</div></pre></td></tr></table></figure>
<h3 id="bundleRenderer-renderToString-context-cb"><a href="#bundleRenderer-renderToString-context-cb" class="headerlink" title="bundleRenderer.renderToString([context],cb)"></a>bundleRenderer.renderToString([context],cb)</h3><p>渲染一个<code>string</code>类型的打包好的应用。和<code>renderer.renderToString</code>相同的回调接口。这个上下文参数对象将会传递给打包的输出函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">bundleRenderer.renderToString(&#123; <span class="attr">url</span>: <span class="string">'/'</span> &#125;, (err, html) =&gt; &#123;</div><div class="line">  <span class="comment">// ... </span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="bundleRenderer-renderToString-context"><a href="#bundleRenderer-renderToString-context" class="headerlink" title="bundleRenderer.renderToString([context])"></a>bundleRenderer.renderToString([context])</h3><p>渲染一个流模式的打包好的应用。和<code>renderer.renderToStream</code>想用的流式接口。这个上下文对象将会传递给打包的输出函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">bundleRenderer</div><div class="line">  .renderToStream(&#123; <span class="attr">url</span>: <span class="string">'/'</span> &#125;)</div><div class="line">  .pipe(writableStream)</div></pre></td></tr></table></figure>
<h2 id="Renderer-选项"><a href="#Renderer-选项" class="headerlink" title="Renderer 选项"></a><a name="renderer-options">Renderer 选项</a></h2><h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><p>允许你提供一些自定义指令用于服务端渲染的实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> renderer = createRenderer(&#123;</div><div class="line">  <span class="attr">directives</span>: &#123;</div><div class="line">    example (vnode, directiveMeta) &#123;</div><div class="line">      <span class="comment">// transform vnode based on directive binding metadata </span></div><div class="line">      <span class="comment">// 基于绑定元数据的指令转化 vnode</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>还有一个例子，<a href="https://github.com/vuejs/vue/blob/dev/src/platforms/web/server/directives/show.js" target="_blank" rel="external">v-show’s server-side implementation</a>。</p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>提供了一种<a href="#component-caching">组件缓存</a>的实现。这个缓存对象必须实现下面的接口：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">get</span>: <span class="function">(<span class="params">key: string, [cb: <span class="built_in">Function</span>]</span>) =&gt;</span> string | <span class="keyword">void</span>,</div><div class="line">  <span class="attr">set</span>: <span class="function">(<span class="params">key: string, val: string</span>) =&gt;</span> <span class="keyword">void</span>,</div><div class="line">  has?: <span class="function">(<span class="params">key: string, [cb: <span class="built_in">Function</span>]</span>) =&gt;</span> boolean | <span class="keyword">void</span> <span class="comment">// optional </span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>一个典型的应用是传一个 <a href="https://github.com/isaacs/node-lru-cache" target="_blank" rel="external">lrc-cache</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> LRU = <span class="built_in">require</span>(<span class="string">'lru-cache'</span>)</div><div class="line"> </div><div class="line"><span class="keyword">const</span> renderer = createRenderer(&#123;</div><div class="line">  <span class="attr">cache</span>: LRU(&#123;</div><div class="line">    <span class="attr">max</span>: <span class="number">10000</span></div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>注意，缓存对象至少应该设置<code>get</code>和<code>set</code>。另外，<code>get</code>方法如果提供了第二个参数作为回调函数那么还可以选择异步使用。这允许缓存使用异步APIs，例如redis client 例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> renderer = createRenderer(&#123;</div><div class="line">  <span class="attr">cache</span>: &#123;</div><div class="line">    <span class="attr">get</span>: <span class="function">(<span class="params">key, cb</span>) =&gt;</span> &#123;</div><div class="line">      redisClient.get(key, (err, res) =&gt; &#123;</div><div class="line">        <span class="comment">// handle error if any </span></div><div class="line">        cb(res)</div><div class="line">      &#125;)</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">set</span>: <span class="function">(<span class="params">key, val</span>) =&gt;</span> &#123;</div><div class="line">      redisClient.set(key, val)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="为什么使用-bundleRenderer"><a href="#为什么使用-bundleRenderer" class="headerlink" title="为什么使用 bundleRenderer?"></a><a name="why-use-bundlerrenderer">为什么使用 bundleRenderer?</a></h2><p>在一个典型的 Node.js 应用中，后端服务是一个长时间运行的进程。如果我们直接请求我们的应用代码，实例化模块将会在每个请求中共享。这带了一些不方便的限制在我们构建时：比如我们必须避免使用全局状态单例（例如：Vuex里面的store）,否则每一次状态改变都会导致下一次请求被影响。</p>
<p>相反，<code>bundleRenderer</code>更容易保证我们的每一个请求在运行的应用程序中都是“新的”（即实例化模块不共享），这样我们不需要去考虑通过每次请求避免状态污染的问题了。这些都是<code>bundleRenderer</code>帮助我们实现的。</p>
<h2 id="服务端打包生成"><a href="#服务端打包生成" class="headerlink" title="服务端打包生成"></a><a name="creating-the-server-bundle">服务端打包生成</a></h2><p><img src="/images/vue/vue-server-renderer.png" alt="服务端打包生成"></p>
<p>应用程序的打包可以通过任何构建工具生成，你可以使用很简单的 Webpack + vue-loader 还有 bundleRenderer实现。你需要使用略微不同的 webpack 配置和为了服务端渲染的入口文件，但是这个不同是很小的：</p>
<ol>
<li><p>为你的 webpack 配置添加 <code>target:&#39;node&#39;</code> 和 <code>output:{libraryTarget:&#39;commonjs2&#39;}</code> 。这可能是一个比较好的处理你的外部依赖文件的方法。</p>
</li>
<li><p>在你的服务端入口文件抛出一个方法。这个方法将会接收到渲染的上下文对象（传递给<code>bundleRenderer.renderToString</code> 或者 <code>bundleRenderer.renderToStream</code>），并且返回一个Promise，这将最终解决应用程序 Vue 根实例的问题。</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// server-entry.js </span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></div><div class="line"> </div><div class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(App)</div><div class="line"> </div><div class="line"><span class="comment">// 默认的输出应该是一个接收渲染调用时上文对象的函数。</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> context =&gt; &#123;</div><div class="line">  <span class="comment">// data pre-fetching </span></div><div class="line">  <span class="keyword">return</span> app.fetchServerData(context.url).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> app</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="外部依赖"><a href="#外部依赖" class="headerlink" title="外部依赖"></a>外部依赖</h3><p>我们在使用<code>bundleRenderer</code>时，最好在服务端打包时通过默认的打包方式把每一个依赖文件打进我们的应用程序。这意味着在每次请求那些依赖文件时将需要解析和运行一遍，但是在大多数情况下这些是不需要的。</p>
<p>我们能够通过你打的包来优化这些外部依赖关系。在渲染过程中，任何原始的<code>require()</code>调用都将返回实际的 Node 模块从你的渲染进程中。使用 webpack ，我们可以很简单的通过<code>externals</code>配置选项来列举出那些我们想要处理的外部依赖模块。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// webpack.config.js </span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="comment">// 这些外部依赖中的所有模块都在你的package.json文件中的 “dependencies” 下面</span></div><div class="line">  externals: <span class="built_in">Object</span>.keys(<span class="built_in">require</span>(<span class="string">'./package.json'</span>).dependencies)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="外部警告"><a href="#外部警告" class="headerlink" title="外部警告"></a>外部警告</h3><p>由于外部依赖模块在每个请求中是共享的，所以你必须保证这些依赖关系是等同的。这样，通过不同的请求应该总是返回相同的结果，并且它不能拥有通过你的应用程序来改变的全局状态（如：使用 Vue 插件）。</p>
<h2 id="组件缓存"><a href="#组件缓存" class="headerlink" title="组件缓存"></a><a name="component-caching">组件缓存</a></h2><p>你可以容易的通过<code>serverCacheKyy</code>函数来在服务端渲染中来缓存组件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'item'</span>, <span class="comment">// required </span></div><div class="line">  props: [<span class="string">'item'</span>],</div><div class="line">  <span class="attr">serverCacheKey</span>: <span class="function"><span class="params">props</span> =&gt;</span> props.item.id,</div><div class="line">  render (h) &#123;</div><div class="line">    <span class="keyword">return</span> h(<span class="string">'div'</span>, <span class="keyword">this</span>.item.id)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意缓存组件<strong>必须配置唯一的“name”选项</strong>。这对于 Vue 在使用打包渲染时确定组件的身份来说是必须的。</p>
<p>使用唯一的名字来作为缓存组件的的键名：你不用担心两个组件返回相同的键。一个缓存组件的键名应该包含足够的信息来表述它渲染的结果。上面的这种方式是一种很好的实现如果这个渲染结果可以通过<code>props.item.id</code>能完全确定。然而，这个组件随着时间的推移原本的 ID 可能会改变，或者渲染结果还依赖另一个<code>prop</code>,这样你需要去修改你的<code>getCacheKey</code>来实现获取其他的变量在程序中。</p>
<p>返回一个常数总会被缓存，这对于纯粹的静态组件来说是很好的。</p>
<h3 id="什么时候使用组件缓存？"><a href="#什么时候使用组件缓存？" class="headerlink" title="什么时候使用组件缓存？"></a>什么时候使用组件缓存？</h3><p>如果渲染器在渲染期间渲染了一个组件，它将直接为真个子树重用缓存结果。所以<strong>不要缓存包含全局状态的子组件</strong>。</p>
<p>在大多数情况下，你不应该和不需要缓存简单的实例组件。最常见的组件缓存需要大名单。由于这些组件通常是一些由数据库中的对象集合驱动的，他们可以使用一些简单的缓存策略。生成它们的缓存键名使用它们自己的唯一ID加最后更新的时间戳。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">serverCacheKey: <span class="function"><span class="params">props</span> =&gt;</span> props.item.id + <span class="string">'::'</span> + props.item.last_updated</div></pre></td></tr></table></figure>
<h2 id="客户端合成"><a href="#客户端合成" class="headerlink" title="客户端合成"></a><a name="client-side-hydration">客户端合成</a></h2><p>在服务端渲染输出，根元素将会有一个<code>server-rendered=true</code>的属性标记。在客户端，当你使用这个属性挂载一个 Vue 实例到元素上时，它将尝试合成到现有的DOM实例而不是创建新的DOM节点。</p>
<p>在开发模型中，Vue 将维护客户端生成的虚拟DOM树来匹配来自服务端渲染的DOM结构。如果不匹配，它将放弃合成，维持现有DOM并且从头开始渲染。<strong>在生产模型下，这种维护是被禁用的为了更高的性能。</strong></p>
<h2 id="合成警告"><a href="#合成警告" class="headerlink" title="合成警告"></a>合成警告</h2><p>有一些事情需要特别注意，当使用服务端渲染+客户端合成一些特殊HTML结构时，浏览器可能会改变HTML结构。比如，当你写下面这个样的Vue实例的时候：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>hello word<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>浏览器会自动添加<code>tbody</code>到<code>table</code>中，然而，Vue生成的虚拟DOM不会包含<code>tbody</code>，所以将会导致不匹配。为了确保正确的匹配，请准确书写有效的HTML在你的模板中。</p>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>本文为个人在学习 Vue 服务端渲染时，翻译自<a href="https://www.npmjs.com/package/vue-server-renderer" target="_blank" rel="external">npm:vue-server-renderer</a>的README文档，本人初学 Vue 能力有限，翻译有误地方请大家指出。</p>
<p>另外，如果想学习Vue官方的服务端渲染的例子<a href="">vue-ssr-demo-simple</a>和<a href="https://github.com/vuejs/vue-hackernews-2.0" target="_blank" rel="external">vue-hackernews-2.0</a>的例子，而又对各种webpack配置和英文注释有些迷茫，可以看一下我对官方<a href="https://github.com/chping2125/vue-ssr-demo-simple" target="_blank" rel="external">vue-ssr-demo-simple</a>和<a href="https://github.com/chping2125/vue-hackernews-2.0" target="_blank" rel="external">vue-vue-hackernews-2.0</a>一个注释版本，根据自己的理解加的注释。当然个人能力有限，可能有些地方理解有误，还请谅解</p>
<ol>
<li><p><a href="https://github.com/chping2125/vue-ssr-demo-simple" target="_blank" rel="external">vue-ssr-demo-simple 个人理解版本</a></p>
</li>
<li><p><a href="https://github.com/chping2125/vue-hackernews-2.0" target="_blank" rel="external">vue-vue-hackernews-2.0 个人理解版本</a></p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;vue-server-renderer&quot;&gt;&lt;a href=&quot;#vue-server-renderer&quot; class=&quot;headerlink&quot; title=&quot;vue-server-renderer&quot;&gt;&lt;/a&gt;vue-server-renderer&lt;/h1&gt;&lt;p&gt;用于 Vue2.0 的服务端渲染&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这个包是自动生成的。如果你想合并请求请看 GigHub 上的 &lt;a href=&quot;https://github.com/vuejs/vue/blob/dev/src/entries/web-server-renderer.js&quot;&gt;src/entries/web-server-renderer.js&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个包提供了基于 Node.js 的 Vue2.0 服务端渲染。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#installation&quot;&gt;安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#api&quot;&gt;API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#renderer-options&quot;&gt;Renderer 选项&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#why-use-bundlerrenderer&quot;&gt;为什么使用 bundleRenderer?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#creating-the-server-bundle&quot;&gt;服务端打包生成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#component-caching&quot;&gt;组件缓存&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#client-side-hydration&quot;&gt;客户端合成&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Vue" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Vue/"/>
    
    
      <category term="Vue" scheme="https://chping2125.github.io/tags/Vue/"/>
    
      <category term="翻译" scheme="https://chping2125.github.io/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>同一客户端下使用多个git账号</title>
    <link href="https://chping2125.github.io/2016/12/17/gitMore/"/>
    <id>https://chping2125.github.io/2016/12/17/gitMore/</id>
    <published>2016-12-16T17:24:41.000Z</published>
    <updated>2016-12-16T17:29:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>在日常使用git作为仓库使用的时候，有时可能会遇到这样的一些情况：</p>
<pre><code>1. 有两个github账号，一台电脑怎么同时连接这两个账号进行维护呢？
2. 自己用一个github账号，平时用来更新自己的一些资料；公司使用的gitlab（也是git的衍生产品）
</code></pre><p>总结来说，就是同一客户端（即同一台电脑）可能需要连接多个git衍生产品账号（以下简称git账号）。下面就记录一下我配置的方法，也是网上都可以搜到的。</p>
<p>首先来说，配置多个git账号分为两种情况：</p>
<ol>
<li>已经配置过git账号，想在添加一个账号。</li>
<li>没有配置过任何git账号，直接就像配置两个账号<a id="more"></a>
<h1 id="已配置过git账号"><a href="#已配置过git账号" class="headerlink" title="已配置过git账号"></a>已配置过git账号</h1>一般开发用户应该都配置过一个git的账号，让我们先来回顾一下，当时我们是怎样来配置git账号的（<strong>只有熟悉了配置的过程和原理才能更好地去理解</strong>）。</li>
</ol>
<h2 id="回顾配置git账号的过程"><a href="#回顾配置git账号的过程" class="headerlink" title="回顾配置git账号的过程"></a>回顾配置git账号的过程</h2><p>配置git本地和远程github连接通信的方法，网上有很多，想了解的同学可以看一下这里<a href="http://www.cnblogs.com/tinyphp/p/5025311.html" target="_blank" rel="external">http://www.cnblogs.com/tinyphp/p/5025311.html</a>或者想了解如何生成SSH keys的可以看一下这里<a href="http://www.jianshu.com/p/31cbbbc5f9fa/" target="_blank" rel="external">http://www.jianshu.com/p/31cbbbc5f9fa/</a></p>
<p><strong>解释一下：</strong><br>当本地git仓库和github上的仓库进行通信的时候，必须得双方建立连接才行，而SSH keys就是两者建立连接的一把钥匙，只要钥匙对了就完成了其中一步验证了。其中我们可以在生成的SSH keys中看到，里面包含了我们的账号信息和邮箱信息（后面会用到，先提一下）。</p>
<p>还有一步验证就是用户名和邮箱的验证，这个貌似可有可无（具体我也没搞清楚，反正不设置的时候也没有问题），有些连接本地git仓库和github仓库的教程中会有下面这样的设置：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git config --golbal user.name <span class="string">'chping2125'</span> <span class="comment">//以我的git账号为例</span></div><div class="line"></div><div class="line">git config --golbal user.emil <span class="string">'chping_2125@163.com'</span></div><div class="line"><span class="comment">//该邮箱账号是我的github注册时的邮箱</span></div></pre></td></tr></table></figure></p>
<p>这其实就是在设置全局范围的用户名和邮箱的设置，有时不设置这一步，两者之间进行连接会有问题。</p>
<h2 id="设置多账号"><a href="#设置多账号" class="headerlink" title="设置多账号"></a>设置多账号</h2><p>简单回顾玩设置git账号的步骤和一些注意点，进入今天的主题，设置多账号。</p>
<h3 id="清除git的全局设置"><a href="#清除git的全局设置" class="headerlink" title="清除git的全局设置"></a>清除git的全局设置</h3><p>如果你之前在设置本地仓库和github连接的时候设置过<strong>user.name</strong>和<strong>user.email</strong>,那么你必须首先清楚掉该设置，因为不清楚掉该设置，两个账号在提交资料的时候，验证肯定冲突（只能设置一个全局的<strong>user.name</strong>和<strong>user.email</strong>，而你现在有两个账号就对应两个不同的）。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name <span class="string">"your_name"</span></div><div class="line">git config --global user.email  <span class="string">"your_email"</span></div></pre></td></tr></table></figure></p>
<p>就是重新设置覆盖了而已。。。</p>
<p>如果没有设置，可以直接跳转第二部。如果你忘了，最好还是覆盖一下。</p>
<h3 id="生成新站好的SSH-keys"><a href="#生成新站好的SSH-keys" class="headerlink" title="生成新站好的SSH keys"></a>生成新站好的SSH keys</h3><p>前面提到过生成的SSH keys里面包含了账号和邮箱信息，所以新账号必须另外在生成一份SSH keys，当然生成的方式和以前一样。</p>
<p><strong>1. 用ssh-keygen命令生成一组新的id_rsa_new和id_rsa_new.pub</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C <span class="string">"new email"</span></div></pre></td></tr></table></figure></p>
<p>平时我们都是直接回车，默认生成id_rsa和id_rsa.pub。这里特别需要注意，出现提示输入文件名的时候(<code>Enter file in which to save the key (~/.ssh/id_rsa): id_rsa_new</code>)要输入与默认配置不一样的文件名，比如：我这里填的是 id_rsa_new</p>
<p>注：windows用户和mac用户的区别就是，mac中<code>.ssh</code>文件夹在根目录下，所以表示成<code>~/.ssh/</code>,而windwos用户是<code>C:\Users\Administrator\.ssh</code>。<br>下面同理，不在赘述。</p>
<p><strong>2. 执行ssh-agent让ssh识别新的私钥</strong></p>
<p>因为默认只读取id_rsa，为了让SSH识别新的私钥，需将其添加到SSH agent中：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-add ~<span class="regexp">/.ssh/i</span>d_rsa_work</div></pre></td></tr></table></figure></p>
<p>如果出现<code>Could not open a connection to your authentication agent</code>的错误，就试着用以下命令：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh-agent bash</div><div class="line">ssh-add ~<span class="regexp">/.ssh/i</span>d_rsa_work</div></pre></td></tr></table></figure></p>
<p><strong>3. 配置~/.ssh/config文件</strong><br>前面我们在~/.ssh目录下面，使用ssh-keygen -C “your_email” -t rsa 生成公私秘钥，当有多个github账号的时候，可以生成多组rsa的公司密钥。然后配置~/.ssh/config文件（如果没有的话请重新创建一个）。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch config        # 创建config文件</div></pre></td></tr></table></figure></p>
<p>然后修改如下：<br>我的config配置如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 该文件用于配置私钥对应的服务器</div><div class="line"># Default github user(chping_2125@163.com)</div><div class="line">Host git@github.com</div><div class="line"> HostName https://github.com</div><div class="line"> User git</div><div class="line"> IdentityFile ~/.ssh/id_rsa</div><div class="line"></div><div class="line"> # second user(second@mail.com)</div><div class="line"> # 建一个github别名，新建的帐号使用这个别名做克隆和更新</div><div class="line">Host git@code.xxxxxxx.com</div><div class="line"> HostName https://code.xxxxxxx.com    #公司的gitlab</div><div class="line"> User git</div><div class="line"> IdentityFile ~/.ssh/id_rsa_new</div></pre></td></tr></table></figure></p>
<p> 如果存在config文件的话，其实就是往这个config中添加一个Host：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#建一个github别名，新建的帐号使用这个别名做克隆和更新</div><div class="line">Host git@code.xxxxxxx.com</div><div class="line"> HostName https://code.xxxxxxx.com    #公司的gitlab</div><div class="line"> User git</div><div class="line"> IdentityFile ~/.ssh/id_rsa_new</div></pre></td></tr></table></figure>
<p> 其规则就是：从上至下读取<strong>config</strong>的内容，在每个Host下寻找对应的私钥。这里将GitHub SSH仓库地址中的<strong>git@github.com</strong>替换成新建的Host别名如：我直接就写成了<code>git@github.com</code>，那么原地址是：git@github.com:chping2125/test.git，替换后任然是：it@github.com:chping2125/test.git。<br> 如果你配置的是这样：<br> <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 该文件用于配置私钥对应的服务器</div><div class="line"># Default github user(chping_2125@163.com)</div><div class="line">Host git1    #############不同在这里</div><div class="line"> HostName https://github.com</div><div class="line"> User git</div><div class="line"> IdentityFile ~/.ssh/id_rsa</div><div class="line"></div><div class="line"> # second user(second@mail.com)</div><div class="line"> # 建一个github别名，新建的帐号使用这个别名做克隆和更新</div><div class="line">Host git2  #############不同在这里</div><div class="line"> HostName https://code.xxxxxxx.com    #公司的gitlab</div><div class="line"> User git</div><div class="line"> IdentityFile ~/.ssh/id_rsa_new</div></pre></td></tr></table></figure></p>
<p> 那么你原本想在新账号克隆的命令是<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git@xxxxxx.com:chping/test.git</div></pre></td></tr></table></figure></p>
<p> 就要相应的变成<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git2:chping/test.git</div></pre></td></tr></table></figure></p>
<p> <strong>4. 添加新的SSH keys到新账号的SSH设置中</strong><br> 可不要忘了将新生成的SSH keys添加到你的另一个github帐号(或者公司的gitlab)下的SSH Key中。</p>
<p> <strong>测试一下</strong><br> <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ssh -T git@github.com</div><div class="line">Hi BeginMan! You've successfully authenticated, but GitHub does not provide shell access.</div><div class="line"></div><div class="line"># 上面是github的成功返回语句，下面是gitlab的成功返回语句。</div><div class="line"></div><div class="line">$ ssh -T git@xxxxxx.com</div><div class="line">Welcome to GitLab, chping!</div></pre></td></tr></table></figure></p>
<h2 id="一次性配置两个账号"><a href="#一次性配置两个账号" class="headerlink" title="一次性配置两个账号"></a>一次性配置两个账号</h2><p>其实同理上面，先配置一个，在配置两一个。</p>
<p>。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.cnblogs.com/BeginMan/p/3548139.html" target="_blank" rel="external">http://www.cnblogs.com/BeginMan/p/3548139.html</a><br><a href="https://my.oschina.net/csensix/blog/184434" target="_blank" rel="external">https://my.oschina.net/csensix/blog/184434</a><br><a href="http://blog.csdn.net/guang09080908/article/details/46545335" target="_blank" rel="external">http://blog.csdn.net/guang09080908/article/details/46545335</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在日常使用git作为仓库使用的时候，有时可能会遇到这样的一些情况：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. 有两个github账号，一台电脑怎么同时连接这两个账号进行维护呢？
2. 自己用一个github账号，平时用来更新自己的一些资料；公司使用的gitlab（也是git的衍生产品）
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;总结来说，就是同一客户端（即同一台电脑）可能需要连接多个git衍生产品账号（以下简称git账号）。下面就记录一下我配置的方法，也是网上都可以搜到的。&lt;/p&gt;
&lt;p&gt;首先来说，配置多个git账号分为两种情况：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;已经配置过git账号，想在添加一个账号。&lt;/li&gt;
&lt;li&gt;没有配置过任何git账号，直接就像配置两个账号
    
    </summary>
    
      <category term="工具" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="GIT" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/GIT/"/>
    
    
      <category term="Github" scheme="https://chping2125.github.io/tags/Github/"/>
    
      <category term="Git" scheme="https://chping2125.github.io/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript原型链深入理解</title>
    <link href="https://chping2125.github.io/2016/11/30/JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/"/>
    <id>https://chping2125.github.io/2016/11/30/JavaScript原型链深入理解/</id>
    <published>2016-11-30T03:51:08.000Z</published>
    <updated>2016-11-30T03:58:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>在JS中，原型链是一个重要的概念，不管是继承还是属性值的查找中，都用到了原型链的基本知识，有些朋友经常问我一些关于原型链的问题，今天整理一下自己对原型链的理解，下次我就不用在去解释了，直接看文章。</p>
<p>首先，大家都知道在JS中有六种<strong>基本数据</strong>类型和一种<strong>复杂类型</strong>。<br>六种基本数据类型：</p>
<blockquote>
<ol>
<li>String</li>
<li>Number</li>
<li>Boolean</li>
<li>null</li>
<li>undefined</li>
<li>Symbol（ES2015新加入，解决属性名的冲突问题。<a href="http://es6.ruanyifeng.com/#docs/symbol" target="_blank" rel="external">详情</a>）</li>
</ol>
</blockquote>
<p>另外一种复杂类型自然而然就是<strong>Object</strong>，有的人也说JS中<strong>一切皆是对象</strong>。上面的六种基本数据类型中，除了null和undefined没有构造函数外，其他4种都对应有其构造函数对象，有时利用这些构造函数可以强制转换数据类型。</p>
<p>要想讲清楚原型链的一些问题，还有一个特殊的Object对象必须事先说清楚，那就是<strong>Function</strong>对象。它也是对象，只不过比其他普通对象复杂点罢了。</p>
<a id="more"></a>
<h1 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h1><p>首先我们先写一个大家熟悉的组合继承(原型链+构造函数)，然后根据这个组合继承去了解原型链到底是怎样连接起来的。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//父类</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span> <span class="keyword">instanceof</span> Person)&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.age = age;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    Person.call(<span class="keyword">this</span>,name,age);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Person.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name +<span class="string">'，今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了！'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//子类</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,gride</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span> <span class="keyword">instanceof</span> Student)&#123;</div><div class="line">    Person.call(<span class="keyword">this</span>,name,age);</div><div class="line">    <span class="keyword">this</span>.gride = gride;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    Student.call(<span class="keyword">this</span>,name,age,gride);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Student.prototype = <span class="keyword">new</span> Person();</div><div class="line">Student.prototype.constructor = Student;</div><div class="line"></div><div class="line">Student.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name +<span class="string">'，今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了，考试考了'</span> + <span class="keyword">this</span>.gride + <span class="string">'分！'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'chping'</span>,<span class="number">23</span>,<span class="number">100</span>);</div><div class="line">stu.say();</div></pre></td></tr></table></figure></p>
<p>此时会输出<strong>我叫chping，今年23岁了，考试考了100分！</strong>，这说明我们的组合继承就实现了，下面可以根据这个例子逐句解释一下原型链的相关问题，顺便讲解这个组合继承了。</p>
<h2 id="第一个问题：安全使用构造函数"><a href="#第一个问题：安全使用构造函数" class="headerlink" title="第一个问题：安全使用构造函数"></a>第一个问题：安全使用构造函数</h2><p>首先可能你对<strong>Person</strong>和<strong>Student</strong>里面的那个判断有些疑问，你可能是下面这样写构造函数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">   <span class="keyword">this</span>.name = name;</div><div class="line">   <span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>不这样写，主要是<strong>防止构造函数被执行</strong>，因为一旦构造函数执行，其内的属性值会被挂载到window上面去了（当构造函数执行的时候，里面的<strong>this</strong>是指向window的）。</p>
<p>好的，这个问题解决了，在看第二个问题。</p>
<h2 id="第二个问题：prototype对象"><a href="#第二个问题：prototype对象" class="headerlink" title="第二个问题：prototype对象"></a>第二个问题：prototype对象</h2><p>接着我们来体会一下下面这句话：</p>
<p><strong>每一个函数对象都有一个prototype属性，该属性指向其prototype对象</strong>。</p>
<p>这句话相信你已经听了很多遍了，可能并不是这样说的，但是就是这么个意思。那么这句话应该怎么理解呢？</p>
<p>其实也不难，先看前半部分<strong>每一个函数对象都有一个prototype属性</strong>。这半句就是说<strong>函数对象</strong>默认有一个属性，这个属性叫<strong>prototype</strong>。另外，函数对象就是指用<strong>function</strong>声明的对象（补充一下：在ES2015之前，有两种声明变量的方式，<strong>function</strong>用来声明函数变量，<strong>var</strong> 用来声明普通变量。但是在ES2015中新加了<strong>let</strong>和<strong>const</strong>）。</p>
<p>再看一下后半部分<strong>该属性指向其prototype对象</strong>。后半句的意思就是说<strong>prototype</strong>属性指向的是一个也叫<strong>prototype</strong>的对象，该对象是随着函数对象而产生的。也就是说，只要通过<strong>function</strong>定义一个函数对象，就会生成一个<strong>prototype对象</strong>，并在函数上生成一个<strong>prototype属性</strong>来指向该<strong>prototype属性</strong>。用图来表示一下就是下面的样子：<br><img src="/images/prototype/1.jpg" alt="构造函数与其prototype对象">;</p>
<p>从图中你可以看到还有一个知识点，就是<strong>prototype对象</strong>中还有一个<strong>constructor</strong>对象，该对象又指向了构造函数，这也是一个需要注意的知识点，后面我们在展开来说，这里先记一下。</p>
<p>通过上面的这句话，我们可以联想到，Object好像也是一个构造函数，Function好像也是一个函数，他们是不是也是这样的呢？回答是肯定的，他们也是这样的。如下图：<br><img src="/images/prototype/2.jpg" alt="Object的构造函数与其prototype对象">;<br><img src="/images/prototype/3.jpg" alt="Function的构造函数与其prototype对象">;</p>
<h2 id="第三个问题：-proto-属性"><a href="#第三个问题：-proto-属性" class="headerlink" title="第三个问题：__proto__属性"></a>第三个问题：<code>__proto__</code>属性</h2><p>先说明一下，<code>__proto__</code>的写法是前后各两个英文输入法下的下划线，不是一个。<br>然后我们再来看这样一句话：</p>
<p><strong>每一个对象都有一个<code>__protto__</code>属性，该属性指向创建这个对象的构造函数的prototype对象</strong>。</p>
<p>这句话稍微有点绕，我再来解释一下这句话。这句话的前半部分比较好理解，就是说JS中的每一个对象都有一个属性，这个属性的名字叫做<code>__proto__</code>，还要再说的话，就是注意<strong>JS中一切皆是对象</strong>这句话。</p>
<p>这句话后半部分有点绕，我们把它分成两句话去理解：</p>
<ol>
<li><strong>创建这个对象的构造函数</strong></li>
<li><strong>的prototype对象</strong></li>
</ol>
<p>这样就明白了，但是创建这个对象的构造函数怎么确定呢？这是个问题，不好解释，我也解释不好。就总结一下:</p>
<ol>
<li><strong>function定义的函数对象的<code>__proto__</code>属性指向Function对象的prototype对象</strong>。</li>
<li><strong>非function定义的对象的<code>__proto__</code>属性指向创建它的构造函数的prototype对象</strong>。（就是都指向Object的prototype对象）</li>
<li><strong>Object的prototype对象的<code>__proto__</code>指向null</strong>。</li>
</ol>
<p>还是看图吧：</p>
<p><img src="/images/prototype/4.png" alt="对象的__proto__属性">;</p>
<p>相信通过图你已经看懂了<code>__proto__</code>属性的指向问题了。</p>
<h2 id="思考组合继承"><a href="#思考组合继承" class="headerlink" title="思考组合继承"></a>思考组合继承</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//父类</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span> <span class="keyword">instanceof</span> Person)&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.age = age;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    Person.call(<span class="keyword">this</span>,name,age);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//上面通过function声明了一个函数对象，那么该对象的肯定有一个prototype属性，</span></div><div class="line"><span class="comment">//并且指向其prototype对象。我们可以打印验证一下</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(Person.prototype);</div><div class="line"><span class="comment">/*打印结果如下</span></div><div class="line">&#123;</div><div class="line">  constructor: function Person(name,age)</div><div class="line">    arguments:null</div><div class="line">    caller:null</div><div class="line">    length:2</div><div class="line">    name:"Person"</div><div class="line">    prototype:Object</div><div class="line">    __proto__:function()  </div><div class="line">  ,</div><div class="line">  __proto__: Object</div><div class="line">&#125;</div><div class="line">*/</div></pre></td></tr></table></figure>
<p>这说明<strong>prototype对象</strong>就是一个空对象添加了一个<strong>constructor属性</strong>。<br>另外，也看到了<strong>prototype</strong>对象有一个<code>__proto__</code>属性，指向Object，先记住。<br>此外，我们也看到了<strong>constructor</strong>指向的Person函数确实存在prototype属性和<code>__proto__</code>属性，以及其指向问题，我们同时也可以打印验证一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(Person.prototype.constructor === Person);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(Person.prototype.__proto__=== <span class="built_in">Object</span>.prototype);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(Person.__proto__=== <span class="built_in">Function</span>.prototype);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>我们再来验证一下<strong>Object</strong>和<strong>Function</strong>的prototype属性，constructor属性还有<code>__proto__</code>属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype);</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.constructor === <span class="built_in">Object</span>);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.__proto__ === <span class="literal">null</span>);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.__proto__ === <span class="built_in">Function</span>.prototype);<span class="comment">//true</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.prototype);</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.prototype.constructor === <span class="built_in">Function</span>);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.prototype.__proto__ === <span class="built_in">Object</span>.prototype);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.__proto__ === <span class="built_in">Function</span>.prototype);<span class="comment">//true</span></div></pre></td></tr></table></figure></p>
<p>OK，相信大家对原型链有了一定了解了。我们接着往下看。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Person.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name +<span class="string">'，今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了！'</span>)</div><div class="line">&#125;</div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure></p>
<p>在Person的<strong>prototype对象</strong>上添加了一个say方法，和给普通对象添加方法并没有区别，只不过在稍后使用的时候才会展现出它的与众不同。</p>
<p>接下来是Student类:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,gride</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span> <span class="keyword">instanceof</span> Student)&#123;</div><div class="line">    Person.call(<span class="keyword">this</span>,name,age);</div><div class="line">    <span class="keyword">this</span>.gride = gride;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    Student.call(<span class="keyword">this</span>,name,age,gride);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在此时，Student和Person以<code>Person.call(this,name,age);</code>这一句代码产生了联系，此时Student仅仅是通过构造函数继承的方式调用了Person，这并不是本文重点，我们此时可以认为原型链上Student和Person并没有任何联系，让它们在原型链上产生联系的是下面这条语句。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Student.prototype = <span class="keyword">new</span> Person();</div><div class="line">Student.prototype.constructor = Student;</div></pre></td></tr></table></figure></p>
<p>我们来想想这两条语句都干了啥？<br>首先我们知道，Student函数对象在被<strong>function</strong>声明的时候已经生成了其<strong>prototype</strong>对象，并且通过<strong>prototype属性</strong>建立了联系。<br>这里的第一条语句居然是，<strong>改变了Student函数对象的prototype属性指向，不再指向function声明时自动生成的prototype对象，而是指向Person函数对象的一个实例对象。</strong>让我们用图展示一下，就成了下面这样：</p>
<p><img src="/images/prototype/5.png" alt="原型链继承关键步骤图解">;</p>
<p>OK，原型链继承就这样实现了。但是由于我们让<strong>Student</strong>函数对象的<strong>prototype</strong>属性重新指向了一个<strong>Person</strong>函数对象的实例，而这个实例对象里面是不可能有<strong>constructor</strong>属性的，自然也不会指向<strong>Student</strong>（为什么没有呢？前面已经说了，因为只有用<strong>function</strong>声明函数对象的时候，自动生成的<strong>prototype对象</strong>中才默认有<strong>constructor属性</strong>，其他对象不会有）。</p>
<p>接下来就是在Student函数对象新指向的prototype对象上添加say方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Student.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name +<span class="string">'，今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了，考试考了'</span> + <span class="keyword">this</span>.gride + <span class="string">'分！'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个就没有说的必要了，就是在对象上加了一个方法，只不过这个对象有些特别罢了。然后就是通过Student构造函数来生成实例：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'chping'</span>,<span class="number">23</span>,<span class="number">100</span>);</div><div class="line">stu.say();</div></pre></td></tr></table></figure></p>
<p>此时，我们还是要看看这两句干了啥？<br>先看第一句，<code>new Student(&#39;chping&#39;,23,100);</code>，其中我们必须先得知道关键字<strong>new</strong>做了什么：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;</div><div class="line">Student.call(<span class="keyword">this</span>,<span class="string">'chping'</span>,<span class="number">23</span>,<span class="number">100</span>);</div><div class="line">obj.__proto__ = Student.prototype;</div><div class="line"><span class="keyword">return</span> obj;</div></pre></td></tr></table></figure></p>
<p>这样相信你就明白，第一句干的活了:</p>
<ol>
<li>首先创建一个空对象。</li>
<li>将属性挂载到该空对象上。</li>
<li>将空对象的<code>__proto__</code>属性连接到Student函数对象的prototype对象上，来生成原型链。</li>
<li>返回该对象给stu变量。</li>
</ol>
<p>接下来就是第二句<code>stu.say()</code>，这句话的意思就是<strong>stu实例</strong>对象调用<strong>say方法</strong>，但是在查找的时候发现，<strong>stu实例</strong>对象上并没有这个方法，于是<strong>原型链</strong>就来了。此时他会根据其<code>__proto__</code>属性来查找<strong>Student</strong>函数对象的<strong>prototype对象</strong>上有没有<strong>say方法</strong>，然后它发现正好有一个<strong>say方法</strong>，于是就可以执行该方法了。</p>
<p>此时又产生一个问题，在执行Student函数对象的prototype上的say方法时，里面的<strong>this</strong>指向谁呢？<br>可以想一下，此时<strong>say</strong>方法是被谁调用的，很明显是<strong>stu</strong>实例对象，所以<strong>this</strong>指向<strong>stu</strong>，所以，<code>this.name</code>、<code>this.age</code>、<code>this.gride</code>就是实例对象<strong>stu</strong>上面的<code>chping</code>、<code>23</code>、<code>100</code>了。</p>
<p>下面我们再来看一下完整的原型链继承的图解，如果你能完全看懂这张图，那么你对原型链的理解也就差不多了。<br><img src="/images/prototype/6.jpg" alt="原型链继承图解">;</p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>原型链的基础知识差不多通过上面这个例子就介绍完了，我们来总结一下：</p>
<ol>
<li><strong>每一个函数对象都有一个prototype属性，该属性指向其prototype对象</strong>。</li>
<li><strong>每一个对象都有一个<code>__protto__</code>属性，该属性指向创建这个对象的构造函数的prototype对象</strong>。<ol>
<li><strong>function定义的函数对象的<strong>proto</strong>属性指向Function对象的prototype对象</strong>。</li>
<li><strong>非function定义的对象的<strong>proto</strong>属性指向创建它的构造函数的prototype对</strong>。（就是都指向Object的prototype对象）</li>
<li><strong>Object的prototype对象的<strong>proto</strong>指向null</strong>。</li>
</ol>
</li>
</ol>
<p>然后在看看下面几个常见的原型链的小题目，相信你对原型链会有一个新的认识了。</p>
<h2 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</div><div class="line">Person.prototype.name =<span class="number">2</span>;</div><div class="line"><span class="built_in">console</span>.log(person1.name); </div><div class="line"><span class="built_in">console</span>.log(person1.__proto__.name); </div><div class="line"></div><div class="line">Person.prototype = &#123;</div><div class="line">  <span class="attr">name</span>:<span class="number">3</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(person1.name); </div><div class="line"><span class="built_in">console</span>.log(person1.__proto__.constructor);</div><div class="line"><span class="built_in">console</span>.log(person1.__proto__.name);</div><div class="line"></div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</div><div class="line"><span class="built_in">console</span>.log(person2.__proto__.name); </div><div class="line"><span class="built_in">console</span>.log(person2.__proto__.constructor == <span class="built_in">Object</span>);</div><div class="line"><span class="built_in">console</span>.log(person2.name);</div></pre></td></tr></table></figure>
<p>上面的<code>console.log</code>会打印什么？<br>这个题考察的是对prototype对象的理解。</p>
<h2 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Outer</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Inner</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> outer = <span class="keyword">new</span> Outer();</div><div class="line">Inner.prototype = outer;</div><div class="line"><span class="keyword">var</span> inner = <span class="keyword">new</span> Inner();</div><div class="line"></div><div class="line">inner.a = inner.a + <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(inner);</div><div class="line"><span class="built_in">console</span>.log(outer);</div></pre></td></tr></table></figure>
<p>猜猜上面会是什么结果？<br>这个题考察的是对实例对象上属性的理解。</p>
<h2 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> animal = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"><span class="keyword">var</span> dog =<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">animal.price = <span class="number">2000</span>;</div><div class="line">dog.prototype = animal;</div><div class="line"><span class="keyword">var</span> dd = <span class="keyword">new</span> dog();</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(dog.price);</div><div class="line"><span class="built_in">console</span>.log(dd.price);</div></pre></td></tr></table></figure>
<p>在分析一下这个题目的输出结果？<br>这个题目考察的是<code>__proto__</code>属性的理解。</p>
<h2 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h2><p>下面放大招了，这个题目可能不完全是原型链的问题，对JS基础知识的一个综合考察，可以试一试：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">a.param = <span class="number">123</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo.get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">foo.prototype.get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo.get();</div><div class="line">get();</div><div class="line">foo().get();</div><div class="line">get();</div><div class="line"><span class="keyword">new</span> foo.get();</div><div class="line"><span class="keyword">new</span> foo().get();</div><div class="line"><span class="keyword">new</span> <span class="keyword">new</span> foo().get();</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在JS中，原型链是一个重要的概念，不管是继承还是属性值的查找中，都用到了原型链的基本知识，有些朋友经常问我一些关于原型链的问题，今天整理一下自己对原型链的理解，下次我就不用在去解释了，直接看文章。&lt;/p&gt;
&lt;p&gt;首先，大家都知道在JS中有六种&lt;strong&gt;基本数据&lt;/strong&gt;类型和一种&lt;strong&gt;复杂类型&lt;/strong&gt;。&lt;br&gt;六种基本数据类型：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;String&lt;/li&gt;
&lt;li&gt;Number&lt;/li&gt;
&lt;li&gt;Boolean&lt;/li&gt;
&lt;li&gt;null&lt;/li&gt;
&lt;li&gt;undefined&lt;/li&gt;
&lt;li&gt;Symbol（ES2015新加入，解决属性名的冲突问题。&lt;a href=&quot;http://es6.ruanyifeng.com/#docs/symbol&quot;&gt;详情&lt;/a&gt;）&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;另外一种复杂类型自然而然就是&lt;strong&gt;Object&lt;/strong&gt;，有的人也说JS中&lt;strong&gt;一切皆是对象&lt;/strong&gt;。上面的六种基本数据类型中，除了null和undefined没有构造函数外，其他4种都对应有其构造函数对象，有时利用这些构造函数可以强制转换数据类型。&lt;/p&gt;
&lt;p&gt;要想讲清楚原型链的一些问题，还有一个特殊的Object对象必须事先说清楚，那就是&lt;strong&gt;Function&lt;/strong&gt;对象。它也是对象，只不过比其他普通对象复杂点罢了。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="JavaScript" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/JavaScript/"/>
    
    
      <category term="JavaScript基础" scheme="https://chping2125.github.io/tags/JavaScript%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>Vue和React对比</title>
    <link href="https://chping2125.github.io/2016/11/28/Vue%E5%92%8CReact%E5%AF%B9%E6%AF%94/"/>
    <id>https://chping2125.github.io/2016/11/28/Vue和React对比/</id>
    <published>2016-11-28T15:26:18.000Z</published>
    <updated>2016-11-28T15:30:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>Vue也已经升级到2.0版本了，到现在为止（2016/11/19）比较流行的MVVM框架有<strong>AngularJS</strong>（也有人认为其为MVC）、<strong>ReactJS</strong>和<strong>VueJS</strong>，这三个框架中，以我现在的情况来说（AngularJS2还没有去接触），ReactJS和VueJS的对比应该是比较适合的，感觉这哥俩就是好基友，不管是<strong>单向数据流</strong>、<strong>组件化思想</strong>、还是构建大型应用的<strong>路由</strong>和<strong>状态管理</strong>都有些许相似之处。而AngularJS与Jquery对比我个人觉着比较合适。</p>
<p>为什么现在MVVM框架这么火呢？JQuery挺好用的呀，为什么要去代替它？…</p>
<p>可能会产生这样的疑问，在我看来，MVVM框架的流行是因为随着前端技术的发展对于要求越来越高和前端面对的场景越来越复杂导致了现实对于前端性能的要求也越来越高，这样像JQuery那样频繁的操作DOM节点的方式显然就不太合适了。所以MVVM开始逐渐流行开来，另外我认为JQuery目前来看还是不会被代替的，因为对于一些对性能要求不是很高的前端项目，是用JQuery来开发还是非常爽的。</p>
<p>废话有点多了，进入正题。接下来从<strong>数据双向绑定</strong>、<strong>组件及数据流</strong>、<strong>路由</strong>、<strong>状态管理</strong>等方面来分别对比一下怎样去使用Vue和React。</p>
<a id="more"></a>
<h1 id="数据双向绑定"><a href="#数据双向绑定" class="headerlink" title="数据双向绑定"></a>数据双向绑定</h1><p>我理解的数据双向绑定是，MVVM框架中的View层和Model层的数据相互影响。那么，那些行为会引起数据变动呢？<br>首先，View层（即页面上）的<strong>表单操作</strong>、<strong>触发事件</strong>可能会引起数据变动；<strong>ajax请求</strong>也可能会引起数据变动，这个变动我认为更多在Model层；还有一种情况就是，<strong>某一数据变动引起另外关联数据</strong>的改变。<br>不管是哪一种数据改变，都会导致View层和Model层的变化，View层变动引起页面变化，Model层变动保存数据。</p>
<h2 id="Vue的数据双向绑定"><a href="#Vue的数据双向绑定" class="headerlink" title="Vue的数据双向绑定"></a>Vue的数据双向绑定</h2><p>在Vue中，View层中与数据绑定有关的有<strong>插值表达式</strong>、<strong>指令系统</strong>、<strong>*Class和Style</strong>、<strong>事件处理器</strong>和<strong>表单控件</strong>，<strong>ajax请求</strong>和<strong>计算属性</strong>也和数据变化有关，下面我们分别说一下这些知识点设计的一些数据绑定问题。</p>
<h3 id="插值表达式"><a href="#插值表达式" class="headerlink" title="插值表达式"></a>插值表达式</h3><p>在Vue中，<strong>插值表达式</strong>和<strong>指令</strong>对于数据的操作又称为<strong>模板语法</strong>。</p>
<blockquote>
<p>Vue.js 使用了基于 HTML 的模版语法，允许开发者声明式地将 DOM 绑定至底层 Vue 实例的数据。所有 Vue.js 的模板都是合法的 HTML ，所以能被遵循规范的浏览器和 HTML 解析器解析。</p>
<p>在底层的实现上， Vue 将模板编译成虚拟 DOM 渲染函数。结合响应系统，在应用状态改变时， Vue 能够智能地计算出重新渲染组件的最小代价并应用到 DOM 操作上。</p>
</blockquote>
<p>关于插值表达式的使用，在<a href="http://cn.vuejs.org/v2/guide/syntax.html#插值l" target="_blank" rel="external">Vue官网模板语法的插值</a>部分有详细的使用说明，不在赘述，需要注意的是，<strong>过滤器</strong>在插值中的使用有时可以起到意想不到的效果。</p>
<h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><p>Vue重的指令估计是从Angular那里学来的，有很多相似的地方，但是也不完全相同。<br>Vue中的指令我觉着非常的简单，并且就12个，很容易记忆：</p>
<ol>
<li><strong>v-bind</strong>:动态地绑定一个或多个 <em>html属性</em>，或一个组件 <em>prop 到表达式</em>（组件单项数据流使用）。</li>
<li><strong>v-once</strong>:绑定只渲染元素和组件 <em>一次</em> 的特性或prop表达式。</li>
<li><strong>v-model</strong>:在表单控件或者组件上创建双向绑定，<em>代替value值</em>。</li>
<li><strong>v-text</strong>:更新元素的 <em>textContent</em>。</li>
<li><strong>v-html</strong>:更新元素的 <em>innerHTML</em>。<strong>注意：内容按普通 HTML 插入 - 不会作为 Vue 模板进行编译</strong> 。</li>
<li><strong>v-on</strong>:绑定事件监听器。</li>
<li><strong>v-if / v-else / v-show</strong>:条件渲染。</li>
<li><strong>v-for</strong>:列表渲染。</li>
<li><strong>v-pre</strong>:跳过这个元素和它的子元素的编译过程。<br>10 <strong>v-cloak</strong>:这个指令保持在元素上直到关联实例结束编译。和 CSS 规则如 <code>[v-cloak] { display: none }</code>一起用时，这个指令可以隐藏未编译的 Mustache 标签直到实例准备完毕。</li>
</ol>
<p>大概列举一下，详细使用请参考<a href="http://cn.vuejs.org/v2/api/#指令" target="_blank" rel="external">Vue API 指令</a>和<a href="http://cn.vuejs.org/v2/guide/" target="_blank" rel="external">Vue 指南的Class与Style绑定、条件渲染、列表渲染、事件处理器、表单控件绑定</a>部分内容。</p>
<h3 id="Class与Style绑定"><a href="#Class与Style绑定" class="headerlink" title="Class与Style绑定"></a>Class与Style绑定</h3><p>Vue为了方便操作控制元素的样式，专门增强了<strong>v-bind:class</strong>和<strong>v-bind:style</strong>,通过增强的这两个指令可以实用<strong>对象语法</strong>或者<strong>数组语法</strong>对元素的样式进行变动，这也不是本文重点，<a href="http://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="external">Vue官方Class与Style绑定</a>已经说得很详细了。</p>
<h3 id="条件渲染和列表渲染"><a href="#条件渲染和列表渲染" class="headerlink" title="条件渲染和列表渲染"></a>条件渲染和列表渲染</h3><p>条件渲染和列表渲染在Vue模板中动态创建模板很不错，让我里面想到了JSP中的EL表达式和Struts中的JSTL(后端模板语言中基本都有)，这就可以方便的根据后端传过来的数据进行模板创建了。你懂得，详细语法和使用还是参考<a href="http://cn.vuejs.org/v2/guide/conditional.html" target="_blank" rel="external">Vue文档列表渲染和条件渲染</a>，本篇主题是对比，并不是讲解基础语法，Vue的官方文档我觉着非常给力，简单明了。</p>
<h3 id="事件处理器"><a href="#事件处理器" class="headerlink" title="事件处理器"></a>事件处理器</h3><p>在Vue中我们可以通过<strong>v-on</strong>来给元素注册事件，完成<a href="http://cn.vuejs.org/v2/guide/events.html" target="_blank" rel="external">事件注册</a>，Vue中的事件处理和平时使用的事件处理不同之处就是，既可以绑定数据处理函数，也可以使用内联处理器。并且，Vue还讲常用的事件方法，如<strong>preventDefault()</strong>等通过修饰符的方式来方便使用。</p>
<h3 id="表单控件"><a href="#表单控件" class="headerlink" title="表单控件"></a>表单控件</h3><p>你可以用<strong>v-model</strong>指令在表单控件元素上创建双向数据绑定。它会根据控件类型自动选取正确的方法来更新元素。</p>
<p>Vue中对于<a href="http://cn.vuejs.org/v2/guide/forms.html" target="_blank" rel="external">表单控件</a>提供的<em>v-model*</em>指令非常的使用，可以方便的返回或者设置表单控件的信息。</p>
<h3 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h3><p>在Vue中引入了<strong>计算属性</strong>来处理模板中放入太多的逻辑会让模板过重且难以维护的问题，这样不但解决了上面的问题，而且也同时让模板和业务逻辑更好的分离。<br><a href="http://cn.vuejs.org/v2/guide/computed.html" target="_blank" rel="external">Vue计算属性</a></p>
<h3 id="ajax数据请求"><a href="#ajax数据请求" class="headerlink" title="ajax数据请求"></a>ajax数据请求</h3><p>在Vue1.x的版本中，官方推荐的ajax数据请求库是<strong>vue-resource</strong>，但是在Vue2.0的版本中，不再推荐使用，该推荐使用<strong><a href="https://github.com/mzabriskie/axios" target="_blank" rel="external">axios</a></strong>。</p>
<p>其实这些ajax数据请求的使用都大差不差，随你选择，并且<strong>vue-resource</strong>还是继续支持使用的，在Vue2.0中。</p>
<p>以上八个方面，我个人认为都是和数据绑定相关的一些Vue基本项，只是简单列举，具体内容请查看<a href="http://cn.vuejs.org/v2/guide" target="_blank" rel="external">Vue文档</a>或者<a href="http://cn.vuejs.org/v2/api/" target="_blank" rel="external">API</a>。<br>为什么这么多呢？因为Vue中有个<strong>模板</strong>的概念，所以，数据和模板进行数据绑定需要分别来做，而在接下来的React中，你会发现，React的数据绑定虽然也是这八项，但是，不会展开八项来说明。</p>
<h2 id="React中的数据双向绑定"><a href="#React中的数据双向绑定" class="headerlink" title="React中的数据双向绑定"></a>React中的数据双向绑定</h2><p>在上面的Vue中，我们已经提及了有八个方面可以影响到数据的改变，但是React中就没有必要展开了说明了，因为在React中没有Vue中模板的概念，因为人家有一个JSX语法呀，可以将HTML和JS还有CSS混合写在一起呀，，这样写成的<strong>组件</strong>感觉还不错，<strong>组件化</strong>也是ReactJS的重要特点之一。</p>
<p>React中通过将<strong>state</strong>（Model层） 与View层数据进行双向绑定达到数据的实时更新变化，具体来说就是在View层直接写JS代码将Model层中的数据拿过来渲染，一旦像<strong>表单操作</strong>、<strong>触发事件</strong>、<strong>ajax请求</strong>等触发数据变化，则进行双向同步。</p>
<p>所以说React的特点是<strong>组件化</strong>，也就是说，接下来的小节才是React的重点部分。</p>
<h1 id="组件及数据流"><a href="#组件及数据流" class="headerlink" title="组件及数据流"></a>组件及数据流</h1><p>前端发展到现在，为了提高开发效率，组件化已经成为一个必然的趋势。而MVVM框架中，如果没有组件化的思想，它都不敢说拿出来宣传（纯属个人意淫，哈哈）。下面我们再分别简单介绍一下VueJS和ReactJS中<strong>组件思想</strong>和<strong>组件之间的数据流</strong>。</p>
<h2 id="React中的组件和数据流"><a href="#React中的组件和数据流" class="headerlink" title="React中的组件和数据流"></a>React中的组件和数据流</h2><p>上一节中提到过，React中的组件化是其重要的特点之一，因为在Angular1.x的出现，并没有明确提出组件的思想，只是有一个类似的<strong>指令思想</strong>来实现组件化的方式。所以，当React中明确提出<strong>组件</strong>思想后，前端好像重生了（吹的有点大了）。</p>
<h3 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h3><p>React中实现组件有两种方式，一种是<strong>createClass</strong>方法，另一种是通过ES2015的思想<strong>类继承React.Component</strong>来实现。</p>
<h4 id="createClass方式实现"><a href="#createClass方式实现" class="headerlink" title="createClass方式实现"></a>createClass方式实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">   render() &#123;</div><div class="line">     <span class="keyword">return</span> (</div><div class="line">       <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">     )</div><div class="line">   &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>这样，一个组件就创建完成，并且通过ES2015的模块化思想将其暴露出去了，其他组件就可以引入并使用了。如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'./hello.jsx'</span>;</div><div class="line"></div><div class="line">ReactDom.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Hello</span>/&gt;</span></span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>OK，这样就使用简单使用了一个组件。</p>
<h4 id="类继承React-Component来实现"><a href="#类继承React-Component来实现" class="headerlink" title="类继承React.Component来实现"></a>类继承React.Component来实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentItem</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"comment"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.author &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.date &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.props.children &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentItem <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure>
<p>需要注意的是，这样创建组件的时候，组件名称首字母必须大写（如：CommentItem）。同样，我们使用一下这个组件。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> CommentItem <span class="keyword">from</span> <span class="string">'./comment-item'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">let</span> CommentNodes = <span class="keyword">this</span>.props.data.map(<span class="function">(<span class="params">comment, index</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> (</div><div class="line">        <span class="xml"><span class="tag">&lt;<span class="name">CommentItem</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">author</span>=<span class="string">&#123;comment.author&#125;</span> <span class="attr">date</span>=<span class="string">&#123;comment.date&#125;</span>&gt;</span></span></div><div class="line">          &#123;comment.content&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">CommentItem</span>&gt;</span></div><div class="line">      )</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        &#123; CommentNodes &#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentList <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p>这样我们又创建了一个组件，并且在这个组件中我们使用了上面创建的那个组件。</p>
<h3 id="组件之间的数据流"><a href="#组件之间的数据流" class="headerlink" title="组件之间的数据流"></a>组件之间的数据流</h3><p>在上面<strong>类继承React.Component来实现</strong>一节中，我们可以看出例子中出现了组件嵌套的情况，仔细想想，组件之间传递信息肯定是必然的。那么React是怎样进行<strong>组件之间的数据通信</strong>的呢？</p>
<p>回答这个问题之前，我们需要考虑一下，组件之间有几种数据通信。首先，第一种比较容易想到，那就是<strong>父子组件</strong>之间的数据通信。第二种也就自然而然的出来了—-<strong>非父子组件</strong>之间的数据通信。</p>
<h4 id="父子组件数据通信"><a href="#父子组件数据通信" class="headerlink" title="父子组件数据通信"></a>父子组件数据通信</h4><p>父子组件之间的数据通信细分其实还有两种：<strong>父与子之间</strong>和<strong>子与父之间</strong>。</p>
<p>在React中，<strong>父与子</strong>之间的数据通信是通过<strong>props属性</strong>就行传递的；<br>而<strong>子与父</strong>之间的数据通信可以通过<strong>父组件定义事件，子组件触发父组件中的事件时，通过实参的形式来改变父组件中的数据</strong>来通信;</p>
<p>下面我们来分别通过例子来再现一下这种场景：<br><strong>父组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> CommentItem <span class="keyword">from</span> <span class="string">'./comment-item'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">let</span> CommentNodes = <span class="keyword">this</span>.props.data.map(<span class="function">(<span class="params">comment, index</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> (</div><div class="line">        <span class="xml"><span class="tag">&lt;<span class="name">CommentItem</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">author</span>=<span class="string">&#123;comment.author&#125;</span> <span class="attr">date</span>=<span class="string">&#123;comment.date&#125;</span>&gt;</span></span></div><div class="line">          &#123;comment.content&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">CommentItem</span>&gt;</span></div><div class="line">      )</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        &#123; CommentNodes &#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentList <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p><strong>子组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentItem</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"comment"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.author &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; this.props.date &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.props.children &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; CommentItem <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</div></pre></td></tr></table></figure></p>
<p>通过上面我们可以看出，子组件CommentItem需要父组件传过来的值进行展示，而父组件是这样的：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;CommentItem key=&#123;index&#125; author=&#123;comment.author&#125; date=&#123;comment.date&#125;&gt; &#123;comment.content&#125; &lt;<span class="regexp">/CommentItem&gt;</span></div></pre></td></tr></table></figure></p>
<p>在父组件中添加了<code>key</code>、<code>author</code>、<code>date</code>属性来向子组件传值。想对象的，子组件通过props对象来获取父组件传过来的值，如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;span&gt;&#123; this.props.author &#125;&lt;/span&gt;</div><div class="line">&lt;span&gt;&#123; this.props.date &#125;&lt;/span&gt;</div><div class="line">&lt;div&gt;&#123; this.props.children &#125;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>好的，我们再来看一下另一种<strong>子与父</strong>之间的通信。</p>
<p><strong>父组件</strong>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> CommentList <span class="keyword">from</span> <span class="string">'./comment-list'</span>;</div><div class="line"><span class="keyword">import</span> CommentForm <span class="keyword">from</span> <span class="string">'./comment-form'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentBox</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">data</span>: []&#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  handleCommentSubmit(comment) &#123;</div><div class="line">    <span class="keyword">let</span> comments = <span class="keyword">this</span>.state.data;</div><div class="line">    comments.push(comment);</div><div class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">data</span>: comments&#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className="m-index"&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">          &lt;h1&gt;评论&lt;/h1&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;CommentList data=&#123;this.state.data&#125; /&gt;</div><div class="line">        &lt;CommentForm onCommentSubmit=&#123;this.handleCommentSubmit.bind(this)&#125; /&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export &#123; CommentBox as default &#125;;</div></pre></td></tr></table></figure></p>
<p><strong>子组件</strong>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentForm</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">  handleClick()&#123;</div><div class="line">    <span class="keyword">let</span> author = <span class="keyword">this</span>.refs.author.value,</div><div class="line">        content = <span class="keyword">this</span>.refs.content.value;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.props.onCommentSubmit(&#123;author, content, <span class="attr">date</span>:<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;);</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.refs.author.value = <span class="string">""</span>;</div><div class="line">    <span class="keyword">this</span>.refs.content.value = <span class="string">""</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"yo-list yo-list-a"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">className</span>=<span class="string">"item item-input"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">className</span>=<span class="string">"yo-input flex"</span> <span class="attr">ref</span>=<span class="string">"author"</span> <span class="attr">placeholder</span>=<span class="string">"发布人"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">className</span>=<span class="string">"item item-input"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">className</span>=<span class="string">"yo-input flex"</span> <span class="attr">ref</span>=<span class="string">"content"</span> <span class="attr">placeholder</span>=<span class="string">"留言内容"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick.bind(this)&#125;</span> <span class="attr">className</span>=<span class="string">"yo-btn yo-btn-l"</span>&gt;</span>发表评论<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export &#123; CommentForm as default &#125;;</div></pre></td></tr></table></figure></p>
<p>简单解释一下，子组件是一个表单组件，父组件中引用了该表单子组件，然后子组件中点击button按钮，触发子组件中的处理函数，处理函数通过<strong>refs</strong>获取到表单输入值然后调用父组件中传过来的函数，从而触发父组件中的函数执行改变data数据，data数据变动直接影响的是另一个组件CommentList的变化。</p>
<p>需要注意的是，在获取表单控件内的数据时，我们利用了一个<strong>refs</strong>对象，该对象用于获取真实DOM结构。具体来说就是，在React中组件并不是真实的 DOM 节点，而是存在于内存之中的一种数据结构，叫做虚拟 DOM （virtual DOM，这是React探索性的创新）。只有当它插入文档以后，才会变成真实的 DOM 。根据 React 的设计，所有的 DOM 变动，都先在虚拟 DOM 上发生，然后再将实际发生变动的部分，反映在真实 DOM上，这种算法叫做 DOM diff （详细了解<a href="http://www.infoq.com/cn/articles/react-dom-diff" target="_blank" rel="external">diff 算法</a>），它可以极大提高网页的性能表现。<br>在这里点击button时，input和textarea元素还是虚拟DOM，所以违法获取到输入的值，需要通过<strong>refs</strong>对象获取一下。</p>
<h4 id="非父子组件之间的通信"><a href="#非父子组件之间的通信" class="headerlink" title="非父子组件之间的通信"></a>非父子组件之间的通信</h4><p>React中在处理<strong>非父子组件之间的通信</strong>时，简单的，嵌套不深的非父子组件（如：兄弟组件）可以仍然使用上一节<strong>非父子组件之间通信</strong>中的<strong>事件函数，传形参</strong>的方式来实现。如子组件<strong>CommentList </strong>和子组件<strong>CommentFrom</strong>之间的通信就是这样实现的。</p>
<p>如果，需要通信的两个非父子组件之间嵌套比较深，可以使用Flux和Redux来实现状态管理，这里不做详细阐述，下面会详细对比vue的状态管理进行说明。想先了解的可以看一下阮一峰老师的blog：</p>
<blockquote>
<p><a href="http://www.ruanyifeng.com/blog/2016/01/flux.html" target="_blank" rel="external">Flux 架构入门教程</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html" target="_blank" rel="external">Redux 入门教程（一）：基本用法</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_two_async_operations.html" target="_blank" rel="external">Redux 入门教程（二）：中间件与异步操作</a><br><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="external">Redux 入门教程（三）：React-Redux 的用法</a></p>
</blockquote>
<h3 id="组件的声明周期"><a href="#组件的声明周期" class="headerlink" title="组件的声明周期"></a>组件的声明周期</h3><p><img src="/images/react&amp;vue/1.png" alt="react 组件的声明周期"></p>
<p>上面这张图已经很清楚的展示了react组件的声明周期了，就不过多介绍了。这张图摘自<a href="http://www.jianshu.com/p/4784216b8194" target="_blank" rel="external">React组件生命周期小结</a>，对于理解React组件的声明周期钩子函数很有帮助。</p>
<h2 id="Vue中的组件和数据流"><a href="#Vue中的组件和数据流" class="headerlink" title="Vue中的组件和数据流"></a>Vue中的组件和数据流</h2><p>Vue比React出来的要晚一些，自然顺应了前端组件化的大潮，并且个人觉得借鉴了部分React的思想来实现其组件化思想。</p>
<p>Vue默认的是单向数据流，这是Vue直接提出来说明的，父组件默认可以向子组件传递数据，但是子组件向父组件传递数据就需要额外设置了。</p>
<p><strong>父子组件</strong>之间的数据通信是通过<strong>Prop</strong>和<strong>自定义事件</strong>实现的，而<strong>非父子组件</strong>可以使用<strong>订阅/发布</strong>模式实现（类似于Angualr中的非父子指令之间的通信），再复杂一点也是建议使用状态管理（vuex）。</p>
<p>我一直觉得Vue的官方文档是我看过最直接、易懂的技术文档，所以就直接给大家贴一个中文链接，自己去跟随尤雨溪学习吧。</p>
<blockquote>
<p><a href="https://vuefe.cn/v2/guide/components.html" target="_blank" rel="external">Vue 中的组件和数据流</a></p>
</blockquote>
<h1 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h1><p>上面对比React和Vue的<strong>组件及数据流</strong>的时候，都提到了<strong>当非父子组件之间嵌套过深</strong>的时候都建议使用状态管理来维护数据的变化，那么到底它们之间的状态管理有什么区别呢？</p>
<h2 id="Vue中的状态管理–vuex"><a href="#Vue中的状态管理–vuex" class="headerlink" title="Vue中的状态管理–vuex"></a>Vue中的状态管理–vuex</h2><p>先放个<a href="https://vuex.vuejs.org/zh-cn/" target="_blank" rel="external">官方中文链接</a>，还是建议直接看官方文档。然后在放一下小例子去体会一下。</p>
<p>先简单说明一下，vuex状态管理的几个核心概念：</p>
<ol>
<li>State: Vuex 使用 <strong>单一状态树</strong> —— 是的，用一个对象就包含了全部的应用层级状态。至此它便作为一个『唯一数据源(<a href="https://en.wikipedia.org/wiki/Single_source_of_truth" target="_blank" rel="external">SSOT</a>)』而存在。这也意味着，每个应用将仅仅包含一个 store 实例。</li>
<li>Getters: 从state中获取状态值</li>
<li>Mutation: 更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。Vuex 中的 mutations 非常类似于事件：每个 mutation 都有一个字符串的 <strong>事件类型 (type)</strong> 和 一个 <strong>回调函数 (handler)</strong>。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数</li>
<li>Action:  类似于 mutation，不同在于：Action 提交的是 mutation，而不是直接变更状态；Action 可以包含任意异步操作。</li>
</ol>
<p>例子来了：<br><strong>store.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'../libs/vue.js'</span>;</div><div class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'../libs/vuex.min.js'</span>;</div><div class="line">Vue.use(Vuex);</div><div class="line"><span class="keyword">const</span> state = &#123;</div><div class="line">  <span class="attr">loginPrePath</span>:[<span class="string">'/'</span>]</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> mutations =&#123;</div><div class="line">  LOGINPREPATH(state,path)&#123;</div><div class="line">    state.loginPrePath.unshift(path);</div><div class="line">  &#125;,</div><div class="line">  LOGINPREPATHSHIFT(state)&#123;</div><div class="line">    state.loginPrePath.shift();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</div><div class="line">  state,</div><div class="line">  mutations</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>actions.js:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">loginPrePath</span>: <span class="function">(<span class="params">&#123;dispatch,state&#125;,path</span>)=&gt;</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'actions loginPrePath:'</span> +path);</div><div class="line">    dispatch(<span class="string">'LOGINPREPATH'</span>,path);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">loginPrePathShift</span>: <span class="function">(<span class="params">&#123;dispatch,state&#125;</span>)=&gt;</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'delete....'</span>);</div><div class="line">    dispatch(<span class="string">'LOGINPREPATHSHIFT'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>getter.js:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">loginPrePath</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.loginPrePath</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><strong>login.vue:</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">...</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">import Vue from '../libs/vue.js';</div><div class="line">import VueResource from '../libs/vue-resource.js';</div><div class="line">import Vuex from '../vuex/actions.js';</div><div class="line">import VuexGet from '../vuex/getters.js';</div><div class="line"></div><div class="line">Vue.use(VueResource);</div><div class="line">export default &#123;</div><div class="line">  data()&#123;</div><div class="line">    return &#123;</div><div class="line">      username: '',</div><div class="line">      password: '',</div><div class="line">      loginBtn: 0</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  vuex: &#123;</div><div class="line">    actions: &#123;</div><div class="line">      setLoginPrePath: Vuex.loginPrePath</div><div class="line">    &#125;,</div><div class="line">    getters:&#123;</div><div class="line">      getLoginPrePath: VuexGet.loginPrePath</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    forget()&#123;</div><div class="line">      //使用vuex，修改状态值</div><div class="line">      this.setLoginPrePath(&#123;path:this.$route.path,title:'忘记密码'&#125;);</div><div class="line">      this.$router.go(&#123;path:'/index2/forget.json'&#125;);</div><div class="line">    &#125;,</div><div class="line">    submit()&#123;</div><div class="line">      if(this.loginBtn === 3)&#123;</div><div class="line">        if(this.checked)&#123;</div><div class="line">          this.$http.post('/zhixiao/password.json',&#123;password:this.password&#125;).then(</div><div class="line">            (res)=&gt;&#123;</div><div class="line">              if(res.ok)&#123;</div><div class="line">                console.log("注册成功，正在跳转登录页面");</div><div class="line">                setTimeout(()=&gt;&#123;</div><div class="line">                  //获取状态值，通过getter</div><div class="line">                  var path = this.getLoginPrePath[0].path;</div><div class="line">                  this.loginPrePathShift();</div><div class="line">                  this.$router.go(path);</div><div class="line">                &#125;,1500);</div><div class="line">              &#125;</div><div class="line">            &#125;,(res)=&gt;&#123;</div><div class="line">              console.log('网络错误，请稍后重试');</div><div class="line">            &#125;</div><div class="line">          )</div><div class="line">        &#125;else&#123;</div><div class="line">          console.log('请选择同意用户协议');</div><div class="line">        &#125;</div><div class="line">      &#125;else&#123;</div><div class="line">        console.log('请填写验证码');</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>上面的例子并无实际效果，是我从以前项目中拼出来的（vuex1.0），只是为了说明<strong>loginPrePath</strong>这个状态值在vuex中的使用方式。详细请看Vue官方文档。</p>
<h2 id="React中的状态管理–Flux"><a href="#React中的状态管理–Flux" class="headerlink" title="React中的状态管理–Flux"></a>React中的状态管理–Flux</h2><p>React中官方提供的状态管理是<strong>Flux</strong>，但是貌似现在第三方开发的<strong>Redux</strong>更强大，但是相比较使用的难度和学习曲线就有点陡峭了。</p>
<p>个人感觉<strong>Flux</strong>和Vue中的<strong>vuex</strong>思想基本相同，因为Vuex就是借鉴的Flux。<br>所以说，现在再来说<strong>Flux</strong>就简单了。</p>
<p>回想一下，在vuex中如果我们想修改一个状态值，我们应该怎么办呢？<br>在组件中配置vuex对象属性里面的<strong>actions</strong>和<strong>getters</strong>属性数组，然后配置的实际上是调用了<strong>Actions</strong>中的方法，<strong>Actions</strong>作用是将修改操作派生给<strong>store中的mutations</strong>,<strong>mutations</strong>真正处理业务逻辑并且修改状态值。</p>
<p>其实<strong>Flux</strong>也是如此，只不过在vuex中的<strong>Actions</strong>层执行了一个dispatcher方法将状态操作转发给了<strong>mutations</strong>，在Flux中直接需要显示的配置一层<strong>Dispatcher</strong>层进行转发。并且实现方式有所不同，vuex中<strong>mutations</strong>中隐藏了一些事件触发的操作，而Flux中直接通过我们自己编写代码实现，毕竟Flux是年纪大了，不如小弟vuex年轻呀。</p>
<p>例子：<br><strong>components.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> MyButton <span class="keyword">from</span> <span class="string">'./MyButton.jsx'</span>;</div><div class="line"><span class="keyword">import</span> ButtonActions <span class="keyword">from</span> <span class="string">'../actions/ButtonActions.js'</span>;</div><div class="line"><span class="keyword">import</span> ListStore <span class="keyword">from</span> <span class="string">'../stores/ListStore.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  getInitialState() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">items</span>: ListStore.getAll()</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  createNewItem() &#123;</div><div class="line">    ButtonActions.addNewItem(<span class="string">'New Item'</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    ListStore.addChangeListener(<span class="keyword">this</span>._onChange);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  componentWillUnmount() &#123;</div><div class="line">    ListStore.removeChangeListener(<span class="keyword">this</span>._onChange);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _onChange() &#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      <span class="attr">items</span>: ListStore.getAll()</div><div class="line">    &#125;)</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">MyButton</span> <span class="attr">onClick</span>=<span class="string">&#123;this.createNewItem&#125;</span> <span class="attr">items</span>=<span class="string">&#123;this.state.items&#125;</span> /&gt;</span></span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>ButtonActions.js:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> AppDispatcher <span class="keyword">from</span> <span class="string">'../dispatchers/AppDispatcher.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  addNewItem(text) &#123;</div><div class="line">    AppDispatcher.dispatch(&#123;</div><div class="line">      <span class="attr">actionType</span>: <span class="string">'ADD_NEW_ITEM'</span>,</div><div class="line">      <span class="attr">text</span>: text</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>AppDispatcher.js’：</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Dispatcher &#125; <span class="keyword">from</span> <span class="string">'flux'</span>;</div><div class="line"><span class="keyword">import</span> ListStore <span class="keyword">from</span> <span class="string">'../stores/ListStore.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> AppDispatcher = <span class="keyword">new</span> Dispatcher();</div><div class="line"></div><div class="line">AppDispatcher.register(<span class="function"><span class="params">action</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span>( action.actionType ) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_NEW_ITEM'</span>:</div><div class="line">      ListStore.addNewItemHandle(action.text);</div><div class="line">      ListStore.emitChange();</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> AppDispatcher;</div></pre></td></tr></table></figure></p>
<p><strong>ListStore.js: </strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; EventEmitter &#125; <span class="keyword">from</span> <span class="string">'events'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">Object</span>.assign(&#123;&#125;, EventEmitter.prototype, &#123;</div><div class="line">  <span class="attr">items</span>: [],</div><div class="line"></div><div class="line">  getAll()&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.items;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  addNewItemHandler(text) &#123;</div><div class="line">    <span class="keyword">this</span>.items.push(text);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  emitChange() &#123;</div><div class="line">    <span class="keyword">this</span>.emit(<span class="string">'change'</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  addChangeListener(callback) &#123;</div><div class="line">    <span class="keyword">this</span>.on(<span class="string">'change'</span>, callback);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  removeChangeListener(callback) &#123;</div><div class="line">    <span class="keyword">this</span>.removeListener(<span class="string">'change'</span>, callback);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>仔细按照例子走一遍工作流程，相信你就理解<strong>Flux</strong>实现状态管理的思想了。</p>
<h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><p>要想实现SPA，路由是个不可避免的话题，作为主流的MVVM框架，怎么可能没有官方路由呢，两者的路由也很相似，都是利用各自的组件实现思想来实现的。</p>
<h2 id="Vue中的路由"><a href="#Vue中的路由" class="headerlink" title="Vue中的路由"></a>Vue中的路由</h2><p>还是先贴<a href="https://router.vuejs.org/zh-cn/" target="_blank" rel="external">官方链接</a>，简单易懂。<br>再给个例子(vue-router1.0)，仔细看一下：<br><strong>app.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//引用component</span></div><div class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">'./components/index.vue'</span>;</div><div class="line"><span class="keyword">import</span> main <span class="keyword">from</span> <span class="string">'./components/main.vue'</span>;</div><div class="line"><span class="keyword">import</span> my <span class="keyword">from</span> <span class="string">'./components/my.vue'</span>;</div><div class="line"></div><div class="line"><span class="comment">//APP route</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'./libs/vue.js'</span>;</div><div class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'./libs/vue-router.js'</span>;</div><div class="line"></div><div class="line">Vue.use(VueRouter);</div><div class="line"></div><div class="line">router.map(&#123;</div><div class="line">  <span class="string">'/'</span>:&#123;</div><div class="line">    <span class="attr">component</span>: index,</div><div class="line">    <span class="attr">subRoutes</span>:&#123;</div><div class="line">      <span class="string">'/'</span>:&#123;</div><div class="line">        <span class="attr">component</span>: main</div><div class="line">      &#125;,</div><div class="line">      <span class="string">'/my'</span>:&#123;</div><div class="line">        <span class="attr">name</span>:<span class="string">'my'</span>,</div><div class="line">        <span class="attr">component</span>: my</div><div class="line">      &#125;,</div><div class="line">      <span class="string">'/results/:key'</span>:&#123;</div><div class="line">        <span class="attr">name</span>:<span class="string">'results'</span>,</div><div class="line">        <span class="attr">component</span>:results</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//启动router</span></div><div class="line">router.start(App,<span class="string">'body'</span>);</div></pre></td></tr></table></figure></p>
<p><strong>index.vue</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"index-container"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">router-view</span>&gt;</span></div><div class="line"></div><div class="line">      <span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-bind:class</span>=<span class="string">"getIndex == $index ? 'active' : ''"</span></span></div><div class="line">            <span class="attr">v-for</span>=<span class="string">"data in navList"</span></div><div class="line">            <span class="attr">v-on:click</span>=<span class="string">"changePage($index)"</span></div><div class="line">            <span class="attr">v-link</span>=<span class="string">"&#123;path:data.path,exact: true&#125;"</span>&gt;</div><div class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont"</span>&gt;</span>&#123;&#123;&#123;data.icon&#125;&#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;&#123;data.name&#125;&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> Vue = <span class="built_in">require</span>(<span class="string">'../libs/vue.js'</span>);</div><div class="line">  <span class="keyword">var</span> VueResource = <span class="built_in">require</span>(<span class="string">'../libs/vue-resource.js'</span>);</div><div class="line">  <span class="keyword">import</span> &#123;getIndex&#125; <span class="keyword">from</span> <span class="string">'../vuex/getters.js'</span>;</div><div class="line">  <span class="keyword">import</span> &#123;changeIndexPage&#125; <span class="keyword">from</span> <span class="string">'../vuex/actions.js'</span>;</div><div class="line">  Vue.use(VueResource);</div><div class="line"></div><div class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">    <span class="attr">vuex</span>: &#123;</div><div class="line">      <span class="attr">actions</span>:&#123;</div><div class="line">        changeIndexPage</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">getters</span>:&#123;</div><div class="line">        getIndex</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    data()&#123;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">cur</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">navList</span>:[</div><div class="line">          &#123;<span class="attr">path</span>:<span class="string">'/'</span>,<span class="attr">icon</span>:<span class="string">'&amp;#xe6bb;'</span>,<span class="attr">name</span>:<span class="string">'主页'</span>&#125;,</div><div class="line">          &#123;<span class="attr">path</span>:<span class="string">'/lee'</span>,<span class="attr">icon</span>:<span class="string">'&amp;#xe664;'</span>,<span class="attr">name</span>:<span class="string">'排行榜'</span>&#125;,</div><div class="line">          &#123;<span class="attr">path</span>:<span class="string">'/search'</span>,<span class="attr">icon</span>:<span class="string">'&amp;#xe65c;'</span>,<span class="attr">name</span>:<span class="string">'发现'</span>&#125;,</div><div class="line">          &#123;<span class="attr">path</span>:<span class="string">'/my'</span>,<span class="attr">icon</span>:<span class="string">'&amp;#xe735;'</span>,<span class="attr">name</span>:<span class="string">'我的'</span>&#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">methods</span>:&#123;</div><div class="line">      <span class="attr">changePage</span>:<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</div><div class="line">        <span class="keyword">this</span>.changeIndexPage(i);</div><div class="line">        <span class="keyword">this</span>.cur = <span class="keyword">this</span>.getIndex;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p>
<p>大概就这样，感觉像是配置的感觉，其实这就是利用的vue中组件思想来实现的，详细看官方文档。</p>
<h2 id="React中的路由"><a href="#React中的路由" class="headerlink" title="React中的路由"></a>React中的路由</h2><p>React中的路由只需要安装插件<strong>react-router</strong>即可。<br>再来看例子：<br><strong>app.jsx</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'../styles/usage/page/app.scss'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"></div><div class="line"><span class="comment">// import router</span></div><div class="line"><span class="keyword">import</span> &#123; Router, Route, hashHistory, IndexRoute, Redirect &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</div><div class="line"></div><div class="line"><span class="comment">// router components</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./components/router/router-app.jsx'</span>;</div><div class="line"><span class="keyword">import</span> TV <span class="keyword">from</span> <span class="string">'./components/router/router-tv.jsx'</span>;</div><div class="line"><span class="keyword">import</span> Shows <span class="keyword">from</span> <span class="string">'./components/router/router-show.jsx'</span>;</div><div class="line"><span class="keyword">import</span> ShowIndex <span class="keyword">from</span> <span class="string">'./components/router/router-show-index.jsx'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> app = <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> handleEnter = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'entered'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> handleLeave = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'leaved'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">ReactDOM.render((</div><div class="line">  &lt;Router history=&#123;hashHistory&#125;&gt;</div><div class="line">    &lt;Route path="/" component=&#123;App&#125;&gt;</div><div class="line">      &lt;Route path="tv" component=&#123;TV&#125;&gt;</div><div class="line">        &lt;IndexRoute component=&#123;ShowIndex&#125;&gt;&lt;/IndexRoute&gt;</div><div class="line">        &lt;Route path="/shows/:id" onEnter=&#123;handleEnter&#125; onLeave=&#123;handleLeave&#125; component=&#123;Shows&#125; /&gt;</div><div class="line">        &lt;Redirect from="shows/:id" to="/shows/:id" /&gt;</div><div class="line">      &lt;/Route&gt;</div><div class="line">    &lt;/Route&gt;</div><div class="line">  &lt;/Router&gt;</div><div class="line">), app);</div></pre></td></tr></table></figure></p>
<p><strong>router-app.jsx:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="string">'ure strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="comment">// import router</span></div><div class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span> | </div><div class="line">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"/tv"</span>&gt;</span>电视剧<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        &#123;this.props.children&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>router-tv.jsx</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        &#123;this.props.children&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>router-show.jsx</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></div><div class="line">        节目内容 &#123;this.props.params.id&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>router-show-index.jsx</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"tv/shows/2"</span>&gt;</span>电视节目列表<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>例子很简单，但是将常用的路由操作基本都涵盖了。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>大概通过自己的理解，对比了一下Vue和React的一些主要概念和实现方式，主要是为了加深自己理解，有些东西自己水平有限，不好表述，大概就是堆砌一些知识点而已。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vue也已经升级到2.0版本了，到现在为止（2016/11/19）比较流行的MVVM框架有&lt;strong&gt;AngularJS&lt;/strong&gt;（也有人认为其为MVC）、&lt;strong&gt;ReactJS&lt;/strong&gt;和&lt;strong&gt;VueJS&lt;/strong&gt;，这三个框架中，以我现在的情况来说（AngularJS2还没有去接触），ReactJS和VueJS的对比应该是比较适合的，感觉这哥俩就是好基友，不管是&lt;strong&gt;单向数据流&lt;/strong&gt;、&lt;strong&gt;组件化思想&lt;/strong&gt;、还是构建大型应用的&lt;strong&gt;路由&lt;/strong&gt;和&lt;strong&gt;状态管理&lt;/strong&gt;都有些许相似之处。而AngularJS与Jquery对比我个人觉着比较合适。&lt;/p&gt;
&lt;p&gt;为什么现在MVVM框架这么火呢？JQuery挺好用的呀，为什么要去代替它？…&lt;/p&gt;
&lt;p&gt;可能会产生这样的疑问，在我看来，MVVM框架的流行是因为随着前端技术的发展对于要求越来越高和前端面对的场景越来越复杂导致了现实对于前端性能的要求也越来越高，这样像JQuery那样频繁的操作DOM节点的方式显然就不太合适了。所以MVVM开始逐渐流行开来，另外我认为JQuery目前来看还是不会被代替的，因为对于一些对性能要求不是很高的前端项目，是用JQuery来开发还是非常爽的。&lt;/p&gt;
&lt;p&gt;废话有点多了，进入正题。接下来从&lt;strong&gt;数据双向绑定&lt;/strong&gt;、&lt;strong&gt;组件及数据流&lt;/strong&gt;、&lt;strong&gt;路由&lt;/strong&gt;、&lt;strong&gt;状态管理&lt;/strong&gt;等方面来分别对比一下怎样去使用Vue和React。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="ReactJs" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/ReactJs/"/>
    
    
      <category term="MVVM" scheme="https://chping2125.github.io/tags/MVVM/"/>
    
      <category term="ReactJs" scheme="https://chping2125.github.io/tags/ReactJs/"/>
    
      <category term="Vue" scheme="https://chping2125.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门--数据绑定和指令</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-数据绑定和指令/</id>
    <published>2016-11-24T09:28:54.000Z</published>
    <updated>2016-11-24T10:13:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>Angular的数据绑定在我的理解中也是双向绑定的，数据流才是单向的，本篇通过Angular内置指令系统来了解一下其双向数据绑定和单向数据流以及指令的基本使用的相关基础知识。</p>
<p>如果想深入详细了解Angular中的数据绑，可以看一下民工叔叔的<a href="https://github.com/xufei/blog/issues/14" target="_blank" rel="external">AngularJS实例教程（一）——数据绑定与监控</a>和<a href="https://github.com/xufei/blog/issues/10" target="_blank" rel="external">Angular沉思录（一）数据绑定</a>。</p>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<h2 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h2><ol>
<li><strong>ng-bind</strong>: 绑定 HTML 元素到应用程序数据</li>
<li><strong>ng-bind-html</strong>: 绑定 HTML 元素的 innerHTML 到应用程序数据，并移除 HTML 字符串中危险字符</li>
<li><strong>ng-class</strong>: 指定 HTML 元素使用的 CSS 类</li>
<li><strong>ng-style</strong>: 指定元素的 style 属性</li>
<li><strong>ng-click</strong>: 定义元素被点击时的行为</li>
<li><strong>ng-focus</strong>: 规定聚焦事件的行为</li>
<li><strong>ng-blur</strong>: 规定 blur 事件的行为</li>
<li><strong>ng-change</strong>: 规定在内容改变时要执行的表达式</li>
<li><strong>ng-checked</strong>: 规定元素是否被选中</li>
<li><strong>ng-value</strong>: 规定 input 元素的值</li>
<li><strong>ng-hide</strong>: 隐藏或显示 HTML 元素</li>
<li><strong>ng-show</strong>: 显示或隐藏 HTML 元素</li>
<li><strong>ng-if</strong>: 如果条件为 false 移除 HTML 元素</li>
<li><strong>ng-init</strong>: 定义应用的初始化值</li>
<li><strong>ng-repeat</strong>: 定义集合中每项数据的模板</li>
<li><strong>ng-controller</strong>: 定义应用的控制器对象</li>
</ol>
<p>更多指令请参考<a href="http://www.runoob.com/angularjs/angularjs-reference.html" target="_blank" rel="external">Angular指令</a></p>
<h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>利用Angular自带的<strong>内置指令</strong>绑定controller中$scope对象上的属性来实现mvvm数据双向绑定。</p>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js，其主要起到将html扔到页面上，然后Angular再去解析该html。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ng-bind指令的使用"><a href="#ng-bind指令的使用" class="headerlink" title="ng-bind指令的使用"></a>ng-bind指令的使用</h3><p>demo1.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demo1Tpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo1.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demo1Tpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> users = [&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'zhangsan'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">10</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'lisi'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">30</span></div><div class="line">&#125;];</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  <span class="comment">//将数据绑定到对象$scope上</span></div><div class="line">  $scope.users = users;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo1.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-bind</span>=<span class="string">"users[1].name"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;users[0].name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 利用ng-bind和双大括号可以取到$scope上面的属性值进行渲染 --&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-repeat指令"><a href="#ng-repeat指令" class="headerlink" title="ng-repeat指令"></a>ng-repeat指令</h3><p>demo2.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo2.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> users = [&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'zhangsan'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">10</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'lisi'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">30</span></div><div class="line">&#125;];</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  $scope.users = users;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo2.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">"user in users"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!--$index:表示序号--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;$index&#125;&#125;、<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;user.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;user.age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-if-ng-show-ng-hide指令"><a href="#ng-if-ng-show-ng-hide指令" class="headerlink" title="ng-if/ng-show/ng-hide指令"></a>ng-if/ng-show/ng-hide指令</h3><p>demo3.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo3.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  $scope.isShow = <span class="literal">false</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo3.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- show/hide通过控制display来实现显示和隐藏--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-show</span>=<span class="string">"isShow"</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-hide</span>=<span class="string">"isShow"</span>&gt;</span>def<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- if是直接没有生成该DOM节点 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-if</span>=<span class="string">"isShow"</span>&gt;</span>ghi<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-medel指令"><a href="#ng-medel指令" class="headerlink" title="ng-medel指令"></a>ng-medel指令</h3><p>demo4.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo4.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  <span class="comment">//$scope.username = 'zhangsan';</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo4.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"username"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;username&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-click指令"><a href="#ng-click指令" class="headerlink" title="ng-click指令"></a>ng-click指令</h3><p>demo5.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo5.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  $scope.counter = <span class="number">0</span>;</div><div class="line">  <span class="comment">//也可以向$scope对象添加方法</span></div><div class="line">  $scope.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $scope.counter++;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo5.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;counter&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 在指令内执行方法 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"add()"</span>&gt;</span> + <span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-keyup指令"><a href="#ng-keyup指令" class="headerlink" title="ng-keyup指令"></a>ng-keyup指令</h3><p>demo6.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo6.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line"></div><div class="line">  $scope.item = <span class="string">""</span>;</div><div class="line"></div><div class="line">  $scope.items = [</div><div class="line">    <span class="string">"aaa"</span></div><div class="line">  ];</div><div class="line"></div><div class="line">  $scope.remove = <span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</div><div class="line">    $scope.items.splice(i, <span class="number">1</span>);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  $scope.add = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(event.code === <span class="string">'Enter'</span>) &#123;</div><div class="line">      $scope.items.unshift($scope.item);</div><div class="line">      $scope.item = <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo6.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 事件中的event对象通过$event的形式传参过去 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"item"</span> <span class="attr">ng-keyup</span>=<span class="string">"add($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"item in items track by $index"</span>&gt;</span>&#123;&#123;$index&#125;&#125;.&#123;&#123;item&#125;&#125; <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"remove($index)"</span>&gt;</span>X<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="ng-include指令"><a href="#ng-include指令" class="headerlink" title="ng-include指令"></a>ng-include指令</h3><p>demo13.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo13.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.filter(<span class="string">'gender'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">g</span>)</span>&#123;</div><div class="line">    <span class="keyword">switch</span>(g) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'男'</span>;</div><div class="line">      <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'女'</span>;</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'其他'</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'showController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> persons = [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chping'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">21</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chengping'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">20</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chyan'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">19</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  ];</div><div class="line"></div><div class="line">  <span class="keyword">var</span> persons2 = [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'lala'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">21</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'lalala'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">20</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'lalalala'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">19</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  ];</div><div class="line"></div><div class="line">  $scope.persons = persons;</div><div class="line">  $scope.persons2 = persons2;</div><div class="line">  $scope.template = <span class="string">'src/scripts/tpls/person.string'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo13.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"showController"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">ng-model</span>=<span class="string">"template"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"src/scripts/tpls/person.string"</span>&gt;</span>tpl1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"src/scripts/tpls/person2.string"</span>&gt;</span>tpl2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-include</span>=<span class="string">"template"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>person.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"p in persons"</span>&gt;</span></div><div class="line">        &#123;&#123;p.name&#125;&#125;/&#123;&#123;p.age&#125;&#125;/&#123;&#123;p.gender | gender&#125;&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>person2.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"p in persons2"</span>&gt;</span></div><div class="line">        &#123;&#123;p.name&#125;&#125;/&#123;&#123;p.age&#125;&#125;/&#123;&#123;p.gender | gender&#125;&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>通过结合几个指令系统简单的了解了一下Angular的数据双向绑定和指令的基本使用。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Angular的数据绑定在我的理解中也是双向绑定的，数据流才是单向的，本篇通过Angular内置指令系统来了解一下其双向数据绑定和单向数据流以及指令的基本使用的相关基础知识。&lt;/p&gt;
&lt;p&gt;如果想深入详细了解Angular中的数据绑，可以看一下民工叔叔的&lt;a href=&quot;https://github.com/xufei/blog/issues/14&quot;&gt;AngularJS实例教程（一）——数据绑定与监控&lt;/a&gt;和&lt;a href=&quot;https://github.com/xufei/blog/issues/10&quot;&gt;Angular沉思录（一）数据绑定&lt;/a&gt;。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门---过滤器</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-过滤器/</id>
    <published>2016-11-24T09:27:54.000Z</published>
    <updated>2016-11-24T10:13:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>Angular中过滤器结合指令系统可以快速的实现某些简单的业务逻辑。</p>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="limitTo和orderBy"><a href="#limitTo和orderBy" class="headerlink" title="limitTo和orderBy"></a>limitTo和orderBy</h2><p>demo7.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo7.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> items = [</div><div class="line">    &#123;<span class="attr">title</span>: <span class="string">'权利的游戏'</span>, <span class="attr">subscribe</span>: <span class="literal">true</span>, <span class="attr">updated</span>: <span class="number">1458691234</span>&#125;,</div><div class="line">    &#123;<span class="attr">title</span>: <span class="string">'真探'</span>, <span class="attr">subscribe</span>: <span class="literal">false</span>, <span class="attr">updated</span>: <span class="number">1458777656</span>&#125;,</div><div class="line">    &#123;<span class="attr">title</span>: <span class="string">'黑吃黑'</span>, <span class="attr">subscribe</span>: <span class="literal">true</span>, <span class="attr">updated</span>: <span class="number">1458864234</span>&#125;,</div><div class="line">    &#123;<span class="attr">title</span>: <span class="string">'大西洋帝国'</span>, <span class="attr">subscribe</span>: <span class="literal">true</span>, <span class="attr">updated</span>: <span class="number">1458950499</span>&#125;,</div><div class="line">    &#123;<span class="attr">title</span>: <span class="string">'罗马'</span>, <span class="attr">subscribe</span>: <span class="literal">false</span>, <span class="attr">updated</span>: <span class="number">1459036887</span>&#125;</div><div class="line">  ];</div><div class="line"></div><div class="line">  $scope.items = items;</div><div class="line"></div><div class="line">  $scope.limit = <span class="number">4</span>;</div><div class="line"></div><div class="line">  $scope.price = <span class="number">234.56</span>;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo7.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"limit"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;price | currency: '￥'&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"item in items | limitTo:limit | orderBy:'-updated'"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>名字：&#123;&#123;item.title&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>是否发布：<span class="tag">&lt;<span class="name">b</span> <span class="attr">ng-class</span>=<span class="string">"&#123;'sub': item.subscribe&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>跟新时间：&#123;&#123;item.updated | date:'yyyy年MM月dd日,HH:mm'&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="过滤器调用一个方法"><a href="#过滤器调用一个方法" class="headerlink" title="过滤器调用一个方法"></a>过滤器调用一个方法</h2><p>demo8.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo8.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line">angular.module(<span class="string">'myApp'</span>, [])</div><div class="line">.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> friends = [&#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'John'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'555-1276'</span></div><div class="line">    &#125;, &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'Mary'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'800-BIG-MARY'</span></div><div class="line">    &#125;, &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'Mike'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'555-4321'</span></div><div class="line">    &#125;, &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'Adam'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'555-5678'</span></div><div class="line">    &#125;, &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'Julie'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'555-8765'</span></div><div class="line">    &#125;, &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'Juliette'</span>,</div><div class="line">        <span class="attr">phone</span>: <span class="string">'555-5678'</span></div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    $scope.friends = friends;</div><div class="line">    $scope.searchText = <span class="string">''</span>;</div><div class="line"></div><div class="line">    $scope.search = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>($scope.searchText != <span class="string">""</span>)&#123;</div><div class="line">        <span class="keyword">if</span>(value.name.toLowerCase().indexOf($scope.searchText.toLowerCase()) != <span class="number">-1</span> || value.phone.toLowerCase().indexOf($scope.searchText.toLowerCase()) != <span class="number">-1</span>) &#123;</div><div class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo8.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"myController"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"searchText"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>phone<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">tr</span> <span class="attr">ng-repeat</span>=<span class="string">"f in friends | limitTo:10 | filter:search:value"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;f.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;f.phone&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="自定义过滤器"><a href="#自定义过滤器" class="headerlink" title="自定义过滤器"></a>自定义过滤器</h2><p>demo12.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo12.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.filter(<span class="string">'gender'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">g</span>)</span>&#123;</div><div class="line">    <span class="keyword">switch</span>(g) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'男'</span>;</div><div class="line">      <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'女'</span>;</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'其他'</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'showController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> persons = [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chping'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">21</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chengping'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">20</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'chyan'</span>,</div><div class="line">      <span class="attr">age</span>: <span class="number">19</span>,</div><div class="line">      <span class="attr">gender</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  ];</div><div class="line"></div><div class="line">  $scope.persons = persons;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo12.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">ng-controller</span>=<span class="string">"showController"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"p in persons"</span>&gt;</span></div><div class="line">        &#123;&#123;p.name&#125;&#125;/&#123;&#123;p.age&#125;&#125;/&#123;&#123;p.gender | gender&#125;&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Angular中过滤器结合指令系统可以快速的实现某些简单的业务逻辑。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门---作用域和通信</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-作用域和通信/</id>
    <published>2016-11-24T09:26:54.000Z</published>
    <updated>2016-11-24T10:13:26.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ol>
<li>在Angular中，controller父子之间是以一种原型链继 的方式来通信。</li>
<li>像ng-controller、ng-if、ng-include、ng-repeat、ng-switch等会创建DOM结构的指令都会创建作用域，这些作用域之间的通信可以通过$parent来访问父controller。</li>
</ol>
</blockquote>
<p>想深入详细了解Angular中的作用域，可以看<a href="https://github.com/xufei/blog/issues/18" target="_blank" rel="external">AngularJS实例教程（二）——作用域与事件</a></p>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="基于angular别名的父子控制器之间的通信（作用域链通信）"><a href="#基于angular别名的父子控制器之间的通信（作用域链通信）" class="headerlink" title="基于angular别名的父子控制器之间的通信（作用域链通信）"></a>基于angular别名的父子控制器之间的通信（作用域链通信）</h2><p>demo10.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo11.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'provinceController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = <span class="string">"taiwan"</span>;</div><div class="line">&#125;);</div><div class="line">myApp.controller(<span class="string">'cityController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = <span class="string">"taibei"</span>;</div><div class="line">&#125;);</div><div class="line">myApp.controller(<span class="string">'sectionController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = <span class="string">"qianfeng"</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo10.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"provinceController as p"</span>&gt;</span></div><div class="line">      &#123;&#123;p.name&#125;&#125;</div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"cityController as c"</span>&gt;</span></div><div class="line">        &#123;&#123;p.name&#125;&#125;-&#123;&#123;c.name&#125;&#125;</div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"sectionController as s"</span>&gt;</span></div><div class="line">          &#123;&#123;p.name&#125;&#125;-&#123;&#123;c.name&#125;&#125;-&#123;&#123;s.name&#125;&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="基于angular的服务通信"><a href="#基于angular的服务通信" class="headerlink" title="基于angular的服务通信"></a>基于angular的服务通信</h2><p>demo10.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo10.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.factory(<span class="string">'User'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> user = &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'lurongtao'</span>,</div><div class="line">    <span class="attr">email</span>: <span class="string">'lurongtao@1000phone.com'</span></div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> _getUser = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> user;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> _setUser = <span class="function"><span class="keyword">function</span>(<span class="params">id, name, email</span>) </span>&#123;</div><div class="line">    user.id = id;</div><div class="line">    user.name = name;</div><div class="line">    user.email = email;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">get</span>: _getUser,</div><div class="line">    <span class="attr">set</span>: _setUser</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'showController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $log, $timeout, $http, $q, User</span>) </span>&#123;</div><div class="line">  $scope.user = User.get();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'saveController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $log, $timeout, $http, $q, User</span>) </span>&#123;</div><div class="line">  $scope.user = User.get();</div><div class="line">  $scope.save = <span class="function"><span class="keyword">function</span>(<span class="params">id, name, email</span>)</span>&#123;</div><div class="line">    User.set(id, name, email);</div><div class="line">  &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo10.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"showController"</span>&gt;</span></div><div class="line">      &#123;&#123;user.id&#125;&#125;/&#123;&#123;user.name&#125;&#125;/&#123;&#123;user.email&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"saveController"</span>&gt;</span></div><div class="line">      &#123;&#123;user.id&#125;&#125;/&#123;&#123;user.name&#125;&#125;/&#123;&#123;user.email&#125;&#125;</div><div class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"save('2', 'pengzhan', 'pengzhan@qq.com')"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="基于事件方式的控制器之前的通信"><a href="#基于事件方式的控制器之前的通信" class="headerlink" title="基于事件方式的控制器之前的通信"></a>基于事件方式的控制器之前的通信</h2><p>demo16.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo16.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'child1Ctrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line">  $scope.action = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $scope.$emit(<span class="string">'parent-ctrl'</span>);</div><div class="line">    $scope.$broadcast(<span class="string">'child-ctrl'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'parentCtrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">  $scope.$on(<span class="string">'parent-ctrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parentCtrl has been emited~'</span>);</div><div class="line">  &#125;);</div><div class="line">  $scope.$on(<span class="string">'child-ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'childCtrl saved the broadcast info~'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'child2Ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">  $scope.$on(<span class="string">'parent-ctrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'---parentCtrl has been emited~'</span>);</div><div class="line">  &#125;);</div><div class="line">  $scope.$on(<span class="string">'child-ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'---siblingCtrl saved the broadcast info~'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'grandsonCtrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">  $scope.$on(<span class="string">'parent-ctrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parentCtrl has been emited~'</span>);</div><div class="line">  &#125;);</div><div class="line">  $scope.$on(<span class="string">'child-ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'grandsonCtrl saved the broadcast info~'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo16.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo16"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"parentCtrl"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"child1Ctrl"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"action()"</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"grandsonCtrl"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"child2Ctrl"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="基于发布者-订阅者模式的控制器之间的通信"><a href="#基于发布者-订阅者模式的控制器之间的通信" class="headerlink" title="基于发布者/订阅者模式的控制器之间的通信"></a>基于发布者/订阅者模式的控制器之间的通信</h2><p>该部分内容请查看民工叔叔的<a href="https://github.com/xufei/blog/issues/18" target="_blank" rel="external">AngularJS实例教程（二）——作用域与事件</a>最后<strong>事件总线</strong>那段经典的代码实现。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;在Angular中，controller父子之间是以一种原型链继 的方式来通信。&lt;/li&gt;
&lt;li&gt;像ng-controller、ng-if、ng-include、ng-repeat、ng-switch等会创建DOM结构的指令都会创建作用域，这些作用域之间的通信可以通过$parent来访问父controller。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;想深入详细了解Angular中的作用域，可以看&lt;a href=&quot;https://github.com/xufei/blog/issues/18&quot;&gt;AngularJS实例教程（二）——作用域与事件&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门---ng-Route</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-ng-Route/</id>
    <published>2016-11-24T09:24:54.000Z</published>
    <updated>2016-11-24T10:13:49.000Z</updated>
    
    <content type="html"><![CDATA[<p>为了实现SPA开发，路由是不可避免的一个话题，Angular有一套官方提供的ng-Route，但是并不是很好用。</p>
<p>ng-Route通过hash值和history两种方式实现路由工程。</p>
<blockquote>
<ol>
<li>服务$routeProvider定义了一个路由表</li>
<li>服务$routeParams保存了地址栏中的参数</li>
<li>服务$route完成路由匹配</li>
<li>服务$location ，同window.location.</li>
</ol>
</blockquote>
<p>主要事件：</p>
<blockquote>
<p>$routeChangeStart<br>$routeChangeSuccess<br>$routeChangeError</p>
</blockquote>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>demo14.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo14.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="comment">//1.在模块中注入ngRoute</span></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, [<span class="string">'ngRoute'</span>]);</div><div class="line"></div><div class="line"><span class="comment">//2.定义$routeProvider</span></div><div class="line"><span class="comment">//$routeProvider对象有两个主要方法when()和oherwise()来定义路由</span></div><div class="line"><span class="comment">//还有一个常用属性caseInsensitiveMatch</span></div><div class="line">myApp.config([<span class="string">'$routeProvider'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$routeProvider</span>) </span>&#123;</div><div class="line">  <span class="comment">// 是否区分大小写</span></div><div class="line">  $routeProvider.caseInsensitiveMatch = <span class="literal">true</span>;</div><div class="line">  <span class="comment">//when(path,route)</span></div><div class="line">  <span class="comment">//参数route对象的属性</span></div><div class="line">  <span class="comment">//    controller：当前模板上的controller</span></div><div class="line">  <span class="comment">//    controllerAs: controller的别名</span></div><div class="line">  <span class="comment">//    template: 当前路由的模板</span></div><div class="line">  <span class="comment">//    templateUrl: 当前路由的模板路径</span></div><div class="line">  <span class="comment">//    resolve: 指定当前controller依赖的模板</span></div><div class="line">  <span class="comment">//    redirectTo: 重定向</span></div><div class="line">  $routeProvider</div><div class="line">    .when(<span class="string">'/home'</span>, &#123;</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/route/home.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'homeController'</span></div><div class="line">    &#125;)</div><div class="line">    .when(<span class="string">'/course'</span>, &#123;</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/route/courses.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'courseController'</span>,</div><div class="line">      <span class="attr">controllerAs</span>: <span class="string">'courseCtrl'</span></div><div class="line">    &#125;)</div><div class="line">    .when(<span class="string">'/employee'</span>, &#123;</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/route/employees.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeController'</span>,</div><div class="line">      <span class="attr">resolve</span>: &#123;</div><div class="line">        <span class="attr">employeelist</span>: <span class="function"><span class="keyword">function</span>(<span class="params">$http, $q</span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> $http.get(<span class="string">'/mock/employee.json'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> res.data.data;</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    .when(<span class="string">'/employee/:abc'</span>, &#123;</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/route/employeedetail.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeDetailController'</span></div><div class="line">    &#125;)</div><div class="line">    .when(<span class="string">'/employeeSearch/:keywords'</span>, &#123;</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/route/employeeSearch.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeSearchController'</span></div><div class="line">    &#125;)</div><div class="line">    .otherwise(&#123;</div><div class="line">      <span class="attr">redirectTo</span>: <span class="string">'/home'</span></div><div class="line">    &#125;)</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'homeController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$rootScope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $rootScope</span>)</span>&#123;</div><div class="line">  $scope.message = <span class="string">'home page'</span>;</div><div class="line">  <span class="comment">// $rootScope.$on('$routeChangeStart', function(event, next, cur)&#123;</span></div><div class="line">  <span class="comment">//   if (confirm('你真的要跳转到' + next.$$route.originalPath)) &#123;</span></div><div class="line">  <span class="comment">//     ;</span></div><div class="line">  <span class="comment">//   &#125; else &#123;</span></div><div class="line">  <span class="comment">//     event.preventDefault();</span></div><div class="line">  <span class="comment">//   &#125;</span></div><div class="line">  <span class="comment">// &#125;);</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// $rootScope.$on('$routeChangeSuccess', function(event, next, cur)&#123;</span></div><div class="line">  <span class="comment">//   console.log(cur.$$route.originalPath);</span></div><div class="line">  <span class="comment">// &#125;);</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// $rootScope.$on('$routeChangeError', function(event, next, cur)&#123;</span></div><div class="line">  <span class="comment">//   console.log(cur.$$route.originalPath);</span></div><div class="line">  <span class="comment">// &#125;);</span></div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'courseController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$rootScope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $rootScope</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> vm  = <span class="keyword">this</span>;</div><div class="line">  vm.courses = [<span class="string">'html5'</span>, <span class="string">'java'</span>, <span class="string">'android'</span>, <span class="string">'iOS'</span>];</div><div class="line">  $rootScope.color = <span class="string">'red'</span>;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="string">'$route'</span>, <span class="string">'$rootScope'</span>, <span class="string">'$location'</span>, <span class="string">'employeelist'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $http, $route, $rootScope, $location, employeelist</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> vm  = $scope;</div><div class="line"></div><div class="line">  vm.keywords = <span class="string">""</span>;</div><div class="line">  vm.search = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (vm.keywords) &#123;</div><div class="line">      $location.url(<span class="string">'/employeeSearch/'</span> + vm.keywords);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  vm.reload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $route.reload();</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">// $http(&#123;</span></div><div class="line">  <span class="comment">//   url: '/mock/employee.json'</span></div><div class="line">  <span class="comment">// &#125;)</span></div><div class="line">  <span class="comment">// .then(function(res)&#123;</span></div><div class="line">  <span class="comment">//   vm.employees = res.data.data;</span></div><div class="line">  <span class="comment">// &#125;, function()&#123;</span></div><div class="line">  <span class="comment">//   ;</span></div><div class="line">  <span class="comment">// &#125;)</span></div><div class="line">  vm.employees = employeelist;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeDetailController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$routeParams'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $routeParams, $http</span>)</span>&#123;</div><div class="line">  $http(&#123;</div><div class="line">    <span class="attr">url</span>: <span class="string">'/mock/employeedetail.json'</span>,</div><div class="line">    <span class="attr">params</span>: &#123;</div><div class="line">      <span class="attr">id</span>: $routeParams.abc</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">method</span>: <span class="string">'get'</span></div><div class="line">  &#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">    $scope.employee = res.data.data[<span class="number">0</span>];</div><div class="line">  &#125;)</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeSearchController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$routeParams'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $routeParams</span>)</span>&#123;</div><div class="line">  $scope.keywords = $routeParams.keywords;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>demo14.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span>&gt;</span>header<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"leftMenu"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/home"</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/course"</span>&gt;</span>course<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/employee"</span>&gt;</span>employee<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"mainContent"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">ng-view</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span>footer<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>courser.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Courses<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;color&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">"course in courseCtrl.courses"</span>&gt;</span></div><div class="line">	&#123;&#123;course&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>employeedetail.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>employee Detail<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">	&#123;&#123;employee.firstName&#125;&#125; &#123;&#123;employee.gender&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>employees.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>employees<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"></div><div class="line">搜索：<span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-model</span>=<span class="string">"keywords"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"search()"</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">"employee in employees"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/employee/&#123;&#123;employee.id&#125;&#125;"</span>&gt;</span>&#123;&#123;employee.firstName&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span> &#123;&#123;employee.gender&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"reload()"</span>&gt;</span>重新加载<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>employeeSearch.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>employee Search<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">	&#123;&#123;keywords&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>home.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;color&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">&#123;&#123;message&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;为了实现SPA开发，路由是不可避免的一个话题，Angular有一套官方提供的ng-Route，但是并不是很好用。&lt;/p&gt;
&lt;p&gt;ng-Route通过hash值和history两种方式实现路由工程。&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;服务$routeProvider定义了一个路由表&lt;/li&gt;
&lt;li&gt;服务$routeParams保存了地址栏中的参数&lt;/li&gt;
&lt;li&gt;服务$route完成路由匹配&lt;/li&gt;
&lt;li&gt;服务$location ，同window.location.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;主要事件：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$routeChangeStart&lt;br&gt;$routeChangeSuccess&lt;br&gt;$routeChangeError&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门---ui-Router</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-ui-Router/</id>
    <published>2016-11-24T09:23:54.000Z</published>
    <updated>2016-11-24T10:13:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>Angular有一套官方提供的ng-Route，但是并不是很好用,于是有人开发了一套ui-Router。</p>
<blockquote>
<ol>
<li>服务$stateProvider定义了一个路由表</li>
<li>服务$stateParams保存了地址栏中的参数</li>
<li>服务$state完成路由匹配。$state主要的属性和方法：<br>——–current:保存了当前state中的配置项<br>——–params<br>——–get(name,context)<br>——–go(to,params,options)<br>——–reload()</li>
</ol>
</blockquote>
<p>主要事件：</p>
<blockquote>
<p>$routeChangeStart<br>$routeChangeSuccess<br>$routeChangeError</p>
</blockquote>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>demo14.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo17.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="comment">//1.在模块中注入依赖</span></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, [<span class="string">'ui.router'</span>]);</div><div class="line"></div><div class="line"><span class="comment">//2.配置默认跳转路径</span></div><div class="line">myApp.config(<span class="function"><span class="keyword">function</span>(<span class="params">$urlRouterProvider</span>)</span>&#123;</div><div class="line">  $urlRouterProvider.otherwise(<span class="string">'/home'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//3.配置路径大小写敏感</span></div><div class="line">myApp.config(<span class="function"><span class="keyword">function</span>(<span class="params">$urlMatcherFactoryProvider</span>)</span>&#123;</div><div class="line">  $urlMatcherFactoryProvider.caseInsensitive(<span class="literal">false</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//4.定义路由表</span></div><div class="line"><span class="comment">// $stateProvider.state第二个参数配置项</span></div><div class="line"><span class="comment">//  url</span></div><div class="line"><span class="comment">//  controller</span></div><div class="line"><span class="comment">//  controllerAs</span></div><div class="line"><span class="comment">//  template</span></div><div class="line"><span class="comment">//  templateUrl</span></div><div class="line"><span class="comment">//  data    可以通过$state传递给其他路由，也是一个object，这对指令系统通信很有帮助</span></div><div class="line">myApp.config([<span class="string">'$stateProvider'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$stateProvider</span>) </span>&#123;</div><div class="line">  $stateProvider</div><div class="line">    .state(<span class="string">'home'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/home'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/home.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'homeController'</span>,</div><div class="line">      <span class="attr">controllerAs</span>: <span class="string">'homeCtrl'</span>,</div><div class="line">      <span class="attr">data</span>: &#123;</div><div class="line">        <span class="attr">customData</span>: <span class="string">'home自定义数据'</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    .state(<span class="string">'course'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/course'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/courses.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'courseController'</span>,</div><div class="line">      <span class="attr">controllerAs</span>: <span class="string">'courseCtrl'</span>,</div><div class="line">      <span class="attr">data</span>: &#123;</div><div class="line">        <span class="attr">customData</span>: <span class="string">'course自定义数据'</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">    .state(<span class="string">'employeeParent'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/employee'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/employeeParent.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeParentController'</span></div><div class="line">    &#125;)</div><div class="line">    .state(<span class="string">'employeeParent.employee'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/employees.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeController'</span>,</div><div class="line">      <span class="attr">controllerAs</span>: <span class="string">'employeeCtrl'</span>,</div><div class="line">      <span class="attr">resolve</span>: &#123;</div><div class="line">        <span class="attr">employeelist</span>: <span class="function"><span class="keyword">function</span>(<span class="params">$http</span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> $http.get(<span class="string">'/mock/employee.json'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> res.data.data;</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    .state(<span class="string">'employeeParent.employeeDetail'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/:id'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/employeedetail.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeDetailController'</span></div><div class="line">    &#125;)</div><div class="line"></div><div class="line">    .state(<span class="string">'employeeSearch'</span>, &#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'/employeeSearch/:keywords'</span>,</div><div class="line">      <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/ui-router/employeeSearch.html'</span>,</div><div class="line">      <span class="attr">controller</span>: <span class="string">'employeeSearchController'</span></div><div class="line">    &#125;)</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'homeController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$rootScope'</span>, <span class="string">'$state'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $rootScope, $state</span>)</span>&#123;</div><div class="line">  $scope.message = <span class="string">'home page'</span>;</div><div class="line">  $scope.customData2 = $state.get(<span class="string">'course'</span>).data.customData;</div><div class="line">  $scope.customData1 = $state.current.data.customData;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'courseController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$rootScope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $rootScope</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> vm  = <span class="keyword">this</span>;</div><div class="line">  vm.courses = [<span class="string">'html5'</span>, <span class="string">'java'</span>, <span class="string">'android'</span>, <span class="string">'iOS'</span>];</div><div class="line">  $rootScope.color = <span class="string">'red'</span>;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="string">'$state'</span>, <span class="string">'$rootScope'</span>, <span class="string">'employeelist'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $http, $state, $rootScope, employeelist</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> vm  = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  vm.keywords = <span class="string">""</span>;</div><div class="line">  vm.search = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (vm.keywords) &#123;</div><div class="line">      <span class="built_in">console</span>.log($state);</div><div class="line">      $state.go(<span class="string">'employeeSearch'</span>, &#123;</div><div class="line">        <span class="attr">keywords</span>: vm.keywords</div><div class="line">      &#125;)</div><div class="line">      <span class="comment">// $location.url('/employeeSearch/' + vm.keywords);</span></div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  vm.reload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $state.reload();</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  vm.employees = employeelist;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeDetailController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$stateParams'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $stateParams, $http</span>)</span>&#123;</div><div class="line">  $http(&#123;</div><div class="line">    <span class="attr">url</span>: <span class="string">'/mock/employeedetail.json'</span>,</div><div class="line">    <span class="attr">params</span>: &#123;</div><div class="line">      <span class="attr">id</span>: $stateParams.id</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">method</span>: <span class="string">'get'</span></div><div class="line">  &#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">    $scope.employee = res.data.data[<span class="number">0</span>];</div><div class="line">  &#125;)</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeSearchController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$stateParams'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $stateParams</span>)</span>&#123;</div><div class="line">  $scope.keywords = $stateParams.keywords;</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'employeeParentController'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  ;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo14.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span>&gt;</span>header<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"leftMenu"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"home"</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"course"</span>&gt;</span>course<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"employeeParent.employee"</span>&gt;</span>employee<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"mainContent"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">ui-view</span>&gt;</span><span class="tag">&lt;/<span class="name">ui-view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span>footer<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Angular有一套官方提供的ng-Route，但是并不是很好用,于是有人开发了一套ui-Router。&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;服务$stateProvider定义了一个路由表&lt;/li&gt;
&lt;li&gt;服务$stateParams保存了地址栏中的参数&lt;/li&gt;
&lt;li&gt;服务$state完成路由匹配。$state主要的属性和方法：&lt;br&gt;——–current:保存了当前state中的配置项&lt;br&gt;——–params&lt;br&gt;——–get(name,context)&lt;br&gt;——–go(to,params,options)&lt;br&gt;——–reload()&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;主要事件：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$routeChangeStart&lt;br&gt;$routeChangeSuccess&lt;br&gt;$routeChangeError&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Angular基础入门---自定义指令（组件）</title>
    <link href="https://chping2125.github.io/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/"/>
    <id>https://chping2125.github.io/2016/11/24/Angular基础入门-自定义指令（组件）/</id>
    <published>2016-11-24T09:20:54.000Z</published>
    <updated>2016-11-24T10:13:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>Angular1.x版本中并没有提出组件的概念，但是其自定义指令系统可以实现组件的概念。组件之间的通信则可以相应转换为controller之间的通信或者作用域问题。</p>
<p>自定义指令需要经过compile(编译)和link(链接)两个过程。</p>
<a id="more"></a>
<p><strong>说明</strong></p>
<blockquote>
<ol>
<li>Angular基础入门系列文章一共6篇，主要是为了<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上“course-angular”</a>仓库的一个说明性的小文章。</li>
<li>随着Vue、React的逐渐流行开来，Angular也发布了第二版，Angular1.x版使用开始减少，但是有时可能会遇到一些Angular1.x的一些问题，另外前端技术发展太快，技术一段时间不使用，就可能遗忘，这个小系列文章和<a href="https://github.com/chping2125/course-angular" target="_blank" rel="external">github上的course-angular</a>也是为了日后回头看看Angular相关基础之用。</li>
</ol>
</blockquote>
<p><strong>Angular基础入门</strong></p>
<ol>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%92%8C%E6%8C%87%E4%BB%A4/" target="_blank" rel="external">Angular基础入门–数据绑定和指令</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="external">Angular基础入门—过滤器</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Angular基础入门—作用域和通信</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ng-Route/" target="_blank" rel="external">Angular基础入门—ng-Route</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-ui-Router/" target="_blank" rel="external">Angular基础入门—ui-Router</a></li>
<li><a href="http://chping.website/2016/11/24/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%EF%BC%88%E7%BB%84%E4%BB%B6%EF%BC%89/" target="_blank" rel="external">Angular基础入门—自定义指令（组件）</a></li>
</ol>
<p><strong>以下每个实例的公共的util工具类</strong><br>common.util.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</div><div class="line">    body.innerHTML = str + body.innerHTML;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>demo15.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> demoTpl = <span class="built_in">require</span>(<span class="string">'../tpls/demo15.string'</span>);</div><div class="line"><span class="keyword">var</span> commonUtil = <span class="built_in">require</span>(<span class="string">'../utils/common.util.js'</span>);</div><div class="line">commonUtil.render(demoTpl);</div><div class="line"></div><div class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">'myApp'</span>, []);</div><div class="line"></div><div class="line">myApp.controller(<span class="string">'parentCtrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">  $scope.message = <span class="string">"aaaa"</span>;</div><div class="line">  $scope.message2 = <span class="string">"parent message2"</span>;</div><div class="line">  $scope.changeValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $scope.message2 = <span class="string">'aaaaaaaa'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//directive方法回调函数返回对象属性</span></div><div class="line"><span class="comment">//  restrict: 'ECMA'    E: 指令标签 C：class指令  M：注释指令   A：属性指令</span></div><div class="line"><span class="comment">//  replace: true   使用模板替换元标记</span></div><div class="line"><span class="comment">//  controller      当前指令上的controller</span></div><div class="line"><span class="comment">//  template        当前路由的模板</span></div><div class="line"><span class="comment">//  templateUrl     当前路由的模板路径</span></div><div class="line"><span class="comment">//  scope    true 默认为false,继承父作用域；true为独立作用域。</span></div><div class="line"><span class="comment">//  link  表示当directive被angular编译后，执行该方法。link三个参数</span></div><div class="line"><span class="comment">//      scope:表示当前controller下的数据</span></div><div class="line"><span class="comment">//      element: 当前DOM</span></div><div class="line"><span class="comment">//      attr:当前DOM的自定义属性</span></div><div class="line">myApp.directive(<span class="string">'helloWorld'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">restrict</span>: <span class="string">'EA'</span>,</div><div class="line">    <span class="attr">templateUrl</span>: <span class="string">'/src/scripts/tpls/directiveTpl.html'</span>,</div><div class="line">    <span class="attr">replace</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">scope</span>: &#123;</div><div class="line">      <span class="attr">message2</span>: <span class="string">"="</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">controller</span>: <span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">      $scope.message = <span class="string">"zzzz"</span>;</div><div class="line">      <span class="comment">// $scope.message2 = 'bbbb';</span></div><div class="line">      $scope.changeValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        $scope.message2 = <span class="string">'bbbbbbbbb'</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">compile</span>: <span class="function"><span class="keyword">function</span>(<span class="params">elem, attrs</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">scope, elem, attrs</span>) </span>&#123;</div><div class="line">        <span class="comment">// console.log(scope.message);</span></div><div class="line">        elem.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="built_in">console</span>.log(<span class="number">0</span>);</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// console.log(attrs.scrollX);</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>demo15.string<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo15"</span> <span class="attr">ng-controller</span>=<span class="string">"parentCtrl"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- &lt;hello-world url="http://www.baidu.com" scroll-x="true"&gt;&lt;/hello-world&gt; --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">hello-world</span> <span class="attr">message2</span>=<span class="string">"message2"</span>&gt;</span><span class="tag">&lt;/<span class="name">hello-world</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>parent:&#123;&#123;message2&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"changeValue()"</span>&gt;</span>parent changeValue<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Angular1.x版本中并没有提出组件的概念，但是其自定义指令系统可以实现组件的概念。组件之间的通信则可以相应转换为controller之间的通信或者作用域问题。&lt;/p&gt;
&lt;p&gt;自定义指令需要经过compile(编译)和link(链接)两个过程。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Angular" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/Angular/"/>
    
    
      <category term="Angular基础入门" scheme="https://chping2125.github.io/tags/Angular%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>我的gulp使用</title>
    <link href="https://chping2125.github.io/2016/11/09/%E6%88%91%E7%9A%84gulp%E4%BD%BF%E7%94%A8/"/>
    <id>https://chping2125.github.io/2016/11/09/我的gulp使用/</id>
    <published>2016-11-09T13:04:45.000Z</published>
    <updated>2016-11-22T07:08:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>gulp作为流行的前端自动化构建工具，通过管道流的思想使我们更容易把控整个前端开发流程。本文简单记录一下我自己的gulp配置文件和自己学习和使用中收集的一部分资源，主要目的是为了自己在以后的开发过程中使用到gulp时，可以方便的查找一些基本配置和第三方插件。</p>
<p>如果想学习gulp的相关内容可以从下面第一小节<strong>关于gulp的一些资源bolg</strong>中查看一些网上的教程，如果你对gulp和webpack有疑问，想了解他们的区别也可以看一下这篇<a href="http://chping.website/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/" target="_blank" rel="external">Gulp和Webpack对比</a><br><a id="more"></a></p>
<h1 id="关于gulp的一些资源bolg"><a href="#关于gulp的一些资源bolg" class="headerlink" title="关于gulp的一些资源bolg"></a>关于gulp的一些资源bolg</h1><ol>
<li><a href="http://www.gulpjs.com.cn/" target="_blank" rel="external">Gulp中文网</a></li>
<li><a href="http://www.ydcss.com/archives/18" target="_blank" rel="external">gulp详细入门教程</a></li>
<li><a href="http://jafeney.com/2016/03/06/20160306-gulp/" target="_blank" rel="external">深入理解gulp自动化</a></li>
<li><a href="http://www.68kejian.com/app/detail.html?id=22&amp;&amp;c=80" target="_blank" rel="external">gulp插件大全</a></li>
</ol>
<p>暂时只有这么多，gulp只在一个项目中使用过，遇到问题通过这几篇bolg也差不多都能解决。</p>
<h1 id="gulp配置文件"><a href="#gulp配置文件" class="headerlink" title="gulp配置文件"></a>gulp配置文件</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//引入 gulp 工具</span></div><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="comment">//引入 gulp-webserver 模块</span></div><div class="line"><span class="keyword">var</span> webserver = <span class="built_in">require</span>(<span class="string">'gulp-webserver'</span>);</div><div class="line"><span class="comment">//引入 sass 模块</span></div><div class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</div><div class="line"><span class="comment">//引入 minify 模块</span></div><div class="line"><span class="keyword">var</span> minifyCSS = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</div><div class="line"><span class="comment">// 引入js 相关模块</span></div><div class="line"><span class="keyword">var</span> named = <span class="built_in">require</span>(<span class="string">'vinyl-named'</span>);</div><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'gulp-webpack'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"><span class="comment">//引入 fs url模块</span></div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line"><span class="comment">//引入 rev revCollector 模块</span></div><div class="line"><span class="keyword">var</span> rev = <span class="built_in">require</span>(<span class="string">'gulp-rev'</span>);</div><div class="line"><span class="keyword">var</span> revCollector = <span class="built_in">require</span>(<span class="string">'gulp-rev-collector'</span>);</div><div class="line"><span class="keyword">var</span> revAppend = <span class="built_in">require</span>(<span class="string">'gulp-rev-append'</span>);</div><div class="line"><span class="comment">//引入 sequence 模块</span></div><div class="line"><span class="keyword">var</span> sequence = <span class="built_in">require</span>(<span class="string">'gulp-sequence'</span>);</div><div class="line"><span class="comment">//引入 css前缀 模块</span></div><div class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'gulp-autoprefixer'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//启动server</span></div><div class="line">gulp.task(<span class="string">'webserver'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'./'</span>)</div><div class="line">  .pipe(webserver(&#123;</div><div class="line">    <span class="attr">host</span>:<span class="string">'localhost'</span>,</div><div class="line">    <span class="attr">port</span>:<span class="number">80</span>,</div><div class="line">    <span class="comment">//浏览器自动刷新</span></div><div class="line">    livereload:<span class="literal">true</span>,</div><div class="line">    <span class="comment">//显示文件目录</span></div><div class="line">    directoryListing:&#123;</div><div class="line">      <span class="attr">enable</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">path</span>:<span class="string">'./'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">//mock数据</span></div><div class="line">    middleware:<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</div><div class="line">      <span class="keyword">var</span> urlObj = url.parse(req.url,<span class="literal">true</span>);</div><div class="line">      <span class="keyword">switch</span> (urlObj.pathname) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'/pro/getPro'</span>:</div><div class="line">          res.setHeader(<span class="string">'Content-Type'</span>,<span class="string">'application/json;charaset=utf-8'</span>);</div><div class="line">          fs.readFile(<span class="string">'./mock/list.json'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">            <span class="comment">//上面list.json路径使用相对路径，绝对路径前台无法获取数据</span></div><div class="line">            res.end(data);</div><div class="line">          &#125;);</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">'/web/getUser'</span>:</div><div class="line">          <span class="comment">//....</span></div><div class="line">          <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">      next();</div><div class="line">    &#125;</div><div class="line">  &#125;));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//css 预处理</span></div><div class="line"><span class="keyword">var</span> cssFiles = [</div><div class="line">  <span class="string">'./src/styles/usage/page/index.scss'</span></div><div class="line">]</div><div class="line">gulp.task(<span class="string">'sass'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(cssFiles)</div><div class="line">  .pipe(sass().on(<span class="string">'error'</span>,sass.logError))</div><div class="line">  <span class="comment">// .pipe(minifyCSS())//压缩css</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//js 模块化，合并压缩</span></div><div class="line"><span class="keyword">var</span> jsFiles = [</div><div class="line">  <span class="string">'./src/scripts/app.js'</span></div><div class="line">];</div><div class="line">gulp.task(<span class="string">'packjs'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(jsFiles)</div><div class="line">  .pipe(named())</div><div class="line">  .pipe(webpack(&#123;</div><div class="line">    <span class="attr">output</span>:&#123;<span class="comment">//定义输出文件名</span></div><div class="line">      filename:<span class="string">'[name].js'</span><span class="comment">//此处[name]通过named()获取的</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">module</span>:&#123;</div><div class="line">      <span class="attr">loaders</span>:[&#123;</div><div class="line">          <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">          <span class="attr">loader</span>:<span class="string">'imports?define=&gt;false'</span><span class="comment">//不符合commandJS规范的不编译</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="attr">test</span>:<span class="regexp">/\.string$/</span>,</div><div class="line">          <span class="attr">loader</span>:<span class="string">'string'</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;))</div><div class="line">  <span class="comment">// .pipe(uglify().on('error',function(err)&#123;//压缩js文件</span></div><div class="line">  <span class="comment">//   console.log('\x07',err.lineNumber,err.message);</span></div><div class="line">  <span class="comment">//   return this.end();</span></div><div class="line">  <span class="comment">// &#125;))</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>));</div><div class="line">&#125;);</div><div class="line"><span class="comment">//合并成一个js文件</span></div><div class="line">gulp.task(<span class="string">'concat'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(jsFiles)</div><div class="line">  .pipe(concat(<span class="string">'all.js'</span>))<span class="comment">//合并后的文件名</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> cssDistFiles = [</div><div class="line">  <span class="string">'./build/prd/styles/app.css'</span></div><div class="line">];</div><div class="line"><span class="keyword">var</span> jsDistFiles = [</div><div class="line">  <span class="string">'./build/prd/scripts/app.js'</span></div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">//css 添加前缀</span></div><div class="line">gulp.task(<span class="string">'autoprefixer'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(cssDistFiles)</div><div class="line">  .pipe(autoprefixer(&#123;</div><div class="line">    <span class="attr">browsers</span>:[<span class="string">'last 2 cersions'</span>,<span class="string">'Android &gt;= 4.0'</span>],</div><div class="line">    <span class="attr">cascade</span>: <span class="literal">true</span>,<span class="comment">//是否美化属性值 默认：true 像这样：</span></div><div class="line">    <span class="comment">//-webkit-transform: rotate(45deg);</span></div><div class="line">    <span class="comment">//        transform: rotate(45deg);</span></div><div class="line">    remove:<span class="literal">true</span><span class="comment">//是否去掉不必要的前缀 默认：true</span></div><div class="line">  &#125;))</div><div class="line">  .pipe(gulp.dest(<span class="string">'.build/ver/styles'</span>))</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 版本号控制</span></div><div class="line">gulp.task(<span class="string">'ver'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(cssDistFiles)</div><div class="line">  .pipe(rev())<span class="comment">//产生MD5码</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>))</div><div class="line">  .pipe(rev.manifest())<span class="comment">//产生版本信息的json文件</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/ver/styles/'</span>));</div><div class="line">  gulp.src(jsDistFiles)</div><div class="line">  .pipe(rev())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>))</div><div class="line">  .pipe(rev.manifest())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/ver/scripts/'</span>));</div><div class="line">&#125;)</div><div class="line">gulp.task(<span class="string">'html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src([<span class="string">'./build/ver/**/*'</span>,<span class="string">'./build/*.html'</span>])</div><div class="line">  .pipe(revCollector())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/'</span>));</div><div class="line">&#125;)</div><div class="line">gulp.task(<span class="string">'min'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</div><div class="line">  sequence([<span class="string">'copy-index'</span>,<span class="string">'ver'</span>,<span class="string">'html'</span>])(callback);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// rev 版本控制</span></div><div class="line">gulp.task(<span class="string">'rev-append'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'./build/*.html'</span>)</div><div class="line">  .pipe(revAppend())</div><div class="line">  .pipe(gulp.dest(<span class="string">'build/html'</span>));</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">//拷贝 index.html 到 build 文件夹</span></div><div class="line">gulp.task(<span class="string">'copy-index'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'./index.html'</span>)</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//拷贝 images 到 build 文件夹</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//注意：</span></div><div class="line"><span class="comment">//*.&#123;jpg,png&#125;    拷贝文件下的指定后缀的文件</span></div><div class="line"><span class="comment">//*.*           拷贝文件下的所有文件</span></div><div class="line"><span class="comment">//**/*          拷贝文件下所有文件（包括文件夹）</span></div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'./images/**/*'</span>)</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/images/'</span>));</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 配置 default 任务，执行任务队列</div><div class="line"> * arg1[String]</div><div class="line"> *</div><div class="line"> */</div><div class="line"> <span class="comment">//侦测 文件变化，执行相应的任务</span></div><div class="line"> gulp.task(<span class="string">'watch'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   gulp.watch(<span class="string">'./index.html'</span>,[<span class="string">'copy-index'</span>]);</div><div class="line">   gulp.watch(<span class="string">'./images/**/*'</span>,[<span class="string">'copy-images'</span>]);</div><div class="line">   gulp.watch(<span class="string">'./src/styles/**/*'</span>,[<span class="string">'sass'</span>,<span class="string">'min'</span>]);</div><div class="line">   gulp.watch(<span class="string">'./src/scripts/**/*'</span>,[<span class="string">'packjs'</span>,<span class="string">'min'</span>]);</div><div class="line"> &#125;);</div><div class="line"></div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'watch'</span>,<span class="string">'webserver'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'所有任务队列执行完毕'</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h1><p>gulp-webserver: server服务<br>gulp-sass: sass预编译<br>gulp-less: less预编译<br>gulp-autoprefixer: css厂商前缀<br>gulp-minify-css: css压缩<br>gulp-webpack: webpack插件<br>vingl-named: 文件名索引查找插件<br>gulp-uglify: JS压缩<br>gulp-rev: MD5码<br>gulp-rev-collector: 版本控制<br>gulp-sequence: 序列执行gulptask(v3.9使用，v4.0则不需要了)<br>gulp-connect/gulp-connect-proxy: server代理</p>
<p>这里有一个<a href="http://www.68kejian.com/app/course.html?id=22&amp;&amp;c=29&amp;&amp;name=gulp%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6%E5%A4%A7%E6%B1%87%E6%80%BB" target="_blank" rel="external">gulp插件常用大汇总</a></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>gulp用的不多，持续更新中相关资源和配置信息。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;gulp作为流行的前端自动化构建工具，通过管道流的思想使我们更容易把控整个前端开发流程。本文简单记录一下我自己的gulp配置文件和自己学习和使用中收集的一部分资源，主要目的是为了自己在以后的开发过程中使用到gulp时，可以方便的查找一些基本配置和第三方插件。&lt;/p&gt;
&lt;p&gt;如果想学习gulp的相关内容可以从下面第一小节&lt;strong&gt;关于gulp的一些资源bolg&lt;/strong&gt;中查看一些网上的教程，如果你对gulp和webpack有疑问，想了解他们的区别也可以看一下这篇&lt;a href=&quot;http://chping.website/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/&quot;&gt;Gulp和Webpack对比&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="工具" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="Gulp" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/Gulp/"/>
    
    
      <category term="Gulp" scheme="https://chping2125.github.io/tags/Gulp/"/>
    
  </entry>
  
  <entry>
    <title>我的webpack使用</title>
    <link href="https://chping2125.github.io/2016/11/09/%E6%88%91%E7%9A%84webpack%E4%BD%BF%E7%94%A8/"/>
    <id>https://chping2125.github.io/2016/11/09/我的webpack使用/</id>
    <published>2016-11-09T12:44:04.000Z</published>
    <updated>2016-11-24T01:21:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>webpack作为模块打包机，在前端模块化开发中频繁的被使用。本篇主要记录一些我自己在学习和使用webpack中遇到问题，保存的一些比较好的博客文章和自己项目的webpack的配置文档，方便以后项目中使用时参考，不用每次都去翻老项目看webpack配置，有些第三方loader和插件的配置或者名称有时就是想不起来（看来老了呀）。</p>
<p>如果想学习webpack的相关内容可以从下面第一小节<strong>关于webpack的一些资源bolg</strong>中查看一些网上的教程，如果你对gulp和webpack有疑问，想了解他们的区别也可以看一下这篇<a href="http://chping.website/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/" target="_blank" rel="external">Gulp和Webpack对比</a><br><a id="more"></a></p>
<h1 id="关于webpack的一些资源bolg"><a href="#关于webpack的一些资源bolg" class="headerlink" title="关于webpack的一些资源bolg"></a>关于webpack的一些资源bolg</h1><ol>
<li><a href="http://www.jianshu.com/p/42e11515c10f" target="_blank" rel="external">入门Webpack，看这篇就够了</a></li>
<li><a href="http://webpackdoc.com/index.html" target="_blank" rel="external">Webpack 中文指南</a></li>
<li><a href="http://www.68kejian.com/app/detail.html?id=76&amp;&amp;c=442" target="_blank" rel="external">Webpack课件</a></li>
<li><a href="https://diamont1001.github.io/webpack-summary/" target="_blank" rel="external">Webpack学习总结</a></li>
<li><a href="http://www.cnblogs.com/xianyulaodi/p/5314769.html#_label0" target="_blank" rel="external">Webpack学习总结     另一份</a></li>
<li><a href="https://github.com/icepy/none-writing/issues/25" target="_blank" rel="external">webpack在PC项目中的应用</a></li>
<li><a href="http://www.cnblogs.com/ghost-xyx/p/5812902.html" target="_blank" rel="external">图片的路径与打包</a></li>
<li><a href="https://segmentfault.com/a/1190000005995267" target="_blank" rel="external">webpack 教程资源收集(包括与Vue，与React，与Angular项目使用)</a></li>
<li><a href="https://github.com/ruanyf/webpack-demos" target="_blank" rel="external">阮一峰老师的webpack-demos(英文文档)</a></li>
</ol>
<p>上面这些关于webpack的资源已经可以满足你对webpack的学习了，其中每篇Bolg各有千秋，都有自己侧重点，值得好好学习。</p>
<h1 id="webpack配置文件"><a href="#webpack配置文件" class="headerlink" title="webpack配置文件"></a>webpack配置文件</h1><h2 id="单独使用"><a href="#单独使用" class="headerlink" title="单独使用"></a>单独使用</h2><p>所谓的单独使用就是在项目开发过程中，直接通过<code>webpack</code>或者<code>webpack server</code>来使用webpack的相关功能。与之相对的是通过nodeJS来配合使用webpack，下一小节介绍。</p>
<p>当我单独使用webpack时，我的配置文件就一个<code>webpack.config.js</code>，简单配置，可根据不通项目添加loader和plugins。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> Et = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> OpenBrowserPlugin = <span class="built_in">require</span>(<span class="string">'open-browser-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">devtool</span>: <span class="string">'eval-source-map'</span>,<span class="comment">//配置生成Source Maps，选择合适的选项</span></div><div class="line">  entry: [ __dirname + <span class="string">"/src/scripts/app.js"</span>],<span class="comment">//唯一入口文件，可以是对象或者数组</span></div><div class="line">  output: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname + <span class="string">"/prd/"</span>,<span class="comment">//打包后的文件存放的地方</span></div><div class="line">    <span class="comment">//filename: "[name]-[hash].js"//打包后输出文件的文件名并且版本控制，一般不用与生产环境中</span></div><div class="line">    filename: <span class="string">"bundle.js"</span><span class="comment">//打包后输出文件的文件名</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>:&#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</div><div class="line">        <span class="attr">loader</span>:<span class="string">'style!css'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</div><div class="line">        <span class="attr">loader</span>: Et.extract(<span class="string">'style'</span>,<span class="string">'css!sass'</span>)<span class="comment">//从js中抽离scss文件</span></div><div class="line">        <span class="comment">// loader:'style!css!sass'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,<span class="comment">//屏蔽不需要处理的文件（文件夹）（可选）</span></div><div class="line">        loader:<span class="string">'babel'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.string$/</span>,</div><div class="line">        <span class="attr">loader</span>:<span class="string">'string'</span></div><div class="line">      &#125;,</div><div class="line">      <span class="comment">// &#123;</span></div><div class="line">      <span class="comment">//   test: /\.html$/,</span></div><div class="line">      <span class="comment">//   loader: 'html-withimg-loader'</span></div><div class="line">      <span class="comment">// &#125;,</span></div><div class="line">      &#123;</div><div class="line">　　　　　<span class="attr">test</span>: <span class="regexp">/\.(png|jpg|jpeg|gif)$/</span>,</div><div class="line">　　　　　<span class="attr">loader</span>: <span class="string">'url-loader?limit=8192&amp;name=images/[hash:8].[name].[ext]'</span><span class="comment">//图片打包限制，这个限制并不是说超过了就不能打包，而是指当图片大小小于限制时会自动转成 base64 码引用。上例中大于8192字节的图片正常打包，小于8192字节的图片以 base64 的方式引用。</span></div><div class="line">　　　　&#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="comment">//复制文件</span></div><div class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</div><div class="line">       &#123;</div><div class="line">         <span class="attr">from</span> : <span class="string">'./src/images'</span>,<span class="comment">//定义要拷贝的源目录   __dirname + ‘/src/public’</span></div><div class="line">         to : <span class="string">'./images'</span>,<span class="comment">//定义要拷贝的目标目录  __dirname + ‘/dist’</span></div><div class="line">        <span class="comment">//  toType : 'dir'//file 或者 dir , 可选，默认是文件</span></div><div class="line">        <span class="comment">//  force : 强制覆盖先前的插件 , 可选 默认false</span></div><div class="line">        <span class="comment">//  context : 不知道作用 , 可选 默认 base context 可用 specific context</span></div><div class="line">        <span class="comment">//  flatten :只拷贝文件不管文件夹 , 默认是false</span></div><div class="line">        <span class="comment">//  ignore : 忽略拷贝指定的文件 ,可以用模糊匹配</span></div><div class="line">      &#125;,&#123;</div><div class="line">        <span class="attr">from</span> : <span class="string">'./index.html'</span>,<span class="comment">//定义要拷贝的源目录   __dirname + ‘/src/public’</span></div><div class="line">      &#125;</div><div class="line">   ]),</div><div class="line">    <span class="comment">//自动打开浏览器</span></div><div class="line">    <span class="keyword">new</span> OpenBrowserPlugin(&#123;<span class="attr">url</span>: <span class="string">'http://localhost:80/'</span> + <span class="string">'index.html'</span>&#125;),</div><div class="line">    <span class="comment">//js文件压缩</span></div><div class="line">    <span class="comment">//new Webpack.optimize.UglifyJsPlugin(),</span></div><div class="line">    <span class="comment">//从js中抽离scss文件并且版本控制</span></div><div class="line">    <span class="comment">//new Et('[name]-[hash].css')</span></div><div class="line">    <span class="keyword">new</span> Et(<span class="string">'bundle.css'</span>),<span class="comment">//从js中抽离scss文件</span></div><div class="line">    <span class="comment">//html文件操作</span></div><div class="line">    <span class="comment">// new HtmlWebpackPlugin(&#123;</span></div><div class="line">    <span class="comment">//       template: './prd/index.html',</span></div><div class="line">    <span class="comment">//   &#125;)</span></div><div class="line">  ]，</div><div class="line">  devServer: &#123;</div><div class="line">    <span class="attr">contentBase</span>:  __dirname + <span class="string">'/prd'</span>,<span class="comment">//本地服务器所加载的页面所在的目录</span></div><div class="line">    port:<span class="number">8080</span>,</div><div class="line">    <span class="attr">colors</span>: <span class="literal">true</span>,<span class="comment">//终端中输出结果为彩色</span></div><div class="line">    <span class="comment">//historyApiFallback: true,//不跳转</span></div><div class="line">    inline: <span class="literal">true</span>,<span class="comment">//实时刷新</span></div><div class="line">    hot: <span class="literal">true</span><span class="comment">//热启动</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>以上配置不代表任何含义，只是一个有助于自己以后方便查找的文档而已。</p>
<h2 id="通过NodeJS使用"><a href="#通过NodeJS使用" class="headerlink" title="通过NodeJS使用"></a>通过NodeJS使用</h2><p>此时需要一个另外配置server.js，通过node运行server.js来加载配置文件。</p>
<p><strong>server.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> webpackeDevServer = <span class="built_in">require</span>(<span class="string">'webpack-dev-server'</span>);</div><div class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);<span class="comment">//webpack配置文件路径</span></div><div class="line"></div><div class="line"><span class="keyword">new</span> webpackeDevServer(webpack(config),&#123;</div><div class="line">  <span class="attr">contentBase</span>:  __dirname + <span class="string">'/prd'</span>,<span class="comment">//本地服务器所加载的页面所在的目录</span></div><div class="line">  port:<span class="number">80</span>,</div><div class="line">  <span class="attr">colors</span>: <span class="literal">true</span>,<span class="comment">//终端中输出结果为彩色</span></div><div class="line">  quiet: <span class="literal">false</span>, <span class="comment">//控制台中不输出打包的信息</span></div><div class="line">  historyApiFallback: <span class="literal">true</span>,<span class="comment">//不跳转</span></div><div class="line">  inline: <span class="literal">true</span>,<span class="comment">//实时刷新</span></div><div class="line">  hot: <span class="literal">true</span>,<span class="comment">//热启动</span></div><div class="line">  progress: <span class="literal">true</span>, <span class="comment">//显示打包的进度</span></div><div class="line">  lazy: <span class="literal">false</span>,<span class="comment">//懒加载</span></div><div class="line">  <span class="comment">//反向代理</span></div><div class="line">  proxy:&#123;</div><div class="line">    <span class="string">'/http://chping.site/*'</span>:&#123;</div><div class="line">      <span class="attr">target</span>:<span class="string">'http:localhost:3000'</span>,</div><div class="line">      <span class="attr">pathRewrite</span>: &#123;</div><div class="line">        <span class="string">'^/http://chping.site/'</span>:<span class="string">''</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;).listen(<span class="number">80</span>,<span class="string">'localhost'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,result</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(err)&#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'listening at localhost:80'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>webpack.config.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> Et = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> OpenBrowserPlugin = <span class="built_in">require</span>(<span class="string">'open-browser-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">devtool</span>: <span class="string">'eval-source-map'</span>,<span class="comment">//配置生成Source Maps，选择合适的选项</span></div><div class="line">  entry: [</div><div class="line">    <span class="comment">//react-hot配置</span></div><div class="line">    <span class="string">'webpack-dev-server/client?http://localhost'</span>,</div><div class="line">    <span class="string">'webpack/hot/only-dev-server'</span>,</div><div class="line">		__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">	],<span class="comment">//已多次提及的唯一入口文件</span></div><div class="line">  output: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname + <span class="string">"/prd/"</span>,<span class="comment">//打包后的文件存放的地方</span></div><div class="line">    <span class="comment">//filename: "[name]-[hash].js"//打包后输出文件的文件名并且版本控制</span></div><div class="line">    filename: <span class="string">"bundle.js"</span><span class="comment">//打包后输出文件的文件名</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>:&#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</div><div class="line">        <span class="attr">loader</span>:<span class="string">'style!css'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</div><div class="line">        <span class="attr">loader</span>: Et.extract(<span class="string">'style'</span>,<span class="string">'css!sass'</span>)<span class="comment">//从js中抽离scss文件</span></div><div class="line">        <span class="comment">// loader:'style!css!sass'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,<span class="comment">//屏蔽不需要处理的文件（文件夹）（可选）</span></div><div class="line">        loader:<span class="string">'babel'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>:<span class="regexp">/\.string$/</span>,</div><div class="line">        <span class="attr">loader</span>:<span class="string">'string'</span></div><div class="line">      &#125;,</div><div class="line">      <span class="comment">// &#123;</span></div><div class="line">      <span class="comment">//   test: /\.html$/,</span></div><div class="line">      <span class="comment">//   loader: 'html-withimg-loader'</span></div><div class="line">      <span class="comment">// &#125;,</span></div><div class="line">      &#123;</div><div class="line">　　　　　<span class="attr">test</span>: <span class="regexp">/\.(png|jpg|jpeg|gif)$/</span>,</div><div class="line">　　　　　<span class="attr">loader</span>: <span class="string">'url-loader?limit=8192&amp;name=images/[hash:8].[name].[ext]'</span><span class="comment">//图片打包限制，这个限制并不是说超过了就不能打包，而是指当图片大小小于限制时会自动转成 base64 码引用。上例中大于8192字节的图片正常打包，小于8192字节的图片以 base64 的方式引用。</span></div><div class="line">　　　　&#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="comment">//plugin热启动</span></div><div class="line">    <span class="keyword">new</span> Webpack.HotModuleReplacementPlugin(),</div><div class="line">    <span class="comment">//复制文件</span></div><div class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</div><div class="line">       &#123;</div><div class="line">         <span class="attr">from</span> : <span class="string">'./src/images'</span>,<span class="comment">//定义要拷贝的源目录   __dirname + ‘/src/public’</span></div><div class="line">         to : <span class="string">'./images'</span>,<span class="comment">//定义要拷贝的目标目录  __dirname + ‘/dist’</span></div><div class="line">        <span class="comment">//  toType : 'dir'//file 或者 dir , 可选，默认是文件</span></div><div class="line">        <span class="comment">//  force : 强制覆盖先前的插件 , 可选 默认false</span></div><div class="line">        <span class="comment">//  context : 不知道作用 , 可选 默认 base context 可用 specific context</span></div><div class="line">        <span class="comment">//  flatten :只拷贝文件不管文件夹 , 默认是false</span></div><div class="line">        <span class="comment">//  ignore : 忽略拷贝指定的文件 ,可以用模糊匹配</span></div><div class="line">      &#125;,&#123;</div><div class="line">        <span class="attr">from</span> : <span class="string">'./index.html'</span>,<span class="comment">//定义要拷贝的源目录   __dirname + ‘/src/public’</span></div><div class="line">      &#125;</div><div class="line">   ]),</div><div class="line">    <span class="comment">//自动打开浏览器</span></div><div class="line">    <span class="keyword">new</span> OpenBrowserPlugin(&#123;<span class="attr">url</span>: <span class="string">'http://localhost:80/'</span> + <span class="string">'index.html'</span>&#125;),</div><div class="line">    <span class="comment">//js文件压缩</span></div><div class="line">    <span class="comment">//new Webpack.optimize.UglifyJsPlugin(),</span></div><div class="line">    <span class="comment">//从js中抽离scss文件并且版本控制</span></div><div class="line">    <span class="comment">//new Et('[name]-[hash].css')</span></div><div class="line">    <span class="keyword">new</span> Et(<span class="string">'bundle.css'</span>),<span class="comment">//从js中抽离scss文件</span></div><div class="line">    <span class="comment">//html文件操作</span></div><div class="line">    <span class="comment">// new HtmlWebpackPlugin(&#123;</span></div><div class="line">    <span class="comment">//       template: './prd/index.html',</span></div><div class="line">    <span class="comment">//   &#125;)</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>相比较单独使用的webpack配置文件，此处的<code>webpack.config.js</code>文件中取消了dev-server的配置，并且在入口<strong>entry</strong>中添加了部分设置和在<strong>plugins</strong>中添加了热启动的相关配置。</p>
<h2 id="React中使用"><a href="#React中使用" class="headerlink" title="React中使用"></a>React中使用</h2><p>React开发中使用webpack是件很美妙的事情，这里有篇文章可以了解一下<a href="http://www.infoq.com/cn/articles/react-and-webpack?utm_source=articles_about_dive-into-react&amp;utm_medium=link&amp;utm_campaign=dive-into-react" target="_blank" rel="external">深入浅出React（二）：React开发神器Webpack</a>，热更新是个很方便使用的技能，用webpack实现其实也不难，只需要安装一个<strong>react-hot-loader</strong>，然后简单配置一下就好了。下面是webpack的相关配置：</p>
<p>server.js文件同上一小节总NodeJS中一致，下面是webpack.config.js的配置，重点注意入口文件配置项和plugins配置。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> ET = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="comment">// 入口</span></div><div class="line">  entry: [</div><div class="line">    <span class="string">'webpack-dev-server/client?http://localhost'</span>,</div><div class="line">    <span class="string">'webpack/hot/only-dev-server'</span>,</div><div class="line">    __dirname + <span class="string">'/src/scripts/app.js'</span></div><div class="line">  ],</div><div class="line"></div><div class="line">  <span class="comment">// 出口</span></div><div class="line">  output: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname + <span class="string">'/prd'</span>,</div><div class="line">    <span class="comment">// filename: '[name]-[hash].js'</span></div><div class="line">    filename: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// sourcemap</span></div><div class="line">  devtool: <span class="string">'source-map'</span>,</div><div class="line"></div><div class="line">  <span class="comment">// 配置模块</span></div><div class="line">  <span class="built_in">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modues/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.jsx$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modues/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'style!css'</span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</div><div class="line">        <span class="attr">loader</span>: ET.extract(<span class="string">'style'</span>, <span class="string">'css!sass'</span>)</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">//plugins定义</span></div><div class="line">  plugins: [</div><div class="line">    <span class="comment">// new webpack.optimize.UglifyJsPlugin(),</span></div><div class="line">    <span class="keyword">new</span> ET(<span class="string">'bundle.css'</span>, &#123;</div><div class="line">      <span class="attr">allChunks</span>: <span class="literal">true</span></div><div class="line">    &#125;),</div><div class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>另外除了<strong>webpack.config.js</strong>文件的配置外，在react的入口文件（或者说使用react-dom的文件中）添加三行语句：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'../styles/usage/page/app.scss'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> MyButtonController <span class="keyword">from</span> <span class="string">'./flux/components/MyButtonController.jsx'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> app = <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">MyButtonController</span> /&gt;</span></span></div><div class="line">  , app);</div><div class="line"></div><div class="line">//热更新三行语句</div><div class="line">if (module.hot) &#123;</div><div class="line">  module.hot.accept();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这样就可以开发react时使用热更新了。</p>
<h1 id="常用插件和loader"><a href="#常用插件和loader" class="headerlink" title="常用插件和loader"></a>常用插件和loader</h1><p>css-loader: css文件加载<br>sass-loader: scss文件加载<br>less-loader: less文件加载<br>extract-text-webpack-plgin: css文件抽离插件</p>
<p>html-loader: html文件加载<br>html-webpack-plugin: 创建默认html文件插件</p>
<p>js-loader: js文件加载<br>string-loader: string文件加载<br>url-loader: 图片加载打包<br>vue-loader: vue文件加载<br>jsx-loader: jsx文件加载/js文件也可以<br>react-hot-loader: react热更新</p>
<p>open-browser-webpack-plgin: 自动打开浏览器插件<br>copy-webpack-plgin: 文件复制插件<br>webpack-dev-server: 本地server服务</p>
<p>更多loader请参照<a href="http://webpack.github.io/docs/list-of-loaders.html" target="_blank" rel="external">官方文档</a></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>以后就可以不用翻老项目找配置文件了。。。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;webpack作为模块打包机，在前端模块化开发中频繁的被使用。本篇主要记录一些我自己在学习和使用webpack中遇到问题，保存的一些比较好的博客文章和自己项目的webpack的配置文档，方便以后项目中使用时参考，不用每次都去翻老项目看webpack配置，有些第三方loader和插件的配置或者名称有时就是想不起来（看来老了呀）。&lt;/p&gt;
&lt;p&gt;如果想学习webpack的相关内容可以从下面第一小节&lt;strong&gt;关于webpack的一些资源bolg&lt;/strong&gt;中查看一些网上的教程，如果你对gulp和webpack有疑问，想了解他们的区别也可以看一下这篇&lt;a href=&quot;http://chping.website/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/&quot;&gt;Gulp和Webpack对比&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="工具" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="Webpack" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/Webpack/"/>
    
    
      <category term="Webpack" scheme="https://chping2125.github.io/tags/Webpack/"/>
    
  </entry>
  
  <entry>
    <title>CSS居中实例--大小不固定的图片居中</title>
    <link href="https://chping2125.github.io/2016/11/09/CSS%E5%B1%85%E4%B8%AD%E5%AE%9E%E4%BE%8B/"/>
    <id>https://chping2125.github.io/2016/11/09/CSS居中实例/</id>
    <published>2016-11-08T16:25:35.000Z</published>
    <updated>2016-11-09T13:59:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>上一篇<a href="/2016/11/08/%E5%B1%85%E4%B8%AD%E9%97%AE%E9%A2%98%E6%8E%A2%E7%B4%A2/">CSS居中问题探索</a>中，通过实例的方式展示了一下<code>text-align:center</code>、<code>margin:0 auto;</code>、<code>line-height: boxHeight</code>、<code>position和margin或者transform配合使用</code>还有<code>display:table-cell</code>来实现水平居中或者垂直居中的方式方法，本篇主要补充三个垂直水平居中的实例，或者更直接的说是<strong>大小不固定的图片垂直水平居中实现</strong>的两种方式和<strong>多行文本的垂直居中的方法</strong>。</p>
<p>相对于实现水平居中，垂直居中比较麻烦，所以接下来的以垂直居中为重点，水平居中，可以在代码中自己看看实现。<br><a id="more"></a></p>
<h1 id="大小不固定的图片垂直水平居中"><a href="#大小不固定的图片垂直水平居中" class="headerlink" title="大小不固定的图片垂直水平居中"></a>大小不固定的图片垂直水平居中</h1><p>在商品展示性的网站，特别是电商网站，这种需求特别多，比如：<br><img src="/images/cssCenter/26.png" alt="京东商品展示图片"><br>从上图可以看出，这些商品的大小是不固定的，所以要求所有图片都要垂直水平居中，这时候我们的需求就来了（PS:其实京东这些图片都是固定大小的，嘿嘿）。</p>
<h2 id="利用table-cell实现垂直居中"><a href="#利用table-cell实现垂直居中" class="headerlink" title="利用table-cell实现垂直居中"></a>利用table-cell实现垂直居中</h2><p><img src="/images/cssCenter/27.png" alt="利用table-cell实现垂直居中"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></div><div class="line">    [站外图片上传中……(5)]</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span>&#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.box1</span>&#123;</div><div class="line">  <span class="attribute">text-align</span>:center;</div><div class="line">  <span class="attribute">display</span>: table-cell;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">  <span class="comment">/* font-size: 118px; */</span></div><div class="line">&#125;</div><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>利用父元素为<code>display:table-cell</code>类型实现垂直居中，table在ie8+的浏览器中自带的垂直居中的属性。</strong></p>
<p>注意：<code>img{vertical-align: middle;}</code>只是为了消除<code>display:inline-block</code>类型的基线对齐问题。</p>
<h2 id="利用添加兄弟元素实现垂直居中"><a href="#利用添加兄弟元素实现垂直居中" class="headerlink" title="利用添加兄弟元素实现垂直居中"></a>利用添加兄弟元素实现垂直居中</h2><p><img src="/images/cssCenter/28.png" alt="利用添加兄弟元素实现垂直居中"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">    [站外图片上传中……(6)]</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span>&#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.box2</span>&#123;</div><div class="line">  <span class="attribute">text-align</span>:center;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">i</span>&#123;</div><div class="line">  <span class="attribute">display</span>: inline-block;</div><div class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>利用给img添加兄弟元素，重新设置基线的位置。</strong></p>
<h1 id="多行文本的垂直居中方法"><a href="#多行文本的垂直居中方法" class="headerlink" title="多行文本的垂直居中方法"></a>多行文本的垂直居中方法</h1><p>有时可能我们会遇到需要多行文本垂直居中的一些情况，但是做起来有时有些麻烦，需要我们换个思路去实现。</p>
<p><img src="/images/cssCenter/29.png" alt="多行文本的垂直居中"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box3"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据你好，我是测试数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span>&#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</div><div class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.box3</span>&#123;</div><div class="line">  <span class="attribute">display</span>: table-cell;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">span</span>&#123;</div><div class="line">  <span class="attribute">display</span>: inline-block;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>将内部的文本用span标签（其他标签也可以）包裹起来，把span标签设为inline-block,然后当图片的垂直居中处理(ie8+)。</strong></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本文也是从以前的学习笔记中翻出来整理的一个css基础小点， 在这里记录一下，免得每次遇到问题总是翻笔记。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;上一篇&lt;a href=&quot;/2016/11/08/%E5%B1%85%E4%B8%AD%E9%97%AE%E9%A2%98%E6%8E%A2%E7%B4%A2/&quot;&gt;CSS居中问题探索&lt;/a&gt;中，通过实例的方式展示了一下&lt;code&gt;text-align:center&lt;/code&gt;、&lt;code&gt;margin:0 auto;&lt;/code&gt;、&lt;code&gt;line-height: boxHeight&lt;/code&gt;、&lt;code&gt;position和margin或者transform配合使用&lt;/code&gt;还有&lt;code&gt;display:table-cell&lt;/code&gt;来实现水平居中或者垂直居中的方式方法，本篇主要补充三个垂直水平居中的实例，或者更直接的说是&lt;strong&gt;大小不固定的图片垂直水平居中实现&lt;/strong&gt;的两种方式和&lt;strong&gt;多行文本的垂直居中的方法&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;相对于实现水平居中，垂直居中比较麻烦，所以接下来的以垂直居中为重点，水平居中，可以在代码中自己看看实现。&lt;br&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="CSS" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/CSS/"/>
    
    
      <category term="CSS" scheme="https://chping2125.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>CSS居中问题探索</title>
    <link href="https://chping2125.github.io/2016/11/08/%E5%B1%85%E4%B8%AD%E9%97%AE%E9%A2%98%E6%8E%A2%E7%B4%A2/"/>
    <id>https://chping2125.github.io/2016/11/08/居中问题探索/</id>
    <published>2016-11-08T15:25:35.000Z</published>
    <updated>2016-11-09T13:59:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>在页面布局中，居中在各种各样的场景中广泛被用到，也经常被新人提及。以前做过一些自己探索居中问题的demo，今天翻出来了，正好做一下笔记，记录一下。以后遇到问题也能快速方便快速找到。</p>
<p>居中包括<strong>水平居中</strong>和<strong>垂直居中</strong>两种，其中水平居中相对来说容易解决，但是垂直居中有时就令人头疼了，其实也不是很难。各自都有很多方式来实现，本文主要是总结一下自己以前的demo，并不代表主流方式。另外先打个预防针，下面的例子很丑，以前做的，勿喷。<br><a id="more"></a></p>
<h1 id="水平居中"><a href="#水平居中" class="headerlink" title="水平居中"></a>水平居中</h1><p>说到水平居中，你可能立马想到的是<code>text-align:center;</code>或者<code>margin:0 auto;</code>这是最简单的水平居中方式，也是使用很广泛的水平居中方法。我们来探索一下，他俩居中能力到底有多强？</p>
<h2 id="text-align-center水平居中"><a href="#text-align-center水平居中" class="headerlink" title="text-align:center水平居中"></a>text-align:center水平居中</h2><ol>
<li>对直接文本子元素进行居中<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:200px;height:100px;background:#555;text-align:center"</span>&gt;</div><div class="line">      利用text-align对本元素文字水平对齐</div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/1.png" alt="利用text-align对本元素文字水平对齐"></p>
<ol>
<li>对子div元素水平对齐<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:300px;height:300px;background:#555;text-align:center"</span>&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:200px;height:100px;border:1px dotted blue;background:#f00;"</span>&gt;</span></span></div><div class="line">        利用text-align对子div元素水平对齐</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/2.png" alt="利用text-align对子div元素水平对齐"></p>
<ol>
<li>对子span元素水平对齐<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:300px;height:300px;background:#555;text-align:center"</span>&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"background:#f00;"</span>&gt;</span></span></div><div class="line">	  利用text-align对子span元素水平对齐</div><div class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/3.png" alt="利用text-align对子span元素水平对齐"></p>
<ol>
<li>对设置了inline的div元素水平对齐<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:300px;height:300px;background:#555;text-align:center"</span>&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display:inline;width:200px;height:100px;border:1px dotted blue;background:#f00;"</span>&gt;</span></span></div><div class="line">	  设置了inline的div元素水平对齐</div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/4.png" alt="设置了inline的div元素水平对齐"></p>
<ol>
<li>对设置了inline-block的div元素水平对齐<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:300px;height:300px;background:#555;text-align:center"</span>&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display:inline;width:200px;height:100px;border:1px dotted blue;background:#f00;"</span>&gt;</span></span></div><div class="line">	  设置了inline-block的div元素水平对齐</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/5.png" alt="设置了inline-block的div元素水平对齐"></p>
<p><strong>小结</strong><br><strong>text-align:center</strong>具有继承性，可以使文本元素以及子元素的文本水平居中，也可以使行内元素（或者设置了display:inline/inline-block属性的块状元素）水平居中，但不能使块状元素居中。</p>
<h2 id="margin-0-auto水平居中"><a href="#margin-0-auto水平居中" class="headerlink" title="margin:0 auto水平居中"></a>margin:0 auto水平居中</h2><ol>
<li>对直接子元素进行水平居中<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:200px;height:100px;background:#555;margin: 0 auto;&quot;&gt;</div><div class="line">	  利用margin:0 auto对文字水平对齐</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/6.png" alt="利用margin:0 auto对文字水平对齐"></p>
<ol>
<li>对自身div元素水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:300px;height:300px;background:#555;&quot;&gt;</div><div class="line">      &lt;div style=&quot;width:200px;height:100px;border:1px dotted blue;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">		利用margin:0 auto对自身div元素水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/7.png" alt="利用margin:0 auto对自身div元素水平对齐"></p>
<ol>
<li>对自身div元素水平对齐,自身元素文本宽度未知<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:300px;height:300px;background:#555;&quot;&gt;</div><div class="line">      &lt;div style=&quot;height:100px;border:1px dotted blue;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">	    利用margin:0 auto对自身div元素水平对齐,自身元素文本宽度未知</div><div class="line">	&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/8.png" alt="对自身div元素水平对齐,自身元素文本宽度未知"></p>
<ol>
<li>对自身span元素水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:300px;height:300px;background:#555;&quot;&gt;</div><div class="line">    &lt;span style=&quot;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">	  对自身span元素水平对齐</div><div class="line">    &lt;/span&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/9.png" alt="利用margin:0 auto对自身span元素水平对齐"></p>
<ol>
<li>对设置了block的span元素水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:300px;height:300px;background:#555;&quot;&gt;</div><div class="line">    &lt;span style=&quot;width:200px;height:100px;display:block;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">	  设置了block的span元素水平对齐</div><div class="line">    &lt;/span&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/10.png" alt="利用margin:0 auto对设置了block的span元素水平对齐"></p>
<ol>
<li>对设置inline的div元素水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:300px;height:300px;background:#555;&quot;&gt;</div><div class="line">    &lt;div style=&quot;display:inline;height:100px;border:1px dotted blue;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">	  设置inline的div元素水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/11.png" alt="利用margin:0 auto对设置inline的div元素水平对齐"></p>
<ol>
<li>对设置inline-block的div元素水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:500px;height:300px;background:#555;&quot;&gt;</div><div class="line">    &lt;div style=&quot;display:inline;height:100px;border:1px dotted blue;background:#f00;margin: 0 auto;&quot;&gt;</div><div class="line">		设置inline-block的div元素水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/12.png" alt="利用margin:0 auto对设置inline-block的div元素水平对齐"></p>
<p><strong>小结</strong></p>
<p><strong>margin:0 auto;</strong>没有继承性，只能使已知宽度的块状元素水平居中，且该块状元素为其本身。</p>
<p>除了以上<code>margin:0 auto;</code>水平居中方式之外还有可以使用postion配合margin或者transform来实现块状盒子水平居中的目的。</p>
<h2 id="position配合margin或者transform水平居中"><a href="#position配合margin或者transform水平居中" class="headerlink" title="position配合margin或者transform水平居中"></a>position配合margin或者transform水平居中</h2><ol>
<li>对已知宽度的div元素盒子水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">      &lt;div style=&quot;width:100px;height:100px;background:#f00;position:absolute;left:300px;margin-left:-50px&quot;&gt;</div><div class="line">		对已知宽度的div元素盒子水平对齐</div><div class="line">      &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/13.png" alt="对已知宽度的div元素盒子水平对齐"></p>
<ol>
<li>对未知宽度的div元素盒子水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">    &lt;div style=&quot;background:#f00;position:absolute;left:300px;transform: translate(-50%,0);&quot;&gt;</div><div class="line">	  对未知宽度的div元素盒子水平对齐</div><div class="line">     &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/14.png" alt="对未知宽度的div元素盒子水平对齐"></p>
<p><strong>小节</strong><br>这种方式的水平居中，既可以是父元素<strong>已知宽度</strong>，也可以是父元素<strong>未知宽度</strong>，分别对应margin和transform。</p>
<h1 id="垂直居中"><a href="#垂直居中" class="headerlink" title="垂直居中"></a>垂直居中</h1><h2 id="line-height-垂直居中"><a href="#line-height-垂直居中" class="headerlink" title="line-height 垂直居中"></a>line-height 垂直居中</h2><p>垂直居中时间很麻烦的事情，我们知道可以使用<code>line-height=height</code>可以使单行文本在父元素内垂直居中，这个很容易实现。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div style=<span class="string">"width:500px;height:100px;background:#555;line-height:100px"</span>&gt;</div><div class="line">    利用line-height=height对单行文本在父元素内垂直居中</div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure></p>
<p><img src="/images/cssCenter/15.png" alt="利用line-height=height对单行文本在父元素内垂直居中"></p>
<p>那么<code>line-height=height;</code>能不能使其他元素水平居中呢？我们来试一试：</p>
<ol>
<li>对子div元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;line-height:300px&quot;&gt;</div><div class="line">    &lt;div style=&quot;width:500px;height:100px;background:#f00;&quot;&gt;</div><div class="line">	  利用line-height=height对div元素盒子垂直对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/16.png" alt=" 利用line-height=height对div元素盒子垂直对齐"></p>
<ol>
<li>对子span元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;line-height:300px&quot;&gt;</div><div class="line">    &lt;span style=&quot;background:#f00;&quot;&gt;</div><div class="line">	  利用line-height=height对子span元素盒子垂直对齐</div><div class="line">    &lt;/span&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/17.png" alt=" 利用line-height=height对子span元素盒子垂直对齐"></p>
<ol>
<li>设置了inline的div元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;line-height:300px&quot;&gt;</div><div class="line">    &lt;div style=&quot;background:#f00;display:inline&quot;&gt;</div><div class="line">        设置了inline的div元素盒子垂直对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/18.png" alt=" 利用line-height=height对设置了inline的div元素盒子垂直对齐"></p>
<ol>
<li>设置了inline-block的div元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;line-height:300px&quot;&gt;</div><div class="line">    &lt;div style=&quot;background:#f00;display:inline-block&quot;&gt;</div><div class="line">	  设置了inline-block的div元素盒子垂直对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/19.png" alt=" 利用line-height=height对设置了inline-block的div元素盒子垂直对齐"></p>
<p><strong>小结</strong><br><strong>line-weight:height</strong>具有继承性，可以使文本元素以及子元素的文本垂直居中，也可以使行内元素（或者设置了display:inline属性的块状元素）垂直居中，但不能使块状元素（或设置了display：inline-block属性的块状元素）居中。</p>
<h2 id="position配合margin或者transform"><a href="#position配合margin或者transform" class="headerlink" title="position配合margin或者transform"></a>position配合margin或者transform</h2><ol>
<li>对已知高度div元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">    &lt;div style=&quot;width:100px;height:100px;background:#f00;position:absolute;top:50%;margin-top:-50px&quot;&gt;</div><div class="line">		利用position对已知高度div元素盒子垂直对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/20.png" alt=" 利用position对已知高度div元素盒子垂直对齐"></p>
<ol>
<li>对未知高度span元素盒子垂直对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">    &lt;span style=&quot;background:#f00;position:absolute;top:50%;transform: translate(0,-50%);&quot;&gt;</div><div class="line">		利用position对未知高度span元素盒子垂直对齐</div><div class="line">    &lt;/span&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/21.png" alt=" 利用position对未知高度span元素盒子垂直对齐"></p>
<p><strong>小结</strong><br>同样，利用很牛X的position配合margin或者transform来使已知高度或者未知高度的元素进行垂直居中。</p>
<h1 id="垂直水平居中"><a href="#垂直水平居中" class="headerlink" title="垂直水平居中"></a>垂直水平居中</h1><p>垂直水平居中就是对上面两种居中方式的综合利用，不在解释，直接上例子：</p>
<ol>
<li>对已知宽高的div元素盒子垂直水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">	&lt;div style=&quot;width:100px;height:100px;background:#f00;position:absolute;left:50%;top:50%;margin-left:-50px;margin-top:-50px&quot;&gt;</div><div class="line">		利用position和margin对已知宽高的div元素盒子垂直水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/22.png" alt=" 对已知宽高的div元素盒子垂直水平对齐"></p>
<ol>
<li>对未知宽高div元素盒子垂直水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">    &lt;div style=&quot;background:#f00;position:absolute;left:50%;top:50%;transform: translate(-50%,-50%);&quot;&gt;</div><div class="line">		利用position和margin对未知宽高div元素盒子垂直水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/23.png" alt=" 对未知宽高div元素盒子垂直水平对齐"></p>
<ol>
<li>利用left:0;top:0;bottom:0;right:0;margin:auto对盒子垂直水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;position:relative&quot;&gt;</div><div class="line">    &lt;div style=&quot;width: 200px;height:100px;background:#f00;position:absolute;left:0;top:0;bottom:0;right:0;margin:auto&quot;&gt;</div><div class="line">        利用left:0;top:0;bottom:0;right:0;margin:auto对盒子垂直水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/24.png" alt=" 利用left:0;top:0;bottom:0;right:0;margin:auto对盒子垂直水平对齐"></p>
<ol>
<li>利用display:table-cell;vertical-align:middle;text-align:center;对inline-block盒子垂直水平对齐<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;width:600px;height:300px;background:#555;display:table-cell;vertical-align:middle;text-align:center&quot;&gt;</div><div class="line">    &lt;div style=&quot;width: 200px;height:100px;background:#f00;vertical-align:middle;display:inline-block&quot;&gt;</div><div class="line">		利用display:table-cell;vertical-align:middle;text-align:center;对inline-block盒子垂直水平对齐</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/images/cssCenter/25.png" alt=" 利用display:table-cell;vertical-align:middle;text-align:center;对inline-block盒子垂直水平对齐"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在页面布局中，居中在各种各样的场景中广泛被用到，也经常被新人提及。以前做过一些自己探索居中问题的demo，今天翻出来了，正好做一下笔记，记录一下。以后遇到问题也能快速方便快速找到。&lt;/p&gt;
&lt;p&gt;居中包括&lt;strong&gt;水平居中&lt;/strong&gt;和&lt;strong&gt;垂直居中&lt;/strong&gt;两种，其中水平居中相对来说容易解决，但是垂直居中有时就令人头疼了，其实也不是很难。各自都有很多方式来实现，本文主要是总结一下自己以前的demo，并不代表主流方式。另外先打个预防针，下面的例子很丑，以前做的，勿喷。&lt;br&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="CSS" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/CSS/"/>
    
    
      <category term="CSS" scheme="https://chping2125.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>变量声明提升</title>
    <link href="https://chping2125.github.io/2016/11/08/%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/"/>
    <id>https://chping2125.github.io/2016/11/08/变量声明提升/</id>
    <published>2016-11-08T13:29:32.000Z</published>
    <updated>2016-11-08T13:34:18.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>变量声明提升</strong>是JS中一个基础的问题，同时也是对JS词法作用域认识的一个提升。在JS面试题中，关于<strong>变量声明提升</strong>的问题还是占了不少比例的，另外，在码代码的时候可能也无意间因为这个原因产生错误而头疼好久。还有一个需要注意的是ES2015中let、const声明的变量<strong>不具备</strong>变量声明提升。</p>
<p>在《你不知道的JavaSript》上卷中，作者把<strong>变量声明提升</strong>这个问题比作“先有鸡还是先有蛋?”，我认为很形象。代码在执行的时候给人的感觉是一行一行的执行，这样可能比较符合我们的正常思维习惯，但是这实际上并不完全正确。为什么这样说呢？这就要引出JS在运行前其实有一个编译过程的这个问题，在编译阶段，JS引擎做了一些事使得代码并不是完全一行一行的执行了，而是将一些声明的代码顺序提前了，所以就产生了变量声明提升这个问题。<br><a id="more"></a></p>
<h1 id="编译原理"><a href="#编译原理" class="headerlink" title="编译原理"></a>编译原理</h1><p>想明白变量声明提升这个概念，JS编译原理必须清楚。<br>有些小伙伴认为JS不是一门编译动态脚本语言吗？怎么会有编译过程，其实在没有接触《你不知道的JavaSript》上卷这本书之前我也这么认为，直到读了这本书我才对JS的作用域和变量声明提升以及闭包等问题有了更清楚的认识，所以这里先向小伙伴们推荐一下这本书。</p>
<p>言归正传，接着说JS编译，JS的编译过程不是像其他语言的编译过程一样发生在构建之前的，大部分是在代码执行之前的几微米（甚至更短！）的时间内，那么这段时间内，编译器对我们的代码做了什么呢？我们通过一个例子来说明一下，比如<code>var a =2;</code>这条语句在会被JS引擎看成是两部分，分别为<code>var a;</code>和<code>a = 2</code>。其中前一部分是发生在编译过程中，而第二部分发生在执行过程中。也就是说，编译的时候，JS引擎把我们对a的声明已经提前了。</p>
<p>为了更好地说明编译器的编译过程，我在举一个例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">foo(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(a);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面这段代码在执行的时候，JS引擎的工作过程是：</p>
<ol>
<li>在编译阶段，首先遇到<code>foo(2);</code>一看这是个函数执行呀，这并不是我编译器的活呀，于是直接无视略过。</li>
<li>然后继续向下走，发现<code>function</code>，很明显是要声明一个函数（ES2015之前，声明变量只有var 和 function 这两个关键字，前者用于声明普通变量，后者用于声明函数或者方法），所以，JS引擎就会在当前作用域内的内存中开辟一块空间给<code>foo</code>；然后编译继续进行，这时候该对foo函数内部进行编译（从上到下一行一行编译），所以遇到形参a后，就在foo作用域的内存中为a开辟了一块空间，只不过此时a没有值，所以存的是undefined，继续向下走，没了—–结束。</li>
<li>现在开始执行阶段，首先遇到了<code>foo(2)；</code>，开始干活:<br><strong>引擎：作用域，你见过<code>foo</code>没？<br>作用域：见过，刚才编译器那小子刚声明了他，我给你。<br>引擎：好的。那我来执行以下foo这个函数。<br>引擎：作用域兄弟，你在foo中见过a吗？<br>作用域：有，编译器也声明他了，给你。<br>引擎：谢了哥们，我把2复制给他。</strong><br>…..</li>
</ol>
<p>我发现虽然是简单描述了一下JS引擎的编译过程，好像已经莫名其妙的把变量声明提升给讲完了（尴尬。。。）。</p>
<h1 id="变量声明提升"><a href="#变量声明提升" class="headerlink" title="变量声明提升"></a>变量声明提升</h1><p>本文是用来记录变量声明提升的，结果在第一小节就通过JS引擎的编译过程就给讲完了。。。。。。</p>
<p>那这一小节就在再总结一下，顺便说一下<strong>函数优先</strong>吧！</p>
<h2 id="变量声明提升的原因"><a href="#变量声明提升的原因" class="headerlink" title="变量声明提升的原因"></a>变量声明提升的原因</h2><ol>
<li>JS代码在执行之前有一个极其短的编译过程。</li>
<li>在这个过程中，JS引擎为var、function声明的变量和函数在当前作用域中分配内存空间。函数内的变量和嵌套函数也是一样，只不过分配的内存是其父函数作用域内的。</li>
<li>JS引擎在执行的时候，通过询问作用域来查找有无该变量或者函数，然后执行相关赋值或者函数执行等操作。</li>
</ol>
<h2 id="函数优先"><a href="#函数优先" class="headerlink" title="函数优先"></a>函数优先</h2><p>相信已经说清楚变量声明提升的原因了，但是还要注意一点就是，在编译过程中，如果var和function声明的变量为同一个，则function声明的优先级高于var声明的。来看一个例子吧！<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">foo();</div><div class="line"></div><div class="line"><span class="keyword">var</span> foo;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面代码最终输出结果是1，你猜对了吗？上面的编译执行过程为：</p>
<ol>
<li>编译阶段，从上往下编译，首先遇到<code>foo();</code>，直接无视略过。</li>
<li>遇到<code>var foo;</code>，在当前作用域内为foo分配内存空间，继续向下编译。</li>
<li>遇到<code>function foo(){....}</code>，发现已经在当前作用域中声明了该变量，但是此时是<code>function</code>，优先级明显高于<code>var</code>,所以当前作用域中的<code>foo</code>变为function。</li>
<li>继续向下编译，发现<code>foo=....</code>很明显是个赋值操作吗，这是引擎的事，无视。</li>
<li>执行阶段，首先就遇到了<code>foo();</code>，于是询问当前作用域内有无foo的声明，发现有，还正好是个函数，那就别废话了，直接执行吧！于是控制台打印了1。</li>
<li>继续向下执行，略过<code>var foo;</code>和<code>function foo(){....}</code>，遇到一个复制操作，那就先在问问当前作用域有没有foo变量，有就赋值，没有就在全局中声明一个foo变量（非严格模式下）；</li>
<li>好了，到此结束。</li>
</ol>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>变量声明是一个很基础的JS知识点，但如果没有编译这一步，可能理解上不好理解，但是有了编译这个过程后，相信就很容易了。最后留下一道题，检验一下自己：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">a.param = <span class="number">123</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo.get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">foo.prototype.get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo.get();</div><div class="line">get();</div><div class="line">foo().get();</div><div class="line">get();</div><div class="line"><span class="keyword">new</span> foo.get();</div><div class="line"><span class="keyword">new</span> foo().get();</div><div class="line"><span class="keyword">new</span> <span class="keyword">new</span> foo().get();</div></pre></td></tr></table></figure></p>
<p>很经典的一道考察变量声明提升和原型链，还有操作符优先级的题。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;变量声明提升&lt;/strong&gt;是JS中一个基础的问题，同时也是对JS词法作用域认识的一个提升。在JS面试题中，关于&lt;strong&gt;变量声明提升&lt;/strong&gt;的问题还是占了不少比例的，另外，在码代码的时候可能也无意间因为这个原因产生错误而头疼好久。还有一个需要注意的是ES2015中let、const声明的变量&lt;strong&gt;不具备&lt;/strong&gt;变量声明提升。&lt;/p&gt;
&lt;p&gt;在《你不知道的JavaSript》上卷中，作者把&lt;strong&gt;变量声明提升&lt;/strong&gt;这个问题比作“先有鸡还是先有蛋?”，我认为很形象。代码在执行的时候给人的感觉是一行一行的执行，这样可能比较符合我们的正常思维习惯，但是这实际上并不完全正确。为什么这样说呢？这就要引出JS在运行前其实有一个编译过程的这个问题，在编译阶段，JS引擎做了一些事使得代码并不是完全一行一行的执行了，而是将一些声明的代码顺序提前了，所以就产生了变量声明提升这个问题。&lt;br&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="JavaScript" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/JavaScript/"/>
    
    
      <category term="JavaScript基础" scheme="https://chping2125.github.io/tags/JavaScript%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>认识一下Fetch</title>
    <link href="https://chping2125.github.io/2016/11/07/%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8BFetch/"/>
    <id>https://chping2125.github.io/2016/11/07/认识一下Fetch/</id>
    <published>2016-11-07T10:03:41.000Z</published>
    <updated>2016-11-08T13:34:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>以前听说过<a href="https://github.com/github/fetch" target="_blank" rel="external">fetch</a>，一只以为他是对XHR的一种升级的API，今天去充了充电，看了几篇bolg后，才发现以前的理解是打错特错。所以转载一篇csdn上看到关于<a href="https://github.com/github/fetch" target="_blank" rel="external">fetch</a>的简介，做点自己的补充，记录下来。</p>
<p>AJAX半遮半掩的底层API是饱受诟病的一件事情. XMLHttpRequest 并不是专为Ajax而设计的. 虽然各种框架对 XHR 的封装已经足够好用, 但我们可以做得更好。更好用的API是 <a href="https://github.com/github/fetch" target="_blank" rel="external">fetch</a> 。下面简单介绍 window.fetch 方法, 在最新版的 Firefox 和 Chrome 中已经提供支持。</p>
<a id="more"></a>
<blockquote>
<p>原文翻译链接：<a href="http://blog.csdn.net/renfufei/article/details/51494396" target="_blank" rel="external">http://blog.csdn.net/renfufei/article/details/51494396</a><br>原文英文链接：<a href="blog.csdn.net/renfufei/article/details/51494396">blog.csdn.net/renfufei/article/details/51494396</a></p>
</blockquote>
<h1 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest"></a>XMLHttpRequest</h1><p>在我看来 XHR 有点复杂, 我不想解释为什么“XML”是大写,而“Http”是“骆峰式”写法。使用XHR的方式大致如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 获取 XHR 非常混乱!</span></div><div class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123; <span class="comment">// Mozilla, Safari, ...</span></div><div class="line">  request = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123; <span class="comment">// IE</span></div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    request = <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>);</div><div class="line">  &#125; </div><div class="line">  <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      request = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>);</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">catch</span> (e) &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 打开连接, 发送数据.</span></div><div class="line">request.open(<span class="string">'GET'</span>, <span class="string">'https://davidwalsh.name/ajax-endpoint'</span>, <span class="literal">true</span>);</div><div class="line">request.send(<span class="literal">null</span>);</div></pre></td></tr></table></figure>
<p>我们可以看出, XHR 其实是很杂乱的; 当然, 通过 JavaScript 框架可以很方便地使用XHR。</p>
<h1 id="fetch-的基本使用"><a href="#fetch-的基本使用" class="headerlink" title="fetch 的基本使用"></a>fetch 的基本使用</h1><p><a href="https://github.com/github/fetch" target="_blank" rel="external">fetch</a> 是全局量 window 的一个方法, 第一个参数是URL:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// url (必须), options (可选)</span></div><div class="line">fetch(<span class="string">'/some/url'</span>, &#123;</div><div class="line">    <span class="attr">method</span>: <span class="string">'get'</span></div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="comment">// 出错了;等价于 then 的第二个参数,但这样更好用更直观</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>和 Battery API 类似, fetch API 也使用了 <a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="external">JavaScript Promises</a> 来处理结果/回调:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 对响应的简单处理</span></div><div class="line">fetch(<span class="string">'/some/url'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="comment">// 出错了;等价于 then 的第二个参数,但这样更直观 :(</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 链式处理,将异步变为类似单线程的写法: 高级用法.</span></div><div class="line">fetch(<span class="string">'/some/url'</span>).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="comment">//... 执行成功, 第1步...</span></div><div class="line">&#125;).then(<span class="function"><span class="params">returnedValue</span>=&gt;</span> &#123;</div><div class="line">    <span class="comment">// ... 执行成功, 第2步...</span></div><div class="line">&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span> &#123;</div><div class="line">    <span class="comment">// 中途任何地方出错...在此处理 </span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>如果你还不习惯 then 方式的写法,那最好学习一下,因为很快就会全面流行。</p>
<h1 id="请求头-Headers-对象"><a href="#请求头-Headers-对象" class="headerlink" title="请求头(Headers 对象)"></a>请求头(Headers 对象)</h1><p>自定义请求头信息极大地增强了请求的灵活性。我们可以通过fetch为我们提供的 new Headers() 来创建请求头:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建一个空的 Headers 对象,**注意是Headers**，不是Header</span></div><div class="line"><span class="keyword">var</span> headers = <span class="keyword">new</span> Headers();</div><div class="line"></div><div class="line"><span class="comment">// 添加(append)请求头信息</span></div><div class="line">headers.append(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>);</div><div class="line">headers.append(<span class="string">'X-My-Custom-Header'</span>, <span class="string">'CustomValue'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 判断(has), 获取(get), 以及修改(set)请求头的值</span></div><div class="line">headers.has(<span class="string">'Content-Type'</span>); <span class="comment">// true</span></div><div class="line">headers.get(<span class="string">'Content-Type'</span>); <span class="comment">// "text/plain"</span></div><div class="line">headers.set(<span class="string">'Content-Type'</span>, <span class="string">'application/json'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 删除某条请求头信息(a header)</span></div><div class="line">headers.delete(<span class="string">'X-My-Custom-Header'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建对象时设置初始化信息</span></div><div class="line"><span class="keyword">var</span> headers = <span class="keyword">new</span> Headers(&#123;</div><div class="line">    <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>,</div><div class="line">    <span class="string">'X-My-Custom-Header'</span>: <span class="string">'CustomValue'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>可以使用Headers对象为我们提供的方法包括: <strong><code>append</code>, <code>get</code>,<code>getAll</code>, <code>set</code>, <code>has</code>,<code>forEach</code>,<code>keys</code>,<code>values</code>,  以及 <code>delete</code> </strong>来操作Headers对象。</p>
<p>接下来需要创建一个 Request 对象来包装请求头:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> request = <span class="keyword">new</span> Request(<span class="string">'/some-url'</span>, &#123;</div><div class="line">    <span class="attr">headers</span>: <span class="keyword">new</span> Headers(&#123;</div><div class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span></div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line"></div><div class="line">fetch(request).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* handle response */</span> &#125;);</div></pre></td></tr></table></figure></p>
<p>下面介绍 Response 和Request 的使用方法!</p>
<h1 id="Request-对象简介"><a href="#Request-对象简介" class="headerlink" title="Request 对象简介"></a>Request 对象简介</h1><p>Request 对象表示一次 fetch 调用的请求信息。传入 Request 参数来调用 fetch, 可以执行很多自定义请求的高级用法:</p>
<blockquote>
<p>method - 支持 GET, POST, PUT, DELETE, HEAD<br>url - 请求的 URL<br>headers - 对应的 Headers 对象<br>referrer - 请求的 referrer 信息<br>mode - 可以设置 cors, no-cors, same-origin<br>credentials - 设置 cookies 是否随请求一起发送。可以设置: omit, same-origin<br>redirect - follow, error, manual<br>integrity - subresource 完整性值(integrity value)<br>cache - 设置 cache 模式 (default, reload, no-cache)</p>
</blockquote>
<p>Request 的示例如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> request = <span class="keyword">new</span> Request(<span class="string">'/users.json'</span>, &#123;</div><div class="line">    <span class="attr">method</span>: <span class="string">'POST'</span>, </div><div class="line">    <span class="attr">mode</span>: <span class="string">'cors'</span>, </div><div class="line">    <span class="attr">redirect</span>: <span class="string">'follow'</span>,</div><div class="line">    <span class="attr">headers</span>: <span class="keyword">new</span> Headers(&#123;</div><div class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span></div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 使用!</span></div><div class="line">fetch(request).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* handle response */</span> &#125;);</div></pre></td></tr></table></figure>
<p>只有第一个参数 <strong>URL 是必需的</strong>。在 Request 对象创建完成之后, 所有的属性都变为<strong>只读属性</strong>。请注意, Request 有一个很重要的 <code>clone 方法</code>, 特别是在 Service Worker API 中使用时 —— 一个 Request 就代表一串流(stream), 如果想要传递给另一个 fetch 方法,则需要进行克隆。</p>
<p>fetch 的方法签名(signature,可理解为配置参数), 和 Request 很像, 示例如下:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fetch(<span class="string">'/users.json'</span>, &#123;</div><div class="line">    <span class="attr">method</span>: <span class="string">'POST'</span>, </div><div class="line">    <span class="attr">mode</span>: <span class="string">'cors'</span>, </div><div class="line">    <span class="attr">redirect</span>: <span class="string">'follow'</span>,</div><div class="line">    <span class="attr">headers</span>: <span class="keyword">new</span> Headers(&#123;</div><div class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span></div><div class="line">    &#125;)</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* handle response */</span> &#125;);</div></pre></td></tr></table></figure></p>
<p>因为 Request 和 fetch 的签名一致, 所以在 Service Workers 中, 你可能会更喜欢使用 Request 对象。</p>
<h1 id="Response-简介"><a href="#Response-简介" class="headerlink" title="Response 简介"></a>Response 简介</h1><p>Response 代表响应, fetch 的 then 方法接收一个 Response 实例, 当然你也可以手动创建 Response 对象 —— 比如在 service workers 中可能会用到. Response 可以配置的参数包括:</p>
<blockquote>
<p>type - 类型,支持: basic, cors<br>url<br>useFinalURL - Boolean 值, 代表 url 是否是最终 URL<br>status - 状态码 (例如: 200, 404, 等等)<br>ok - Boolean值,代表成功响应(status 值在 200-299 之间)<br>statusText - 状态值(例如: OK)<br>headers - 与响应相关联的 Headers 对象.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 在 service worker 测试中手动创建 response</span></div><div class="line"><span class="comment">// new Response(BODY, OPTIONS)</span></div><div class="line"><span class="keyword">var</span> response = <span class="keyword">new</span> Response(<span class="string">'.....'</span>, &#123;</div><div class="line">    <span class="attr">ok</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">status</span>: <span class="number">404</span>,</div><div class="line">    <span class="attr">url</span>: <span class="string">'/'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// fetch 的 `then` 会传入一个 Response 对象</span></div><div class="line">fetch(<span class="string">'/'</span>)</div><div class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">responseObj</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'status: '</span>, responseObj.status);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>Response 提供的方法如下:</p>
<blockquote>
<p>clone() - 创建一个新的 Response 克隆对象.<br>error() - 返回一个新的,与网络错误相关的 Response 对象.<br>redirect() - 重定向,使用新的 URL 创建新的 response 对象..<br>arrayBuffer() - Returns a promise that resolves with an ArrayBuffer.<br>blob() - 返回一个 promise, resolves 是一个 Blob.<br>formData() - 返回一个 promise, resolves 是一个 FormData 对象.<br>json() - 返回一个 promise, resolves 是一个 JSON 对象.<br>text() - 返回一个 promise, resolves 是一个 USVString (text).</p>
</blockquote>
<h2 id="处理-JSON响应"><a href="#处理-JSON响应" class="headerlink" title="处理 JSON响应"></a>处理 JSON响应</h2><p>假设需要请求 JSON —— 回调结果对象 response 中有一个json()方法,用来将原始数据转换成 JavaScript 对象:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fetch(<span class="string">'https://davidwalsh.name/demo/arsenal.json'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123; </div><div class="line">    <span class="comment">// 转换为 JSON</span></div><div class="line">    <span class="keyword">return</span> response.json();</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">j</span>) </span>&#123;</div><div class="line">    <span class="comment">// 现在, `j` 是一个 JavaScript object</span></div><div class="line">    <span class="built_in">console</span>.log(j); </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当然这很简单 , 只是封装了 JSON.parse(jsonString) 而已, 但 json 方法还是很方便的。</p>
<h2 id="处理基本的Text-HTML响应"><a href="#处理基本的Text-HTML响应" class="headerlink" title="处理基本的Text / HTML响应"></a>处理基本的Text / HTML响应</h2><p>JSON 并不总是理想的请求/响应数据格式, 那么我们看看如何处理 HTML或文本结果:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fetch(<span class="string">'/next/page'</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> response.text();</div><div class="line">  &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123; </div><div class="line">    <span class="comment">// &lt;!DOCTYPE ....</span></div><div class="line">    <span class="built_in">console</span>.log(text); </div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>如上面的代码所示, 可以在 Promise 链式的 then 方法中, 先返回 text() 结果 ,再获取 text 。</p>
<h2 id="处理Blob结果"><a href="#处理Blob结果" class="headerlink" title="处理Blob结果"></a>处理Blob结果</h2><p>如果你想通过 fetch 加载图像或者其他二进制数据, 则会略有不同:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fetch(<span class="string">'flowers.jpg'</span>)</div><div class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> response.blob();</div><div class="line">    &#125;)</div><div class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">imageBlob</span>) </span>&#123;</div><div class="line">      <span class="built_in">document</span>.querySelector(<span class="string">'img'</span>).src = URL.createObjectURL(imageBlob);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>响应 Body mixin 的 blob() 方法处理响应流(Response stream), 并且将其读完。</p>
<h2 id="提交表单数据-Posting-Form-Data"><a href="#提交表单数据-Posting-Form-Data" class="headerlink" title="提交表单数据(Posting Form Data)"></a>提交表单数据(Posting Form Data)</h2><p>另一种常用的 AJAX 调用是提交表单数据 —— 示例代码如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">fetch(<span class="string">'/submit'</span>, &#123;</div><div class="line">    <span class="attr">method</span>: <span class="string">'post'</span>,</div><div class="line">    <span class="attr">body</span>: <span class="keyword">new</span> FormData(<span class="built_in">document</span>.getElementById(<span class="string">'comment-form'</span>))<span class="comment">//FormData对象是XHR level2引入的用于处理表单数据的对象</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//提交 JSON 的示例如下:</span></div><div class="line">fetch(<span class="string">'/submit-json'</span>, &#123;</div><div class="line">    <span class="attr">method</span>: <span class="string">'post'</span>,</div><div class="line">    <span class="attr">body</span>: <span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">        <span class="attr">email</span>: <span class="built_in">document</span>.getElementById(<span class="string">'email'</span>).value</div><div class="line">        answer: <span class="built_in">document</span>.getElementById(<span class="string">'answer'</span>).value</div><div class="line">    &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>非常非常简单, 妈妈再也不用担心我的Ajax!</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>fetch 是个很实用的API , 当前还不允许取消请求, 这使得很多程序员暂时不会考虑它。</p>
<p>新的 fetch API 比起 XHR 更简单也更智能。毕竟,它就是专为AJAX而设计的, 具有后发优势。而我已经迫不及待地使用了, 即使现在兼容性还不是那么好!</p>
<blockquote>
<p>fetch官方标准规范：<a href="https://fetch.spec.whatwg.org/" target="_blank" rel="external">https://fetch.spec.whatwg.org/</a><br>fecth Github地址：<a href="https://github.com/github/fetch" target="_blank" rel="external">https://github.com/github/fetch</a><br>isomorphic-fetch Github地址：<a href="https://github.com/matthew-andrews/isomorphic-fetch" target="_blank" rel="external">https://github.com/matthew-andrews/isomorphic-fetch</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以前听说过&lt;a href=&quot;https://github.com/github/fetch&quot;&gt;fetch&lt;/a&gt;，一只以为他是对XHR的一种升级的API，今天去充了充电，看了几篇bolg后，才发现以前的理解是打错特错。所以转载一篇csdn上看到关于&lt;a href=&quot;https://github.com/github/fetch&quot;&gt;fetch&lt;/a&gt;的简介，做点自己的补充，记录下来。&lt;/p&gt;
&lt;p&gt;AJAX半遮半掩的底层API是饱受诟病的一件事情. XMLHttpRequest 并不是专为Ajax而设计的. 虽然各种框架对 XHR 的封装已经足够好用, 但我们可以做得更好。更好用的API是 &lt;a href=&quot;https://github.com/github/fetch&quot;&gt;fetch&lt;/a&gt; 。下面简单介绍 window.fetch 方法, 在最新版的 Firefox 和 Chrome 中已经提供支持。&lt;/p&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="ReactJs" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/ReactJs/"/>
    
    
      <category term="认识系列" scheme="https://chping2125.github.io/tags/%E8%AE%A4%E8%AF%86%E7%B3%BB%E5%88%97/"/>
    
      <category term="前端" scheme="https://chping2125.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>认识一下前后端联调</title>
    <link href="https://chping2125.github.io/2016/11/05/%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86/"/>
    <id>https://chping2125.github.io/2016/11/05/前后端联调的基本认识/</id>
    <published>2016-11-05T12:29:30.000Z</published>
    <updated>2016-11-05T12:40:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>昨天一个朋友遇到一个典型的前后端联调的问题，这个问题已经不是第一次有人遇到了，自己多少知道点，就索性写下来吧。</p>
<p>问题重现：</p>
<blockquote>
<p>小刘同学的项目采用的是前后端分离架构，现在前后端程序猿已经碰过面，协商好了一些前端需要的数据接口，于是前后端程序猿同时开工码代码。<br>这时候小刘同学某个页面需要后端数据，但是后端叔叔还没有将该数据的借口开发出来，此时小刘只能做假数据（专业点叫<strong>mock数据</strong>，^_^），但是小刘的ajax的借口写的是与后端叔叔商量好的绝对路径（域名+请求路径+请求参数，跨域问题已解决），因为这是以后真正的请求路径，所以小刘又不像先写本地相对路径，后期再来修改（万一后台叔叔开发的慢了，鬼知道有多少接口要修改呀）。于是他就迷茫了。。。</p>
</blockquote>
<p>仔细看看这其实就是前后端分离中的mock数据和联调的问题，就现在来说能解决的方式有很多种。先说mock数据，gulp，webpack，<a href="http://ued.qunar.com/fekit/" target="_blank" rel="external">fekit</a>（去哪儿网的一款前端自动化构建工具，据说历史比webpack和gulp都要久远）等等自动化构建工具都有mock数据的功能，这不是问题；再说绝对路径的问题，其实只需要做一个host的映射就行了。<br><a id="more"></a><br>进入正题，前后端联调。</p>
<h1 id="什么是前后联调"><a href="#什么是前后联调" class="headerlink" title="什么是前后联调"></a>什么是前后联调</h1><p>我的理解是<strong>前后端联调</strong>是一种<strong>真实业务数据</strong>和<strong>本地mock数据</strong>之间来回切换以达到前后端分离架构下的不同开发速度时数据交换的一种方式方法（有点绕）。</p>
<h1 id="为什么要前后端联调"><a href="#为什么要前后端联调" class="headerlink" title="为什么要前后端联调"></a>为什么要前后端联调</h1><p>前面解释前后端联调是可能有些绕，这里举例来说明一下。<br>回到上面小刘的问题，假设小刘现在ajax中的url写的是相对路径（如：./mock/user.json），小刘现在面临的是后端接口没有数据，需要本地mock数据，但是当后端接口开发完成，并且有了测试数据后，小刘是不是需要切换到后端数据呢？答案是肯定的，但是小刘需要在本地mock数据和后端接口数据之间来回切换，为什么呢？很明显吗，本地的mock数据是小刘自己写的，肯定符合前端需求，但是后端接口首先需要测试通不通？还需要测试数据格式对不对？有可能前两部都整好了，但是后端还没有填写足够的数据（比如，列表页，小刘想分页，后端叔叔就写了两条测试数据，你咋整？），所以呀，小刘需要根据后端叔叔对接口的调整不断的来回切换url，这样岂不是还在受后端的影响，还谈毛线前后端分离呀！</p>
<p>所以当我们在前后端分离架构中，<strong>不断来回切换本地mock数据和后端接口数据时</strong>就遇到了联调的问题。</p>
<h1 id="实现前后端联调"><a href="#实现前后端联调" class="headerlink" title="实现前后端联调"></a>实现前后端联调</h1><p>首先我们已经知道，在现在流行的<strong>“前后端完全分离”</strong>架构中，前后端联调是一个不可能避免的问题，就我目前对前后端联调的理解来说，我认为需要联调的有以下两个方面的资源：</p>
<ol>
<li><strong>css、js、图片等前端静态资源文件。</strong></li>
<li><strong>ajax获取的后端数据。</strong></li>
</ol>
<p>而前后端分离的架构的应用可能也分为两种情况：</p>
<ol>
<li><strong>前后端完全分离，前后端分别拥有自己的域名和服务器。</strong></li>
<li><strong>前后端开发分离，但是部署时是一个域名和一台服务器。</strong></li>
</ol>
<p>还有就是需要联调的场景也是两种情况：</p>
<ol>
<li><strong>开发阶段</strong></li>
<li><strong>调试阶段</strong></li>
</ol>
<p>针对以上2方面资源和2种应用情况还有2种场景（2到家了。。。），接下来我们看看怎样通过mock数据和host的映射来实现解决这些问题。</p>
<h2 id="先解释一下-‘222’"><a href="#先解释一下-‘222’" class="headerlink" title="先解释一下 ‘222’"></a>先解释一下 ‘222’</h2><h3 id="2种资源"><a href="#2种资源" class="headerlink" title="2种资源"></a>2种资源</h3><p>为什么我将资源分为两种呢？首先来看css、js文件和图片是通过link、scripts、img标签来引入的（样式中的图片也是一个道理）， 它们是不存在跨域问题的，你在哪里引入都无所谓。</p>
<p>而ajax获取后端数据是有跨域问题的，虽然说可以解决，但是有可能是该数据（或者后端部署环境）和上面的css、js、图片等静态资源是不在同一台服务器上的，也可能是同一台服务器不同域名下的，如果都在同一域名同一服务器下，开发阶段肯定也不在一起吧！</p>
<h3 id="2种应用情况"><a href="#2种应用情况" class="headerlink" title="2种应用情况"></a>2种应用情况</h3><p>虽然架构可以采用前后端分离，但是部署有可能就不一样了，这和项目的大小，公司的情况等等都有关系了，一个百八十人用的小系统，还得两台服务器两个域名，你不觉着浪费吗？</p>
<p>2种不同的部署情况直接导致了前期在设计联调方案的时候就不同了，下面会详细介绍。</p>
<h3 id="2种开发场景"><a href="#2种开发场景" class="headerlink" title="2种开发场景"></a>2种开发场景</h3><p>这不用多说了，虽然现在主张前后端分离，但也不能不和后端叔叔亲近亲近了呀，不然谁给你数据区，所以说真个开发阶段都可能遇到联调的问题。</p>
<h2 id="联调开始"><a href="#联调开始" class="headerlink" title="联调开始"></a>联调开始</h2><p>在讲解联调之前，你需要了解主流自动化构建工具本地mock数据的方法，本例以gulp来讲解，不了解的小伙伴可以看看<a href="http://chping.website/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/" target="_blank" rel="external">Gulp和Webpack对比</a>的mock数据部分。</p>
<h3 id="开发阶段"><a href="#开发阶段" class="headerlink" title="开发阶段"></a>开发阶段</h3><h4 id="两台服务器对应两个域名"><a href="#两台服务器对应两个域名" class="headerlink" title="两台服务器对应两个域名"></a>两台服务器对应两个域名</h4><p>这是最nice的方案，也是联调最舒服的方式。</p>
<p>在这种方式下，前后和后端各有各的服务器和域名。后端会把他们开发的后端业务代码，实时的上传到服务器上（也可能不是，如放在后端叔叔自己的电脑上，实现是一样的，只不过域名变成了叔叔的ip地址）；而我们前端的代码会实时的上传到我们前端的服务器上（同理也可能在自己的电脑上，开发完一块上传）。</p>
<p>为了后面方面讲解，前端服务器域名为“chping.website”，后端服务器域名为”chping.site”。</p>
<h5 id="css、js和图片等静态文件"><a href="#css、js和图片等静态文件" class="headerlink" title="css、js和图片等静态文件"></a>css、js和图片等静态文件</h5><p>此时，我们的静态文件的请求路径建议使用我们前端服务器的绝对路径，为什么呢？因为如果我们写本地的相对路径，等把我们的入口文件交给后端后，路径还是绝对路径，岂不是成了后端服务器的路径了，那就坏菜了，还得一个一个修改成我们前端的绝对路径（如：<code>http://chping.website/css/reset.css</code> ）。</p>
<p>那可能有小伙伴说，这样的话，我在开发阶段，我们的服务器上还没有自己的静态文件呢，去请求的话，会报404的！</p>
<p>对的，这时候就该我们的host的出场了，我们知道当进行域名解析的时候，第一步是在浏览器缓存中寻找，如果没找到，第二步在我们系统的缓存中寻找（就是本地的hosts文件），然后….（想详细了解请看<a href="http://chping.website/2016/09/11/netword/" target="_blank" rel="external">网络请求过程扫盲</a>的DNS解析部分）就没有然后了。既然域名解析需要通过hosts文件这一步，那么我们就修改一下它，让访问<code>http://chping.website</code>这个域名的请求，全都访问我们本地的mock数据就好了呀！</p>
<p>在hosts文件中添加下面这一条<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>    chping.website</div></pre></td></tr></table></figure></p>
<p>好的，搞定，从此以后所有访问域名<code>http://chping.website</code>的请求都会被映射到本地了，然后再结合gulp的mock数据，就完成了你写的是域名+绝对路径（如：<code>http://chping.website/css/reset.css</code> ），但是请求的却是你本地mock的数据（上面的请求会被映射到<code>http://localhost/css/reser.css</code>）。这样你就不需要来回修改请求路径了^_^。</p>
<h5 id="ajax后端数据"><a href="#ajax后端数据" class="headerlink" title="ajax后端数据"></a>ajax后端数据</h5><p>开发工程中，静态文件的联调问题可能还是比较少的，特征也不明显。但是通过ajax获取后端数据使用联调的情况可就多了去了，前面<strong>为什么要前后端联调</strong>一节中已经通过小刘的例子说明了，就不在赘述了。</p>
<p>其实在介绍完<strong>css、js、图片等静态文件</strong>一节，相信你也能猜到了怎么去前后端联调了。很简单，ajax中的请求还是写绝对路径（如：<code>http://chping.site/userlist</code>，获取用户列表），此时后端接口如果没有开发好，和上一节一样通过hosts文件的修改可以实现<code>chping.site</code>域名映射到本地来。如果后端像让你给他测试一下接口获取的数据对不对，你可以在修改一下hosts文件就可以了。</p>
<p>可能还有小伙伴问了，这样还不是改来改去，麻烦死了。首先来说，相比较你修改多个url地址和修改一个hosts文件，孰轻孰重，一目了然；其次，怎么可能让你去每次都去修改hosts文件呢，麻烦死了。现在向大家推荐一款小插件，在google商店里搜索一下<strong>HostAdmin</strong>就找到它了，下载安装就好了，然后简单配置一下你的hosts地址，就可以愉快地切换hosts的映射了（HostAdmin的使用自行google，干这行岂能不会用软件）。</p>
<p>好了，两台服务器对应两个不同域名的场景在开发阶段就这样愉快地结束了。但是在实际开发中，中小公司很少给你两台服务器和两个域名的，一般正常情况就是一台服务器一个域名的。</p>
<h4 id="一台服务器一个域名"><a href="#一台服务器一个域名" class="headerlink" title="一台服务器一个域名"></a>一台服务器一个域名</h4><p>我仔细想一下，此时这个服务器会给谁管理呢？</p>
<p>想都不用想肯定不是前端，后端叔叔比你对服务器熟悉多了，交给你去管理那是出鬼了（我还真遇到过，不过也是给后端首先使用，最后才把前端的代码放到服务器上），所以说在这种情况下，你就老老实实在本地开发就行了。</p>
<h5 id="css、js和图片等静态文件-1"><a href="#css、js和图片等静态文件-1" class="headerlink" title="css、js和图片等静态文件"></a>css、js和图片等静态文件</h5><p>这时候的静态文件再开发阶段不需要任何考虑，按照你喜欢的相对路径或者相对于项目的根路径的形式写就行了，因为早晚还得交给后端。但是，需要注意：</p>
<ol>
<li>如果你采用<strong>相对项目根路径的书写方式来写你的静态文件路径</strong>时，一定要先和后端叔叔商量好，将来项目部署的时候他会把你的前端整个项目放在哪里？如果不是根目录下，你就挂了。比如：你的reset.css的路径时<code>/exports/styles/common/reset.css</code>，后端叔叔把你前端项目放在了根目录下的<code>frontEnd</code>文件夹下，<code>reset.css</code>文件就报404了。</li>
<li>如果后端采用的java，你需要特别注意的是，<strong>tomcat的根目录</strong>并不是<code>webapps</code>文件，而后端项目默认是部署在<code>webapps/ROOT</code>文件下的，所以你如果使用了相对项目根路径的书写方式来写你的静态文件路径时，对不起又是404了。</li>
</ol>
<h5 id="ajax后端数据-1"><a href="#ajax后端数据-1" class="headerlink" title="ajax后端数据"></a>ajax后端数据</h5><p>因为现在唯一的一台服务器还是在后端叔叔那里，所以此时你还是可以写绝对路径（域名+请求路径），利用hosts文件来改变域名映射实现联调。</p>
<h4 id="开发阶段小结"><a href="#开发阶段小结" class="headerlink" title="开发阶段小结"></a>开发阶段小结</h4><p>其实在开发阶段做联调的情况还是很少的，一般都在自己的机器上开发，后端会自己做单元测试，根本不用前端来给他做测试的（先别骂，完事一块，哈哈）；而前端更不需要了，都在自己机器上开发。及时有两台服务器和域名，有几个每开发一个功能就上传服务器呀（此服务器指项目上线时部署的服务器），有病吧！所以说，在这个阶段只需要做好hosts映射就行了，不会让你来回切换域名映射的。</p>
<p>但是接下来的调试阶段就不一样了，项目前后端大体都已经开发完成了，Beta版本已经部署了，这时候如果出现bug就需要频繁的线上线下（真实数据和mock数据）切换了。</p>
<h3 id="调试阶段"><a href="#调试阶段" class="headerlink" title="调试阶段"></a>调试阶段</h3><p>调试阶段的情况说明刚才提了一下，现在再详细的阐述一下：</p>
<p>首先，已发布的Beta版本在测试的时候，发现前端页面上有个地方有个小bug，需要你修改一下，于是你访问线上的页面，看了一下这个bug，发现是某个css样式文件里面出错了，于是你希望在本地修改，然后线上版本可以直接查看，这样就可以实时看到你的修改在线上的真实样子了。</p>
<h4 id="两台服务器两个域名"><a href="#两台服务器两个域名" class="headerlink" title="两台服务器两个域名"></a>两台服务器两个域名</h4><p>这里就不在分静态文件和后端数据分开介绍了，其实道理都一样的，另外此时后端数据都是真实的了，也不需要你管后端了，此时你本地的mock数据已经下岗了。</p>
<p>首先你只需要打开前面你安装的<strong>HostAdmin</strong>，通过它配置一下你的hosts文件（如果年前面的做了，此时你已经配置好了），然后<code>chping.website</code>这个域名你可以在本地和线上之间来回切换了。</p>
<p>再具体一点就是：</p>
<ol>
<li>启动你本地的项目</li>
<li><p>将<code>chping.website</code>域名通过HostAdmin设置为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> 127.0.0.1         chping.website</div><div class="line"># 202.201.112.232   chping.website  //假设202.201.112.232是线上服务器的ip</div></pre></td></tr></table></figure>
</li>
<li><p>打开浏览器，并清除一下浏览器缓存，重新打开你们开发的网站。此时网站是获取到的静态资源就是从你本地获取的了，但是ajax获取的数据确实后端返回的真是数据。</p>
</li>
<li>然后你开始修改bug，这时候线上的版本可以实时查看你修改的前端内容，修改完bug，QA说了OK，你就可以把修改的文件替换掉服务器上的版本就行了。</li>
</ol>
<h4 id="一台服务器一个域名-1"><a href="#一台服务器一个域名-1" class="headerlink" title="一台服务器一个域名"></a>一台服务器一个域名</h4><p>这种情况就复杂了，此时只有一个域名，如果你开发阶段是按照我前面说的，写的是相对路径，那么此时你是没有办法实现<strong>两台服务器两个域名</strong>那种线下修改，线上查看的高大上联调的。那该怎么办呢？</p>
<p>第一种方式就是，你在本地修改，本地查看，测试好了以后上传到服务器，看看线上环境可不可以，OK当然好；不行就本地接着改，然后在上传。</p>
<p>第二种方式就是，在开发阶段你给静态文件前面加上一个<strong>假的域名</strong>，然后像两个域名一样进行<strong>假的域名</strong>与本地映射配置，然后像两个域名一样开发。等部署的时候，在服务器上也暂时做一个本地映射，你就可以实现同两个域名一样的线下修改，向上查看了。但是，最后真正上线的时候，你就需要收到，把假域名全部删掉。所以说，一台服务器一个域名的时候，前端静态文件做联调是很不方便的。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>总结一下，<strong>前后端联调</strong>是一种<strong>真实业务数据</strong>和<strong>本地mock数据</strong>之间来回切换以达到前后端分离架构下的不同开发速度时数据交换的一种方式方法，而实现就是利用自动化构建工具的mock数据功能和修改域名解析文件hosts来实现的。</p>
<p>如果你的项目是两台服务器和两个域名，随便你折腾。但是如果你是一台服务器和一个域名的话，就有些麻烦了，而这个麻烦仅对于你前端静态文件联调有影响，需要你好好思考一下怎么解决了，我目前还没找到更好地方法去解决。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨天一个朋友遇到一个典型的前后端联调的问题，这个问题已经不是第一次有人遇到了，自己多少知道点，就索性写下来吧。&lt;/p&gt;
&lt;p&gt;问题重现：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;小刘同学的项目采用的是前后端分离架构，现在前后端程序猿已经碰过面，协商好了一些前端需要的数据接口，于是前后端程序猿同时开工码代码。&lt;br&gt;这时候小刘同学某个页面需要后端数据，但是后端叔叔还没有将该数据的借口开发出来，此时小刘只能做假数据（专业点叫&lt;strong&gt;mock数据&lt;/strong&gt;，^_^），但是小刘的ajax的借口写的是与后端叔叔商量好的绝对路径（域名+请求路径+请求参数，跨域问题已解决），因为这是以后真正的请求路径，所以小刘又不像先写本地相对路径，后期再来修改（万一后台叔叔开发的慢了，鬼知道有多少接口要修改呀）。于是他就迷茫了。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;仔细看看这其实就是前后端分离中的mock数据和联调的问题，就现在来说能解决的方式有很多种。先说mock数据，gulp，webpack，&lt;a href=&quot;http://ued.qunar.com/fekit/&quot;&gt;fekit&lt;/a&gt;（去哪儿网的一款前端自动化构建工具，据说历史比webpack和gulp都要久远）等等自动化构建工具都有mock数据的功能，这不是问题；再说绝对路径的问题，其实只需要做一个host的映射就行了。&lt;br&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="工程化" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/%E5%B7%A5%E7%A8%8B%E5%8C%96/"/>
    
    
      <category term="认识系列" scheme="https://chping2125.github.io/tags/%E8%AE%A4%E8%AF%86%E7%B3%BB%E5%88%97/"/>
    
      <category term="前端" scheme="https://chping2125.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>前端组件化的认识</title>
    <link href="https://chping2125.github.io/2016/11/04/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E5%8C%96%E7%9A%84%E8%AE%A4%E8%AF%86/"/>
    <id>https://chping2125.github.io/2016/11/04/前端组件化的认识/</id>
    <published>2016-11-04T01:13:29.000Z</published>
    <updated>2016-11-09T03:15:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>什么是前端组件化和模块化？<br>这两天一直在思考这个问题，以前对这两个概念的理解很模糊。认为“模块化”是侧重于功能或者数据的封装，目的是为了解耦合；而“组件化”更关注的UI部分，如一个页面可以分为头部、底部和内容区域等等。</p>
<p>这样的理解很明显是表层的简单的可能还是不正确的理解，最近反复阅读了苏宁前端“代码民工徐飞”关于组件化话的几篇文章，结合Angular1.x和Vue1.x的组件思想对组件化和模块化有了一些新的认识（原文链接在文末）。<br><a id="more"></a></p>
<h1 id="什么是组件化"><a href="#什么是组件化" class="headerlink" title="什么是组件化"></a>什么是组件化</h1><p>组件化的概念在后端早已存在多年，只不过近几年随着前端的发展，这个概念在前端开始被频繁提及，特别是在MV*的框架中。</p>
<p>前端中的“组件化”这个词，在UI这一层通常指“标签化”，也就是把大块的业务界面，拆分成若干小块，然后进行组装。</p>
<p>狭义的组件化一般是指<strong>标签化</strong>，也就是以自定义标签（自定义属性）为核心的机制。</p>
<p>广义的组件化包括<strong>对数据逻辑层业务梳理，形成不同层级的能力封装</strong>。</p>
<h1 id="为什么要有组件化？"><a href="#为什么要有组件化？" class="headerlink" title="为什么要有组件化？"></a>为什么要有组件化？</h1><p>不管是前端组件化还是后端的组件化，我认为其目的无非就是为了<strong>提高开发效率和后期维护的效率</strong>。<br>在说的详细点，就是比如我想实现一个网站的头部，我可以把头部单独拿出来进行封装，根据不同页面或者说业务要求，可以灵活定制不同的头部（结构一致，颜色或展示等不同）。这样就可以在不同的页面进行灵活的复用，后期如果头部结构有大的变动，可以只修改该头部组件就好了。是不是这个概念很熟悉，其实你早就在这么干了，比如以前用jsp做静态页面生成的时候，就可以利用jsp的<code>&lt;jsp:include  page=&quot;xxx.jsp&quot;/&gt;</code>指令进行引入公共组件，可能也有人理解那是模板的概念。</p>
<h1 id="MV-框架中的组件"><a href="#MV-框架中的组件" class="headerlink" title="MV*框架中的组件"></a>MV*框架中的组件</h1><p>大概了解了一下组件化的概念，我们来看看Vue和Angular中是怎样运用组件的思想的。</p>
<h2 id="Vue中的组件"><a href="#Vue中的组件" class="headerlink" title="Vue中的组件"></a>Vue中的组件</h2><blockquote>
<p>组件（Component）是 Vue.js 最强大的功能之一。组件可以扩展 HTML 元素，封装可重用的代码。在较高层面上，组件是自定义元素， Vue.js 的编译器为它添加特殊功能。在有些情况下，组件也可以是原生 HTML 元素的形式，以 is 特性扩展。</p>
</blockquote>
<p>以上是Vue官网对于Vue中组件的解释，其中在徐飞的<a href="https://github.com/xufei/blog/issues/3" target="_blank" rel="external">从HTML Components的衰落看Web Components的危机</a>一文中的评论部分，Vue的作者尤雨溪（github:<a href="https://github.com/yyx990803" target="_blank" rel="external">yyx990803</a>）发表了对民工叔叔（我只是小菜鸟，叫叔叔没啥问题，哈哈）文章的看法，其中也提到了他对于组件的认识。</p>
<p><a href="https://vuefe.cn/guide/components.html" target="_blank" rel="external">Vue中关于组件</a>的介绍是Vue中的重点部分，从它在Vue官方文档中的篇幅就可以看出来。我认为组件中最重要的方面，到目前为止我能理解的就两部分：<strong>通讯</strong>和<strong>复用</strong>。接下来重点介绍一下Vue对于通讯的实现。</p>
<p>结合尤雨溪在民工叔叔文章中评论那样，组件之间的通讯可分为<strong>从内向外</strong>和<strong>从外向内</strong>两种。Vue对于这两种通信时怎样解决的呢？文档中说的很详细了，<strong>events up</strong>和<strong>props down</strong>。</p>
<h3 id="从外向内的“props-down”"><a href="#从外向内的“props-down”" class="headerlink" title="从外向内的“props down”"></a>从外向内的“props down”</h3><p>具体来说，就是当父组件向子组件传递信息的时候，采用的是在子组件的构造对象中显示的设置props属性进行数据的传输。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">  Vue.component(<span class="string">'child'</span>, &#123;</div><div class="line">    <span class="comment">// 声明 props</span></div><div class="line">    props: [<span class="string">'message'</span>],</div><div class="line">    <span class="comment">// 就像 data 一样，prop 可以用在模板内</span></div><div class="line">    <span class="comment">// 同样也可以在 vm 实例中像 “this.message” 这样使用</span></div><div class="line">    template: <span class="string">'&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>然后向他传入一个普通字符串值：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;child message=<span class="string">"hello!"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>当然为了实现字面量语法或者动态语法，可以使用<code>v-bind</code>在父组件上来绑定数据，详细语法请参照<a href="https://vuefe.cn/guide/components.html#Props" target="_blank" rel="external">Vue文档</a>，本文不做详细介绍。</p>
<p><strong>需要特别注意的是：</strong></p>
<ol>
<li>Vue默认的是<strong>单项数据流</strong>，当父组件的属性变化时，将传导给子组件，但是不会反过来。这是为了防止子组件无意修改了父组件的状态——这会让应用的数据流难以理解。</li>
<li>另外，每次父组件更新时，子组件的所有 prop 都会更新为最新值。这意味着你不应该在子组件内部改变 prop 。如果你这么做了，Vue 会在控制台给出<strong>警告</strong>。</li>
<li>注意在 JavaScript 中对象和数组是<strong>引用类型</strong>，指向同一个内存空间，如果 prop 是一个对象或数组，在子组件内部改变它会影响父组件的状态。<br>并且当props为应用类型的时候还可以为其<strong>添加验证</strong>。</li>
</ol>
<h3 id="从内向外的“events-up”"><a href="#从内向外的“events-up”" class="headerlink" title="从内向外的“events up”"></a>从内向外的“events up”</h3><p>Vue中默认的虽然是单项数据流，但还是可以实现子组件向父组件传输数据的，因为有些场景中，我们不可避免的会使用到。而Vue中向上传递数据采用的和Angular中一样的思想，通过<strong>自定义事件</strong>的方式实现。大体需要以下两步步：</p>
<ol>
<li><strong>使用 $emit(eventName)在子组件上触发事件</strong></li>
<li><strong>使用 $on(eventName) 在父组件上（或者祖先组件）监听事件</strong></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"counter-event-example"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; total &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    //父组件监听事件</div><div class="line">    <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;button-counter&apos;, &#123;</div><div class="line">  template: &apos;&lt;button v-on:click=&quot;increment&quot;&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;&apos;,</div><div class="line">  data: function () &#123;</div><div class="line">    return &#123;</div><div class="line">      counter: 0</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    increment: function () &#123;</div><div class="line">      this.counter += 1;</div><div class="line">      this.$emit(&apos;increment&apos;);//子组件触发事件</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">&#125;)</div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#counter-event-example&apos;,</div><div class="line">  data: &#123;</div><div class="line">    total: 0</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    incrementTotal: function () &#123;</div><div class="line">      this.total += 1;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="中央事件总线"><a href="#中央事件总线" class="headerlink" title="中央事件总线"></a>中央事件总线</h3><p>有时候非父子关系的组件也需要通信。在简单的场景下，使用一个空的 Vue 实例作为中央事件总线：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> bus = <span class="keyword">new</span> Vue();</div></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 触发组件 A 中的事件</span></div><div class="line">bus.$emit(<span class="string">'id-selected'</span>, <span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 在组件 B 创建的钩子中监听事件</span></div><div class="line">bus.$on(<span class="string">'id-selected'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>在更多复杂的情况下，你应该考虑使用专门的 <a href="https://vuefe.cn/guide/state-management.html" target="_blank" rel="external">状态管理模式–Vuex</a></p>
<p>另外Vue还可以<a href="https://vuefe.cn/guide/components.html#使用-Slots-分发内容" target="_blank" rel="external">使用slot分发内容</a>，具体实现和更多实现请参考<a href="https://vuefe.cn/guide/components.html#Props" target="_blank" rel="external">Vue文档</a>。</p>
<p>简单描述了一下Vue的组件思想，主要目的是从民工叔叔的组件化文章中重新认识到了组件化的思想，结合Vue框架去理解，可能更容易明白民工叔叔的见解。</p>
<h2 id="Angular中的组件"><a href="#Angular中的组件" class="headerlink" title="Angular中的组件"></a>Angular中的组件</h2><p>严格来说，Angular1.x中并没有明确提及组件的概念，只是我们可以使用<code>app.directive()</code>来实现自定义指令，我觉着这其实就是组件。</p>
<p>而Angular中实现组件之间进行通信的方式主要有四种方式：</p>
<h3 id="基于-rootScope的全局变量和-scope作用域的继承性"><a href="#基于-rootScope的全局变量和-scope作用域的继承性" class="headerlink" title="基于$rootScope的全局变量和$scope作用域的继承性"></a>基于$rootScope的全局变量和$scope作用域的继承性</h3><p>基于作用域的继承性来实现组件通信仅限于作用域链上的通信，需要对Angular的controller之间的作用域关系特别熟悉，详细可以参考民工叔叔的<a href="https://github.com/xufei/blog/issues/18" target="_blank" rel="external">AngularJS实例教程（二）——作用域与事件</a>。</p>
<h3 id="利用事件-on-、-emit-、-broastcase-方式"><a href="#利用事件-on-、-emit-、-broastcase-方式" class="headerlink" title="利用事件$on()、$emit()、$broastcase()方式"></a>利用事件$on()、$emit()、$broastcase()方式</h3><p>先上一张图：<br><img src="https://raw.githubusercontent.com/xufei/blog/master/assets/ng/event.png" alt="$rootScope"><br>上图中清晰的展示了Angular中利用事件去上传数据和广播事件的关系图，于是我们就可以利用事件做点事情了。</p>
<p>从作用域往上发送事件，使用scope.$emit<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$scope.$emit(&quot;someEvent&quot;, &#123;&#125;);</div></pre></td></tr></table></figure></p>
<p>从作用域往下发送事件，使用scope.$broadcast<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$scope.$broadcast(&quot;someEvent&quot;, &#123;&#125;);</div></pre></td></tr></table></figure></p>
<p>这两个方法的第二个参数是要随事件带出的数据。<br>注意，这两种方式传播事件，事件的发送方自己也会收到一份。</p>
<h3 id="利用服务实现"><a href="#利用服务实现" class="headerlink" title="利用服务实现"></a>利用服务实现</h3><p>利用myApp.factory()生成一个需要共享数据的对象，然后在controller中注入，就可以是获取到共享数据了，并进行修改了。<br>直接上代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var myApp = angular.module(&quot;myApp&quot;, []);</div><div class="line">myApp.factory(&apos;Data&apos;, function() &#123;</div><div class="line">  return &#123;</div><div class="line">    name: &quot;Ting&quot;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">myApp.controller(&apos;FirstCtrl&apos;, function($scope, Data) &#123;</div><div class="line">  $scope.data = Data;</div><div class="line">  $scope.setName = function() &#123;</div><div class="line">    Data.name = &quot;Jack&quot;;</div><div class="line">   &#125;</div><div class="line">  &#125;);</div><div class="line">myApp.controller(&apos;SecondCtrl&apos;, function($scope, Data) &#123;</div><div class="line">  $scope.data = Data;</div><div class="line">  $scope.setName = function() &#123;</div><div class="line">    Data.name = &quot;Moby&quot;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="订阅发布模式"><a href="#订阅发布模式" class="headerlink" title="订阅发布模式"></a>订阅发布模式</h3><p>民工叔叔在<a href="https://github.com/xufei/blog/issues/18" target="_blank" rel="external">AngularJS实例教程（二）——作用域与事件</a>一文的末尾提出了利用订阅发布模式来通信，我觉着太经典了，接收方在这里订阅消息，发布方在这里发布消息。这个过程可以用这样的图形来表示：<br><img src="https://raw.githubusercontent.com/xufei/blog/master/assets/ng/ng_event_bus.png" alt="订阅发布模式通信"><br>代码写起来也很简单，把它做成一个公共模块，就可以被各种业务方调用了：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">app.factory(<span class="string">"EventBus"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </div><div class="line">  <span class="keyword">var</span> eventMap = &#123;&#125;; </div><div class="line">  <span class="keyword">var</span> EventBus = &#123; </div><div class="line">    <span class="attr">on</span> : <span class="function"><span class="keyword">function</span>(<span class="params">eventType, handler</span>) </span>&#123; </div><div class="line">      <span class="comment">//multiple event listener</span></div><div class="line">      <span class="keyword">if</span> (!eventMap[eventType]) &#123; </div><div class="line">        eventMap[eventType] = [];</div><div class="line">      &#125;</div><div class="line">      eventMap[eventType].push(handler);</div><div class="line">    &#125;, </div><div class="line">    <span class="attr">off</span> : <span class="function"><span class="keyword">function</span>(<span class="params">eventType, handler</span>) </span>&#123; </div><div class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; eventMap[eventType].length; i++) &#123; </div><div class="line">        <span class="keyword">if</span> (eventMap[eventType][i] === handler) &#123; </div><div class="line">          eventMap[eventType].splice(i, <span class="number">1</span>); </div><div class="line">          <span class="keyword">break</span>; </div><div class="line">        &#125; </div><div class="line">      &#125; </div><div class="line">     &#125;, </div><div class="line">    <span class="attr">fire</span> : <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123; </div><div class="line">      <span class="keyword">var</span> eventType = event.type; </div><div class="line">      <span class="keyword">if</span> (eventMap &amp;&amp; eventMap[eventType]) &#123; </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; eventMap[eventType].length; i++) &#123; </div><div class="line">          eventMap[eventType][i](event); </div><div class="line">        &#125; </div><div class="line">      &#125; </div><div class="line">    &#125; </div><div class="line">  &#125;; </div><div class="line">  <span class="keyword">return</span> EventBus;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>事件订阅代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">EventBus.on(<span class="string">"someEvent"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123; </div><div class="line">  <span class="comment">// 这里处理事件 </span></div><div class="line">  <span class="keyword">var</span> c = event.data.a + event.data.b;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>事件发布代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">EventBus.fire(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">"someEvent"</span>,</div><div class="line">  <span class="attr">data</span>: &#123; </div><div class="line">    <span class="attr">aaa</span>: <span class="number">1</span>, </div><div class="line">    <span class="attr">bbb</span>: <span class="number">2</span> </div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>注意，如果在复杂的应用中使用事件总线，需要慎重规划事件名，推荐使用业务路径，比如：”portal.menu.selectedMenuChange”，以避免事件冲突。</p>
<p>非常经典的Angular组件之间通信的一种方式，我在解释一下，如果A组件中有值需要传递给B组件。那么在B组件Controller中通过<code>EventBus.on()</code>订阅事件：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">EventBus.on(<span class="string">"someEvent"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123; </div><div class="line">  <span class="comment">// 这里是B组件中对A组件传过来的值进行处理的回调函数</span></div><div class="line">  <span class="keyword">var</span> c = event.data.a + event.data.b;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>然后，在A组件Controller中将其中的值通过<code>EventBus.fire()</code>发布一下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">EventBus.fire(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">"someEvent"</span>,</div><div class="line">  <span class="attr">data</span>: &#123; </div><div class="line">    <span class="attr">aaa</span>: <span class="number">1</span>, </div><div class="line">    <span class="attr">bbb</span>: <span class="number">2</span> </div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>这样B组件就可以拿到A组件中的数据值了。</p>
<h1 id="组件化再思考"><a href="#组件化再思考" class="headerlink" title="组件化再思考"></a>组件化再思考</h1><p>简单了解了一下Vue和Angular中的组件思想，我们再来回想一下组件化的概念:</p>
<blockquote>
<p>狭义的组件化一般是指<strong>标签化</strong>，也就是以自定义标签（自定义属性）为核心的机制。<br>广义的组件化包括<strong>对数据逻辑层业务梳理，形成不同层级的能力封装</strong>。</p>
</blockquote>
<p>很明显，不管是Vue还是Angular，对组件的封装都是为了对数据逻辑业务的梳理，使得不同组件各司其职，当然这其中就包括了对HTML的组件化，CSS的组件化和JS的组件化。</p>
<p>对于HTML的组件化可以理解为利用各种语义化标签或者自定义标签（Vue中的组件和Angular中的自定义指令等）对结构进行封装。而对于CSS的组件化，我们现在可以利用SASS或者LESS来实现，根据不同的功能对样式进行不同的封装，我觉着现在前端的一些UI框架就是对组件化的使用，去哪儿网杜瑶的<a href="https://github.com/doyoe/Yo" target="_blank" rel="external">Yo框架</a>就是一个很好的例子。</p>
<p>至于对于JS的组件化运用，我个人觉着就是模块化。不管是CommonJS规范、AMD规范、CMD规范还是ES2015的模块机制目的都是对JS进行模块化开发，使得不同功能的逻辑或者业务分离开，每个模块专注自己的业务逻辑，这样不仅是开发的时候工作目录一目了然，后期维护的时候也能快速定位到各个业务逻辑模块。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>简单的对民工叔叔的几篇文章做了一下总结，其实还没有理解到位，每篇文章读了仅仅3-4遍，每读一遍都有不一样的感受，理解也不一样。可能等过段时间再去读又会颠覆我现在的认识，不管对于错，先记录一下现在的感受，后期有了新的认识再来补充或者修改。<br>下面推荐民工叔叔的对于组件化和Angular的一些文章，我做了少许<strong><a href="https://github.com/chping2125/blog" target="_blank" rel="external">整理</a></strong>，大家可以直接按照目录由浅至深的阅读原文。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;什么是前端组件化和模块化？&lt;br&gt;这两天一直在思考这个问题，以前对这两个概念的理解很模糊。认为“模块化”是侧重于功能或者数据的封装，目的是为了解耦合；而“组件化”更关注的UI部分，如一个页面可以分为头部、底部和内容区域等等。&lt;/p&gt;
&lt;p&gt;这样的理解很明显是表层的简单的可能还是不正确的理解，最近反复阅读了苏宁前端“代码民工徐飞”关于组件化话的几篇文章，结合Angular1.x和Vue1.x的组件思想对组件化和模块化有了一些新的认识（原文链接在文末）。&lt;br&gt;
    
    </summary>
    
      <category term="前端" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="组件化" scheme="https://chping2125.github.io/categories/%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%8C%96/"/>
    
    
      <category term="框架" scheme="https://chping2125.github.io/tags/%E6%A1%86%E6%9E%B6/"/>
    
      <category term="前端" scheme="https://chping2125.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="组件化" scheme="https://chping2125.github.io/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Gulp和Webpack对比</title>
    <link href="https://chping2125.github.io/2016/10/18/gulp%E5%92%8Cwebpack%E5%AF%B9%E6%AF%94/"/>
    <id>https://chping2125.github.io/2016/10/18/gulp和webpack对比/</id>
    <published>2016-10-18T03:38:08.000Z</published>
    <updated>2016-11-05T13:29:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>在现在的前端开发中，前后端分离、模块化开发、版本控制、文件合并与压缩、mock数据等等一些原本后端的思想开始逐渐渗透到“大前端”的开发中。前端开发过程越来越繁琐，当今越来越多的网站已经从网页模式进化到了 Webapp 模式。它们运行在现代的高级浏览器里，使用 HTML5、 CSS3、 ES6 等更新的技术来开发丰富的功能，网页已经不仅仅是完成浏览的基本需求，并且Webapp通常是一个单页面应用(SPA)，每一个视图通过异步的方式加载，这导致页面初始化和使用过程中会加载越来越多的 JavaScript 代码，这给前端开发的流程和资源组织带来了巨大的挑战。</p>
<p>前端开发和其他开发工作的主要区别，首先是前端是基于多语言、多层次的编码和组织工作，其次前端产品的交付是基于浏览器，这些资源是通过增量加载的方式运行到浏览器端，如何在开发环境组织好这些碎片化的代码和资源，并且保证他们在浏览器端快速、优雅的加载和更新，就需要一个模块化系统，这个理想中的模块化系统是前端工程师多年来一直探索的难题。<br><a id="more"></a></p>
<blockquote>
<p>本文需要有一定的<a href="http://www.ydcss.com/archives/18" target="_blank" rel="external">Gulp</a>和<a href="http://www.jianshu.com/p/42e11515c10f" target="_blank" rel="external">Webpack</a>的基本概念，对Gulp和Webpack的使用有一定的了解。<br>同时还需要对<a href="http://chping.website/2016/09/12/npm/" target="_blank" rel="external">npm</a>或者<a href="http://chping.website/2016/09/12/npm%E5%92%8Ccnpm/" target="_blank" rel="external">cnpm</a>有一定的的了解，对ComonJS、AMD规范有一定的的了解。</p>
</blockquote>
<h1 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h1><p><a href="https://github.com/gulpjs/gulp" target="_blank" rel="external">Gulp</a>就是为了规范前端开发流程，实现前后端分离、模块化开发、版本控制、文件合并与压缩、mock数据等功能的一个前端自动化构建工具。说的形象点，“Gulp就像是一个产品的流水线，整个产品从无到有，都要受流水线的控制，在流水线上我们可以对产品进行管理。”</p>
<p>另外，Gulp是通过task对整个开发过程进行构建。</p>
<h1 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h1><p><a href="https://github.com/webpack/webpack" target="_blank" rel="external">Webpack</a> 是当下最热门的前端资源模块化管理和打包工具。它可以将许多松散的模块按照依赖和规则打包成符合生产环境部署的前端资源。还可以将按需加载的模块进行代码分隔，等到实际需要的时候再异步加载。通过 loader的转换，任何形式的资源都可以视作模块，比如 CommonJs 模块、AMD 模块、ES6 模块、CSS、图片、JSON、Coffeescript、LESS 等。</p>
<h1 id="Gulp和Webpack功能实现对比"><a href="#Gulp和Webpack功能实现对比" class="headerlink" title="Gulp和Webpack功能实现对比"></a>Gulp和Webpack功能实现对比</h1><p>简单介绍了一下Gulp和Webpack的概念性的问题和大环境，接下来进入本文的主题，对比一下Gulp和Webpack的优缺点。将从基本概念、启动本地Server、sass/less预编译、模块化开发、文件合并与压缩、mock数据、版本控制、组件控制八个方面对Gulp和Webpack进行对比。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>首先从概念上，我们可以清楚的看出，Gulp和Webpack的侧重点是不同的。</p>
<p>Gulp侧重于前端开发的<strong>整个过程</strong>的控制管理（像是流水线），我们可以通过给gulp配置不通的task（通过Gulp中的gulp.task()方法配置，比如启动server、sass/less预编译、文件的合并压缩等等）来让gulp实现不同的功能，从而构建整个前端开发流程。</p>
<p>Webpack有人也称之为<strong>模块打包机</strong>，由此也可以看出Webpack更侧重于模块打包，当然我们可以把开发中的所有资源（图片、js文件、css文件等）都可以看成模块，最初Webpack本身就是为前端JS代码打包而设计的，后来被扩展到其他资源的打包处理。Webpack是通过loader（加载器）和plugins（插件）对资源进行处理的。</p>
<p>另外我们知道Gulp是对整个过程进行控制，所以在其配置文件（gulpfile.js）中配置的每一个task对项目中<strong>该task配置路径下所有的资源</strong>都可以管理。<br>比如，对sass文件进行预编译的task可以对其配置路径下的所有sass文件进行预编译处理：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'sass'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'src/styles/*.scss'</span>)</div><div class="line">    .pipe(sass().on(<span class="string">'error'</span>,sass.logError))</div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>));<span class="comment">//编译后的输出路径</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>上面这个task可以对<code>&#39;src/styles/*.scss&#39;</code>目录下的所有以<code>.scss</code>结尾的文件进行预处理。</p>
<p>Webpack则不是这样管理资源的，它是根据模块的<strong>依赖关系</strong>进行静态分析，然后将这些模块按照指定的规则生成对应的静态资源(如下图)。<br><img src="/images/gulp/what-is-webpack.png" alt="webpack通过依赖关系静态分析"><br>通俗的说，Webpack就是需要通过其配置文件（webpack.config.js）中<code>entry</code>配置的一个入口文件（JS文件）,如下图<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  entry: &#123;</div><div class="line">      <span class="attr">app</span>:__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后Webpack进入该<code>app.js</code>文件进行解析，<code>app.js</code>文件如下图：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//引入scss文件</span></div><div class="line"><span class="keyword">import</span> <span class="string">'../style/app.scss'</span>;</div><div class="line"> </div><div class="line"><span class="comment">//引入依赖模块</span></div><div class="line"><span class="keyword">var</span> greeter = <span class="built_in">require</span>(<span class="string">'./Greeter.js'</span>);</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'root'</span>).appendChild(greeter());</div></pre></td></tr></table></figure></p>
<p>解析过程中，发现一个<code>app.scss</code>文件，然后根据<code>webpack.config.js</code>配置文件中的<code>module.loaders</code>属性去查找处理<code>.scss</code>文件的loader进行处理，处理<code>app.scss</code>文件过程中，如果发现该文件还有其他依赖文件，则继续处理<code>app.scss</code>文件的依赖文件，直至处理完成该“链路”上的依赖文件，然后又遇到一个<code>Greeter.js</code>模块，于是像之前一样继续去查找对应的loader去处理…<br>所以，Webpack中对资源文件的处理是通过入口文件产生的依赖形成的，不会像Gulp那样，配置好路径后，该路径下所有规定的文件都会受影响。</p>
<h2 id="模块化开发"><a href="#模块化开发" class="headerlink" title="模块化开发"></a>模块化开发</h2><p>所谓的前端模块化开发，我的理解就是，在开发的时候，把不通的资源文件按照他的具体用途进行分类管理，在使用的时候利用CommonJS、AMD、CMD等规范将这些资源文件引入到当前文件中。然后在测试或者最后上线的时候，将这些资源文件按照一定的要求进行压缩合并再加上版本控制处理。<br>可能这样的理解或者说法值得商榷，但是个人还是觉得模块化就是对内容的管理，是为了解耦合。</p>
<p>首先从Gulp入手，看看在项目中，怎样利用模块化的思想进行开发。下面是一个gulp项目的目录结构：<br><img src="/images/gulp/4.png" alt="gulp项目目录结构"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Gulp</div><div class="line"> |——build:  项目输出路径</div><div class="line"> |    |——prd:  css、js文件输出路径</div><div class="line"> |        |——scripts: js文件的输出路径</div><div class="line"> |        |——styles: css文件的输出路径</div><div class="line"> |    |——ver: 版本号相关文件</div><div class="line"> |    |——index.html: 编译后的index.html</div><div class="line"> |——images: 图片文件夹</div><div class="line"> |——mock: mock数据文件夹</div><div class="line"> |——node_modules: npm包管理文件夹</div><div class="line"> |——src: 工作目录</div><div class="line"> |    |——scripts</div><div class="line"> |        |——libs: 第三方依赖库（jQuery等）</div><div class="line"> |        |——tpls: 模板文件</div><div class="line"> |        |——utils: 工具类文件夹</div><div class="line"> |        |——views: 页面自定义js文件</div><div class="line"> |        |——app.js: index.html文件的入口js</div><div class="line"> |    |——styles：文件和scripts文件夹下基本一致（本例中我引用了第三方框架，目录更深，不在展示）</div><div class="line"> |——gulpfile.js: gulp的配置文件</div><div class="line"> |——index.html: 主页html文件</div><div class="line"> |——package.json: npm包管理配置文件</div></pre></td></tr></table></figure></p>
<p>在实际开发过程中，在src目录下工作，html、js和css等文件通过gulp的task配置，执行合并和压缩后输出到build目录下（下面会详细介绍合并压缩的实现）。在详细一点就是：</p>
<blockquote>
<ol>
<li>创建主页html文件</li>
<li>创建与之对应的app.js入口文件和app.scss入口文件。这两个文件只通过CommonJS规范<strong>引入各自views文件中自定义的js(或scss)文件</strong>，具体逻辑不写此文件中。</li>
<li>在views目录下编写js（或css）文件的逻辑代码，其中如果多个文件需要公共逻辑或者工具方法，就可以抽离出来在util文件夹下创建对应的公共方法，然后在views中需要的js（或css）文件中通过CommonJS规范引入使用。libs目录下的第三方库或框架也是这个思想去引用。</li>
<li>scripts目录下的tpls文件是用来放置html模板的，引用方式和引用libs相同。</li>
</ol>
</blockquote>
<p>大体介绍了一下我理解的模块化的思想，但是需要指出的是Gulp对js文件的模块化工作是通过Webpack实现的，具体来说是通过安装<strong>gulp-webpack</strong>模块和相关的<strong>loader</strong>模块进行js模块化管理的。具体步骤如下：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>gulp-webpack</strong>、<strong>vinyl-named</strong>、<strong>imports-loader</strong>和<strong>string-loader</strong>模块(压缩合并模块后面再介绍)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-webpack vinyl-named -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中通过CommonJs规范引入gulp-webpack 模块，并进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">//1.引入 gulp-webpack和vinyl-named模块</span></div><div class="line">  <span class="keyword">var</span> webpack= <span class="built_in">require</span>(<span class="string">'gulp-webpack'</span>);</div><div class="line">  <span class="keyword">var</span> webpack= <span class="built_in">require</span>(<span class="string">'vinyl-named'</span>);</div><div class="line"></div><div class="line">   <span class="comment">//2.js 模块化配置</span></div><div class="line">  <span class="keyword">var</span> jsFiles = [</div><div class="line">    <span class="string">'./src/scripts/*.js'</span>,</div><div class="line">  ];</div><div class="line">  gulp.task(<span class="string">'packjs'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(jsFiles)</div><div class="line">    .pipe(uglify().on(<span class="string">'error'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">       <span class="built_in">console</span>.log(<span class="string">'\x07'</span>,err.lineNumber,err.message);</div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.end();</div><div class="line">     &#125;))</div><div class="line">    </div><div class="line">    <span class="comment">//Webpack 对js模块化部分 start</span></div><div class="line">    .pipe(webpack(&#123;</div><div class="line">        <span class="attr">output</span>:&#123;</div><div class="line">          <span class="attr">filename</span>:<span class="string">'[name].js'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">module</span>:&#123;</div><div class="line">            <span class="attr">loaders</span>:[&#123;</div><div class="line">              <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">              <span class="attr">loader</span>:<span class="string">'imports?define=&gt;false'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">              <span class="attr">test</span>:<span class="regexp">/\.string$/</span>,</div><div class="line">              <span class="attr">loader</span>:<span class="string">'string'</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;));</div><div class="line">      <span class="comment">//Webpack 对js模块化部分 end</span></div><div class="line">    .pipe(concat(<span class="string">'all.js'</span>))</div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>对css文件我们也采用同js文件一样的模块化思想，利用sass进行模块化开发，至于对scss文件的合并压缩配置，下面还会详细介绍。</p>
<p>接下来应该介绍一下Webpack的模块化实现了，其实也就没什么可以说的了，文件目录和Gulp的基本相同，只不过实现过程中使用到的插件或者说模块不同，配置不同而已。另外需要注意的是，Webpack对于资源文件的模块化打包处理都是按js文件的处理方式处理的，例如还是上一小节中，你可能发现了，我在<code>app.js</code>入口文件中有这样一行代码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'../style/app.scss'</span>;</div></pre></td></tr></table></figure></p>
<p>你当时可能产生疑问，为什么在js文件中引入scss文件呢？<br>这是因为Webpack是通过依赖关系进行文件管理的，所以，想要对样式文件进行模块化管理则必须与<code>app.js</code>入口文件建立依赖关系，因此我们将样式文件的入口<code>app.scss</code>文件引入到了<code>app.js</code>中（其他资源想要被管理，也需要这样与<code>app.js</code>入口文件建立依赖关系）。<br>但是这样做很明显的就是样式文件通过<code>app.js</code>入口文件全部都合并压缩到js文件中了，这很显然不是我们想要的结果，所以我们需要将样式文件从js文件中剥离出来。</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>extract-text-webpack-plugin</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install  extract-text-webpack-plugin -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Webpack的配置文件webpack.config.js中进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//1.引入extract-text-webpack-plugin模块</span></div><div class="line"> <span class="keyword">var</span> Et = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"></div><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">   <span class="comment">//source-map调试</span></div><div class="line">   devtool: <span class="string">'eval-source-map'</span>,</div><div class="line">   <span class="comment">//webpack入口文件配置</span></div><div class="line">   entry: &#123;</div><div class="line">   <span class="attr">app</span>:__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">   &#125;,</div><div class="line">   <span class="comment">//webpack出口文件配置</span></div><div class="line">   output: &#123;</div><div class="line">       <span class="attr">path</span>: __dirname + <span class="string">"/prd/scripts/"</span>,<span class="comment">//输出文件路径配置</span></div><div class="line">       filename: <span class="string">"bundle.js"</span><span class="comment">//输出文件名配置</span></div><div class="line">   &#125;,</div><div class="line">   <span class="attr">module</span>:&#123;</div><div class="line">       <span class="attr">loaders</span>:[</div><div class="line">         &#123;</div><div class="line">             <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</div><div class="line">             <span class="attr">loader</span>: Et.extract(<span class="string">'style'</span>,<span class="string">'css!sass'</span>)<span class="comment">//从js中抽离scss文件</span></div><div class="line">         &#125;</div><div class="line">       ]</div><div class="line">    &#125;,</div><div class="line">   <span class="attr">plugins</span>: [</div><div class="line">       <span class="keyword">new</span> Et(<span class="string">'./styles/bundle.css'</span>),<span class="comment">//从js中抽离scss文件输出目录设置</span></div><div class="line">   ],</div><div class="line">   <span class="comment">//本地server配置</span></div><div class="line">   devServer: &#123;</div><div class="line">     <span class="attr">contentBase</span>:  __dirname + <span class="string">'/prd/'</span>,<span class="comment">//本地服务器所加载的页面所在的目录</span></div><div class="line">     port:<span class="number">8089</span>,<span class="comment">//本地服务端口配置</span></div><div class="line">     colors: <span class="literal">true</span>,<span class="comment">//终端中输出结果为彩色</span></div><div class="line">     historyApiFallback: <span class="literal">true</span>,<span class="comment">//不跳转</span></div><div class="line">     inline: <span class="literal">true</span><span class="comment">//实时刷新</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>上面有些配置信息并不完全，下面的小节中会逐渐介绍到。这样我们就实现了将css文件从js文件中剥离出来的目的。Webpack不但可以对css文件可以进行模块化管理，还可以对图片进行模块管理，有兴趣的可以自己去尝试一下。</p>
<h2 id="文件合并与压缩"><a href="#文件合并与压缩" class="headerlink" title="文件合并与压缩"></a>文件合并与压缩</h2><p>上面的模块化中，我们提到了模块化其实很大一部分是在做文件的合并与压缩操作，所以我们马上来看看Gulp和Webpack是怎样是想文件的合并和压缩的。</p>
<p>先来看看大背景，由于现在前端越来越庞大，页面文件依赖也越来越多，所以对这些文件进行合理的合并和压缩就志在必得。根据前面的了解，Webpack应该比Gulp更擅长文件合并和压缩，毕竟人家被称为<strong>模块打包机</strong>吗。<br>结论是正确的，Gulp可以对css文件以及js文件进行合并压缩处理，而Webpack可以实现对css文件，js文件，html文件等进行合并压缩和图片的压缩，还可以对js文件进行编译（如es6–&gt;es5，react jsx）等等，这些都是通过Webpack的<strong>loader</strong>实现的，当然这些也可以加入到Gulp中，毕竟Gulp把Webpack当做一个模块，通过<strong>gulp-webpack</strong>都引入了。</p>
<h3 id="Gulp合并压缩文件"><a href="#Gulp合并压缩文件" class="headerlink" title="Gulp合并压缩文件"></a>Gulp合并压缩文件</h3><h4 id="css的压缩"><a href="#css的压缩" class="headerlink" title="css的压缩"></a>css的压缩</h4><p> 要想实现Gulp对css文件的压缩只需要安装一个<strong>gulp-minify-css</strong>模块即可。</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>gulp-minify-css</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-minify-css -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中通过CommonJs规范引入gulp-minify-css模块，并进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//1.引入 gulp-minify-css模块</span></div><div class="line"><span class="keyword">var</span> minifyCSS = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</div><div class="line"></div><div class="line"><span class="comment">//2.css 预处理</span></div><div class="line"><span class="keyword">var</span> cssFiles = [</div><div class="line">  <span class="string">'./src/styles/usage/page/index.scss'</span></div><div class="line">]</div><div class="line">gulp.task(<span class="string">'sass'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(cssFiles)</div><div class="line">    .pipe(sass().on(<span class="string">'error'</span>,sass.logError))</div><div class="line">    .pipe(minifyCSS())<span class="comment">//执行压缩处理在一行</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>这样一个简单的css压缩就实现了。</p>
<h4 id="js合并压缩"><a href="#js合并压缩" class="headerlink" title="js合并压缩"></a>js合并压缩</h4><p>要想实现Gulp对js文件的合并压缩需要安装一个<strong>gulp-uglify</strong>和<strong>gulp-concat</strong>两个模块，前者是用于压缩的模块，后者是一个合并的模块。</p>
<ol>
<li><p>在项目中通过npm安装<strong>gulp-uglify</strong>和<strong>gulp-concat</strong>模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-uglify gulp-concat -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中通过CommonJs规范引入<strong>gulp-uglify</strong>和<strong>gulp-concat</strong>模块，并进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//1.引入**gulp-uglify**和**gulp-concat**模块</span></div><div class="line"> <span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"> <span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"></div><div class="line"><span class="comment">//js 合并压缩</span></div><div class="line"> <span class="keyword">var</span> jsFiles = [</div><div class="line">    <span class="string">'./src/scripts/*.js'</span>,</div><div class="line">  ];</div><div class="line">  gulp.task(<span class="string">'packjs'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(jsFiles)</div><div class="line">    <span class="comment">//js文件的压缩</span></div><div class="line">    .pipe(uglify().on(<span class="string">'error'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">       <span class="built_in">console</span>.log(<span class="string">'\x07'</span>,err.lineNumber,err.message);</div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.end();</div><div class="line">     &#125;))</div><div class="line">    .pipe(webpack(&#123;</div><div class="line">        <span class="attr">output</span>:&#123;</div><div class="line">          <span class="attr">filename</span>:<span class="string">'[name].js'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">module</span>:&#123;</div><div class="line">            <span class="attr">loaders</span>:[&#123;</div><div class="line">              <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">              <span class="attr">loader</span>:<span class="string">'imports?define=&gt;false'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">              <span class="attr">test</span>:<span class="regexp">/\.string$/</span>,</div><div class="line">              <span class="attr">loader</span>:<span class="string">'string'</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;));</div><div class="line">    <span class="comment">//js文件的合并</span></div><div class="line">    .pipe(concat(<span class="string">'all.js'</span>))</div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>js的文件合并压缩也完成了。我们再来看一下Webpack的合并压缩。</p>
<h3 id="Webpack的合并压缩"><a href="#Webpack的合并压缩" class="headerlink" title="Webpack的合并压缩"></a>Webpack的合并压缩</h3><h4 id="压缩js和css"><a href="#压缩js和css" class="headerlink" title="压缩js和css"></a>压缩js和css</h4><p>针对js和css文件的压缩，Webpack已经内嵌了uglifyJS来完成对js与css的压缩混淆，无需引用额外的插件。我们只需要在Webpack配置文件中的plugins属性中做如下配置：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  plugins: [</div><div class="line">    <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123; <span class="comment">//压缩代码</span></div><div class="line">      compress: &#123;</div><div class="line">        <span class="attr">warnings</span>: <span class="literal">false</span></div><div class="line">      &#125;,</div><div class="line">      <span class="attr">except</span>: [<span class="string">'$super'</span>, <span class="string">'$'</span>, <span class="string">'exports'</span>, <span class="string">'require'</span>] <span class="comment">//排除关键字</span></div><div class="line">  &#125;)</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>需要注意的是：压缩的时候需要排除一些关键字，不能混淆，比如$或者require，如果混淆的话就会影响到代码的正常运行。</p>
<h4 id="html的压缩"><a href="#html的压缩" class="headerlink" title="html的压缩"></a>html的压缩</h4><p>想要对html进行压缩，同样也是需要配置Webpack的配置文件，并且需要下载两个插件<strong>HtmlWebpackPlugin</strong>和<strong>html-minifier</strong>插件：<br>1.在项目中通过npm安装<strong>HtmlWebpackPlugin</strong>和<strong>html-minifier</strong>模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ npm install HtmlWebpackPlugin -D</div><div class="line">$ npm install html-minifier -D</div></pre></td></tr></table></figure></p>
<p>2.然后在Webpack的配置文件webpack.config.js进行如下配置：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">   <span class="keyword">new</span> HtmlWebpackPlugin(&#123; <span class="comment">//根据模板插入css/js等生成最终HTML</span></div><div class="line">       favicon:<span class="string">'./src/img/favicon.ico'</span>, <span class="comment">//favicon路径</span></div><div class="line">       filename:<span class="string">'/view/index.html'</span>, <span class="comment">//生成的html存放路径</span></div><div class="line">       template:<span class="string">'./src/view/index.html'</span>, <span class="comment">//html模板路径</span></div><div class="line">       inject:<span class="literal">true</span>, <span class="comment">//允许插件修改哪些内容，包括head与body</span></div><div class="line">      hash:<span class="literal">true</span>, <span class="comment">//为静态资源生成hash值</span></div><div class="line">      minify:&#123; <span class="comment">//压缩HTML文件</span></div><div class="line">          removeComments:<span class="literal">true</span>, <span class="comment">//移除HTML中的注释</span></div><div class="line">           collapseWhitespace:<span class="literal">true</span> <span class="comment">//删除空白符与换行符</span></div><div class="line">       &#125;</div><div class="line">  &#125;)</div><div class="line"> ]</div></pre></td></tr></table></figure></p>
<p>HtmlWebpackPlugin插件在生成HTML时调用了 html-minifier 插件来完成对HTML的压缩，这里我们使用两个配置完成来移除HTML中的注释以及空白符达到压缩的效果。</p>
<h2 id="sass-less预编译"><a href="#sass-less预编译" class="headerlink" title="sass/less预编译"></a>sass/less预编译</h2><p>我们再来看看sass/less预编译，其实就sass/less的预编译来说，两者区别不是很大。Gulp是通过<code>gulp-sass</code>、<code>gulp-less</code>模块进行预处理；而Webpack是通过<code>scss-loader</code>、<code>less-loader</code>加载器（loader）进行预处理。我们还是分别来看一下两者对此的实现。</p>
<h3 id="Gulp预编译sass-less"><a href="#Gulp预编译sass-less" class="headerlink" title="Gulp预编译sass/less"></a>Gulp预编译sass/less</h3><p>以sass为例子：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>gulp-sass</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-sass -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中通过CommonJs规范引入gulp-sass模块，并进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//1.引入 gulp-sass模块</span></div><div class="line"><span class="keyword">var</span> sass= <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</div><div class="line"></div><div class="line"><span class="comment">//2.css 预处理</span></div><div class="line"><span class="keyword">var</span> cssFiles = [</div><div class="line">  <span class="string">'./src/styles/usage/page/**/*'</span></div><div class="line">  <span class="comment">//./src/styles/usage/page目录下的所有文件</span></div><div class="line">];</div><div class="line">gulp.task(<span class="string">'sass'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(cssFiles)</div><div class="line">    .pipe(sass().on(<span class="string">'error'</span>,sass.logError))</div><div class="line">    .pipe(minifyCSS())</div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>));<span class="comment">//编译后的输出路径</span></div><div class="line">&#125;);</div><div class="line">  </div><div class="line"><span class="comment">//3.对sass文件的修改添加监听事件</span></div><div class="line">gulp.task(<span class="string">'watch'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   gulp.watch(<span class="string">'./src/styles/**/*'</span>,[<span class="string">'sass'</span>]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'watch'</span>,<span class="string">'webserver'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'所有任务队列执行完毕'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>这样，一个简单的sass预处理的task就配置完成了，然后我们还将该task加到gulp.watch()上实现了自动编译（即修改sass文件后保存，则立即执行sass预处理），配合Gulp启动的server则可以实现sass文件修改保存即可在浏览器中查看效果的目的，下一小节会介绍启动本地server。</p>
<h3 id="Webpack预编译sass-less"><a href="#Webpack预编译sass-less" class="headerlink" title="Webpack预编译sass/less"></a>Webpack预编译sass/less</h3><p>同样以sass为例子：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>sass-loader</strong>和<strong>node-sass</strong>模块，前者是用来加载sass相关文件的，后者是用来编译sass文件的。另外还需要安装另外两个模块<strong>css-loader</strong>和<strong>style-loader</strong>，前者是用来加载css相关文件的，后者是用来将css样式装填到html中的内联样式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install sass-loader node-sass css-loader style-sass -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Webpack的配置文件webpack.config.js中进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>:&#123;</div><div class="line">      <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">          <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,<span class="comment">//匹配以.css结尾的文件，如果你项目不需要刻意不配置</span></div><div class="line">          loader: <span class="string">'style!css'</span><span class="comment">//这里顺序必须这样  </span></div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">          <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,<span class="comment">//匹配以.scss结尾的文件</span></div><div class="line">          loader: <span class="string">'style!css!sass'</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>前面提到过，Webpack是通过文件的依赖关系进行加载分析的，所以当程序从主入口（js文件）进入后，在依赖的资源文件中发现有sass文件后，就会利用我们配置的<strong>sass-loader</strong>去加载，然后用<strong>node-sass</strong>去解析编译成普通的css语法的样式文件，在然后就是利用<strong>style-loader</strong>将样式以内联样式的形式配置到html中（这里有一个问题，就是css-loader有什么用?我也没搞明白，但是不添加会报错，有知道的可以留言交流一下）。这样Webpack就完成了sass的预处理。</p>
<h2 id="启动server"><a href="#启动server" class="headerlink" title="启动server"></a>启动server</h2><p>我们都知道在前端开发中，ajax请求是需要启动一个server的。特别是在前后端分离思想中，前端开发不再像以前一样过分依赖于后端开发，以前的那种前端测试ajax请求需要装个tomcat或者其它服务器来启动server的现象已经成为过去式，现在我们可以使用像Gulp这类前端自动构建工具启动一个本地server进行测试，再也不收后端程序员钳制了（开个玩笑，和后端好好沟通才能让前端开发更方便）。那么，我们来分别看一下Gulp和Webpack是怎样实现这个功能的。</p>
<h3 id="Gulp启动server"><a href="#Gulp启动server" class="headerlink" title="Gulp启动server"></a>Gulp启动server</h3><p>在Gulp中想要启动一个本地serve，只需要以下几步：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>gulp-webserver</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-webserver -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中通过CommonJs规范引入gulp-webserver模块，并进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//1.引入 gulp-webserver 模块</span></div><div class="line"><span class="keyword">var</span> webserver = <span class="built_in">require</span>(<span class="string">'gulp-webserver'</span>);</div><div class="line"></div><div class="line"><span class="comment">//2.配置server task</span></div><div class="line">gulp.task(<span class="string">'webserver'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'./'</span>)</div><div class="line">  .pipe(webserver(&#123;</div><div class="line">      <span class="attr">host</span>:<span class="string">'localhost'</span>,</div><div class="line">      <span class="attr">port</span>:<span class="number">80</span>,</div><div class="line">      <span class="comment">//浏览器自动刷新</span></div><div class="line">      livereload:<span class="literal">true</span>,</div><div class="line">      <span class="comment">//显示文件目录</span></div><div class="line">      directoryListing:&#123;</div><div class="line">        <span class="attr">enable</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">path</span>:<span class="string">'./'</span></div><div class="line">      &#125;,</div><div class="line">    &#125;));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//3.配置默认task</span></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'webserver'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'启动任务队列执行完毕'</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>在命令行中启动server</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp</div></pre></td></tr></table></figure>
</li>
</ol>
<p>启动成功：<br><img src="/images/gulp/2.png" alt="gulp cli 启动成功"></p>
<ol>
<li>在浏览器地址栏中输入<strong>localhost</strong>打开页面验证。</li>
</ol>
<p>经过以上这三步，我们就在Gulp中启动了一个server了。在Gulp中启动本地服务有一个很方便的配置，就是<code>livereload:true</code>属性的设置，设置后浏览器会根据你项目中资源的变化自动刷新浏览器（如果你的chrome浏览器设置该属性后在你修改文件并保存时仍没有自动刷新，可能是你的chrome浏览器不支持，可以chrome扩展程序中搜索并安装LiveReload插件），比如：<br>我的gulp测试目录结构：<br><img src="/images/gulp/1.png" alt="gulp测试目录结构"><br>index.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">  <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/src/scripts/app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>我在app.js文件中输入以下内容，然后保存。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'gulp-webserver livereload'</span>);</div></pre></td></tr></table></figure></p>
<p>浏览器中控制台上会立刻打印出一下信息：<br><img src="/images/gulp/3.png" alt="gulp测试目录结构"><br>说明浏览器自动刷新工程，这个小功能在我们开发中屡试不爽。但是，这个功能是需要结合上一小节中的<code>gulp.watch()</code>实时监控文件变化，然后执行合并压缩和sass/less编译等操作后，浏览器再刷新时才能保证是我们修改后的内容。所以，<code>livereload:true</code>属性只是监控到我们修改文件后刷新浏览器重新请求文件，如果我们不重新编译修改后的文件，浏览器获取到的还是原文件，并不会展示变化。</p>
<h3 id="Webpack启动server"><a href="#Webpack启动server" class="headerlink" title="Webpack启动server"></a>Webpack启动server</h3><p>在Webpack中也可以通过插件的形式安装一个<strong>webpack-dev-server</strong>来实现达到启动本地server的目的，具体步骤如下：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>webpack-dev-server</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install  -g webpack-dev-server -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Webpack的配置文件webpack.config.js中进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">   <span class="attr">devtool</span>: <span class="string">'eval-source-map'</span>,</div><div class="line">   <span class="comment">//webpack入口文件配置</span></div><div class="line">   entry: &#123;</div><div class="line">   <span class="attr">app</span>:__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">   &#125;,</div><div class="line">   <span class="comment">//webpack出口文件配置</span></div><div class="line">   output: &#123;</div><div class="line">       <span class="attr">path</span>: __dirname + <span class="string">"/prd/scripts/"</span>,<span class="comment">//输出文件路径配置</span></div><div class="line">       filename: <span class="string">"bundle.js"</span><span class="comment">//输出文件名配置</span></div><div class="line">   &#125;,</div><div class="line">   <span class="comment">//本地server配置</span></div><div class="line">   devServer: &#123;</div><div class="line">     <span class="attr">contentBase</span>:  __dirname,<span class="comment">//本地服务器所加载的页面所在的目录</span></div><div class="line">     port:<span class="number">8089</span>,<span class="comment">//本地服务端口配置</span></div><div class="line">     colors: <span class="literal">true</span>,<span class="comment">//终端中输出结果为彩色</span></div><div class="line">     historyApiFallback: <span class="literal">true</span>,<span class="comment">//不跳转</span></div><div class="line">     inline: <span class="literal">true</span><span class="comment">//实时刷新</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>在命令行中启动server</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ webpack-dev-server</div></pre></td></tr></table></figure>
</li>
</ol>
<p>然后你就会看见命令行输出内容很多，只要看看保证没有Error就说明成功了。</p>
<ol>
<li>在浏览器地址栏中输入<strong>localhost：8089</strong>测试一下。</li>
</ol>
<p>Webpack的启动本地服务也顺利实现了，是不是也想实现像Gulp一样浏览器自动刷新呀？那Webpack能不能实现呢？答案是肯定的，Webpack官方提供了一个辅助开发工具，它可以自动监控项目下的文件，一旦有修改保存操作，开发服务器就会自动运行Webpack 打包命令，帮我们自动将开发的代码重新打包。而且，如果需要的话，还能自动刷新浏览器，重新加载资源。理论上好像是这样，但是实现好像有不少限制，比如，HTML文件的自动刷新问题（html-webpack-plugin插件使用老是报错），当本地server启动在非output.path路径之外时则不能自动刷新等问题，等我再学习学习再说，或者有知道的可以留言讨论。</p>
<p>而这个辅助工具就是<strong>webpack-dev-server</strong>，它主要提供两个功能：一是为静态文件提供server服务，二是自动刷新和热替换(HMR)。所以想实现如Gulp一样的功能也是可以的，只需要在<code>$ webpack-dev-server</code>后面添加<code>--inline --hot</code>即可。需要注意的是<code>--inline</code>是自动刷新，同时在第二部中的devServer属性中有一个<strong>inline:true</strong>需要配置；而<code>--hot</code>是热替换（<a href="https://segmentfault.com/a/1190000003872635" target="_blank" rel="external">详细了解热替换</a>、<a href="https://segmentfault.com/a/1190000006964335" target="_blank" rel="external">了解webpack-dev-server</a>、<a href="http://www.07net01.com/2015/12/1004731.html" target="_blank" rel="external">webpack-dev-server</a>）。</p>
<p>通过对比来看，好像Webpack的<strong>webpack-dev-server</strong>比Gulp的<strong>gulp-server</strong>功能要强一些。因为通过上面可以看出<strong>webpack-dev-server</strong>有两个大功能：一是为静态文件提供server服务，二是自动刷新（<strong>自动刷新其实需要两步：1.修改文件后，文件自动编译{包括合并压缩或者语法编译等}，2.刷新浏览器请求最新编译后的文件</strong>）和热替换(HMR)；而<strong>gulp-server</strong>虽然提供了启动本地server的能力和仅自动刷新浏览器的能力，缺少一个文件自动编译的能力，这需要借助其他模块实现（上一小节已介绍，结合gulp.watch()实时监控文件变化，并编译）。</p>
<p>另外需要注意的是，实际开发中发现<strong>webpack-dev-server</strong>实现自动刷新的时候，并没有执行自动编译，只是将修改的内容合并压缩等处理后发送给了浏览器，并造成了已经编译的现象，但是通过build/prd/scripts目录下的bundle.js(合并压缩后的输出文件)文件，可以发现内容并没有编译（对于Webpack还是不熟悉，好多问题等待解决）。</p>
<h2 id="mock数据"><a href="#mock数据" class="headerlink" title="mock数据"></a>mock数据</h2><p>在现在前后端分离的思想中，前端和后端耦合度越来越小，现在唯一需要前后端密切联系的就是借口的定义和数据格式的确定。一般在项目开始前，前端和后端将项目中的接口和数据格式全部确定下来（当然项目需求变更就需要临时确立这些共识了），然后前端就可以自己mock数据了。</p>
<h3 id="Gulp实现mock数据"><a href="#Gulp实现mock数据" class="headerlink" title="Gulp实现mock数据"></a>Gulp实现mock数据</h3><p>Gulp中对mock数据的实现使通过NodeJS内置的fs模块和url模块实现的，因为Gulp本身就是基于NodeJS的。还记得第一小节“模块化开发”中目录结构中的那个mock目录吗？那就是用来储存<code>.json</code>文件的mock数据目录。</p>
<ol>
<li>配置Gulp的gulpfile.js文件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1.引入 fs 和 url 模块</span></div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line"></div><div class="line"><span class="comment">//2.重新配置一下上一小节的server</span></div><div class="line">gulp.task(<span class="string">'webserver'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   gulp.src(<span class="string">'./'</span>)</div><div class="line">   .pipe(webserver(&#123;</div><div class="line">      <span class="attr">host</span>:<span class="string">'localhost'</span>,</div><div class="line">      <span class="attr">port</span>:<span class="number">80</span>,</div><div class="line">      <span class="attr">livereload</span>:<span class="literal">true</span>,</div><div class="line">      <span class="attr">directoryListing</span>:&#123;</div><div class="line">        <span class="attr">enable</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">path</span>:<span class="string">'./'</span></div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    <span class="comment">//mock数据配置</span></div><div class="line">    middleware:<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</div><div class="line">      <span class="keyword">var</span> urlObj = url.parse(req.url,<span class="literal">true</span>);</div><div class="line">      <span class="keyword">switch</span> (urlObj.pathname) &#123;</div><div class="line">          <span class="keyword">case</span> <span class="string">'/pro/getPro'</span>:</div><div class="line">            res.setHeader(<span class="string">'Content-Type'</span>,<span class="string">'application/json;charaset=utf-8'</span>);</div><div class="line">            fs.readFile(<span class="string">'./mock/list.json'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">              <span class="comment">//上面list.json路径使用相对路径，绝对路径前台无法获取数据</span></div><div class="line">              res.end(data);</div><div class="line">            &#125;);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">          <span class="keyword">case</span> <span class="string">'/web/getUser'</span>:</div><div class="line">              <span class="comment">//....</span></div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        next();</div><div class="line">      &#125;</div><div class="line">    &#125;));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>具体来说，就是通过NodeJS拦截http请求，根据请求URL来模拟后端做出处理后返回不同的数据。</p>
<h3 id="Webpack实现mock数据"><a href="#Webpack实现mock数据" class="headerlink" title="Webpack实现mock数据"></a>Webpack实现mock数据</h3><p>Webpack并没有自带实现mock数据的功能，毕竟Webpack人家本来就是用来打包的，人家并不是流程控制的,我们可以和Gulp对比实现其他功能，是因为其他功能都是在打包过程中实现的(启动server除外)。虽然Webpack没有自带mock数据的功能，但是我们可以借助一些其他手段来实现，比如说<strong><a href="https://github.com/typicode/json-server" target="_blank" rel="external">json-server</a></strong>，它的实现原理就是，启动一个本地3000端口作为mock数据的端口，然后我们在Webpack中配置一个代理，让所有请求代理到3000端口上去，就可以获取到数据了。<br>实现步骤：</p>
<ol>
<li><p>在项目中通过npm安装一个<strong>json-server</strong>的模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install  -g json-server</div></pre></td></tr></table></figure>
<p>可以将在任何一个目录下启动json-server,为了统一，我们建议直接在项目根目录启动，将mock数据也放在项目根目录下。</p>
</li>
<li><p>启动json-server</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ json-server</div></pre></td></tr></table></figure>
<p>json-server是一个非常强大的工具，感兴趣的可以自行google。</p>
</li>
<li><p>然后在Webpack的配置文件webpack.config.js中进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">   <span class="attr">devtool</span>: <span class="string">'eval-source-map'</span>,</div><div class="line">   <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>:__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">   &#125;,</div><div class="line">   <span class="attr">output</span>: &#123;</div><div class="line">       <span class="attr">path</span>: __dirname + <span class="string">"/prd/scripts/"</span>,</div><div class="line">       <span class="attr">filename</span>: <span class="string">"bundle.js"</span></div><div class="line">   &#125;,</div><div class="line">   <span class="comment">//本地server配置</span></div><div class="line">   devServer: &#123;</div><div class="line">     <span class="attr">contentBase</span>:  __dirname,</div><div class="line">     <span class="attr">port</span>:<span class="number">8089</span>,</div><div class="line">     <span class="attr">colors</span>: <span class="literal">true</span>,</div><div class="line">     <span class="attr">historyApiFallback</span>: <span class="literal">true</span>,</div><div class="line">     <span class="attr">inline</span>: <span class="literal">true</span>,</div><div class="line">     <span class="comment">//重点在这里</span></div><div class="line">     proxy:&#123;</div><div class="line">       <span class="string">'/http://chping.website/*'</span>:&#123;<span class="comment">//为正则表达式，匹配以http://chping.website开头的url</span></div><div class="line">         target: <span class="string">'http://localhost:3000'</span>,<span class="comment">//代理到本地3000端口</span></div><div class="line">         pathRewrite:&#123;</div><div class="line">           <span class="string">'^/http://chping.website'</span>:<span class="string">''</span><span class="comment">//将http://chping.website替换为空字符串</span></div><div class="line">         &#125;</div><div class="line">       &#125;</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>说明：<br>配置项<code>&#39;^/http://chping.website&#39;:&#39;&#39;//将http://chping.website替换为空字符串</code>的目的，举例说明：<br>假设我们项目中访问的是<code>http://chping.website/userlist</code>去获取用户列表，经过此配置项后，url为<code>http://localhost:3000/userlist</code>,否则为<code>http://localhost:3000/http://chping.website/userlist/userlist</code>。</p>
</li>
<li>在命令行中重新启动server<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ webpack-dev-server</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h2><p>对于版本控制，我们在开发过程中，也是一个使用比较频繁的功能，特别是开发团队比较大的时候，这个功能就显得更加重要了。那么Gulp和Webpack是具体怎样实现的呢？</p>
<h3 id="Gulp实现版本控制"><a href="#Gulp实现版本控制" class="headerlink" title="Gulp实现版本控制"></a>Gulp实现版本控制</h3><ol>
<li><p>在项目中通过npm安装<strong>gulp-rev</strong>和<strong>gulp-rev-collector</strong>模块，前者用于生成文件的MD5码文件和按MD5码命名的资源文件，后者是利用MD5码，对文件名进行替换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install  gulp-rev gulp-rev-collector -D</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Gulp的配置文件gulpfile.js中进行简单配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//1.引入连个模块</span></div><div class="line">  <span class="keyword">var</span> rev = <span class="built_in">require</span>(<span class="string">'gulp-rev'</span>);</div><div class="line">  <span class="keyword">var</span> revCollector = <span class="built_in">require</span>(<span class="string">'gulp-rev-collector'</span>);</div><div class="line">  <span class="comment">// 2.版本号控制</span></div><div class="line">  gulp.task(<span class="string">'ver'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(cssFiles)</div><div class="line">    .pipe(rev())<span class="comment">//产生MD5码</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/prd/styles/'</span>))<span class="comment">//重命名文件</span></div><div class="line">    .pipe(rev.manifest())<span class="comment">//产生版本信息的json文件</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'./build/ver/styles/'</span>));</div><div class="line">  gulp.src(jsFiles)</div><div class="line">  .pipe(rev())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/prd/scripts/'</span>))</div><div class="line">  .pipe(rev.manifest())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/ver/scripts/'</span>));</div><div class="line"> &#125;)</div><div class="line"> <span class="comment">//动态修改html中对css和js文件的修改</span></div><div class="line"> gulp.task(<span class="string">'html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src([<span class="string">'./build/ver/**/*'</span>,<span class="string">'./build/*.html'</span>])</div><div class="line">  .pipe(revCollector())</div><div class="line">  .pipe(gulp.dest(<span class="string">'./build/'</span>));</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Gulp实现版本控制很方便，将这两个task加入gulp.watch()中，即可实现修改保存文件实时自动修改版本的功能。</p>
<h3 id="Webpack实现版本控制"><a href="#Webpack实现版本控制" class="headerlink" title="Webpack实现版本控制"></a>Webpack实现版本控制</h3><p>Webpack中需要版本控制的有css、js文件，不过Webpack的版本控制只实现了将css、js文件添加hash值方式命名的文件方式，修改引用路径中的文件名需手动实现。<br>不过实现确实很简单，只需要将webpack.config.js配置文件中的output.filename和plugins中的输出文件名称修改一下即可。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">devtool</span>: <span class="string">'eval-source-map'</span>,</div><div class="line">    <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>:__dirname + <span class="string">"/src/scripts/app.js"</span>,</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: __dirname + <span class="string">"/prd/scripts/"</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">"[name]-[hash].js"</span><span class="comment">//修改输出文件名</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">plugins</span>: [</div><div class="line">        <span class="keyword">new</span> Et(<span class="string">'./styles/[name]-[hash].css'</span>),<span class="comment">//修改输出文件名</span></div><div class="line">    ]</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>这样就解决了。</p>
<h2 id="组件控制"><a href="#组件控制" class="headerlink" title="组件控制"></a>组件控制</h2><p>组件控制原本应该放在模块化小节或者前后小节，但是由于实在不知道该怎样比较，其实也没啥可比较的，就放在最后了。<br>Gulp和Webpack对各自组件的管理都是使用的npm进行的组件管理，想了解更多npm组件的管理的可自行百度，或者看看这篇文章入个门<a href="http://chping.website/2016/09/12/npm/" target="_blank" rel="external">《npm介绍》</a>。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过以上八个方面的功能对比，Gulp和Webpack基本都能满足前端自动化构建工具的任务，但是还是看出两个工具的侧重点是不通的，Gulp侧重整个过程的控制，Webpack在模块打包方面有特别出众。所以，Gulp + Webpack 组合使用可能更方便。</p>
<p>很长的一篇总结文章，前前后后花了两天时间终于写完了，还有很多测试没做，并且还有很多疑问没解决。慢慢学习，慢慢在补充修改吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在现在的前端开发中，前后端分离、模块化开发、版本控制、文件合并与压缩、mock数据等等一些原本后端的思想开始逐渐渗透到“大前端”的开发中。前端开发过程越来越繁琐，当今越来越多的网站已经从网页模式进化到了 Webapp 模式。它们运行在现代的高级浏览器里，使用 HTML5、 CSS3、 ES6 等更新的技术来开发丰富的功能，网页已经不仅仅是完成浏览的基本需求，并且Webapp通常是一个单页面应用(SPA)，每一个视图通过异步的方式加载，这导致页面初始化和使用过程中会加载越来越多的 JavaScript 代码，这给前端开发的流程和资源组织带来了巨大的挑战。&lt;/p&gt;
&lt;p&gt;前端开发和其他开发工作的主要区别，首先是前端是基于多语言、多层次的编码和组织工作，其次前端产品的交付是基于浏览器，这些资源是通过增量加载的方式运行到浏览器端，如何在开发环境组织好这些碎片化的代码和资源，并且保证他们在浏览器端快速、优雅的加载和更新，就需要一个模块化系统，这个理想中的模块化系统是前端工程师多年来一直探索的难题。&lt;br&gt;
    
    </summary>
    
      <category term="工具" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="Gulp" scheme="https://chping2125.github.io/categories/%E5%B7%A5%E5%85%B7/Gulp/"/>
    
    
      <category term="Gulp" scheme="https://chping2125.github.io/tags/Gulp/"/>
    
  </entry>
  
</feed>
